{"componentChunkName":"component---src-templates-blog-post-js","path":"/spring/spring-core/ioc-container-and-di/","result":{"data":{"site":{"siteMetadata":{"title":"내가 재밌는 일을 하자 !"}},"markdownRemark":{"id":"2e9fdb2a-8333-5126-99e3-8049a233226e","excerpt":"들어가며 이번에는 스프링 애플리케이션의 핵심인 스프링 컨테이너와 스프링의 핵심 프로그래밍 모델 중 하나인 IoC/DI에 대해 학습한 내용을 정리해보겠습니다. 참고로 토비의 스프링 3.1을 통해 학습을 진행했습니다. 1. IoC 컨테이너: Bean Factory와 Application…","html":"<h2>들어가며</h2>\n<p>이번에는 스프링 애플리케이션의 핵심인 <u>스프링 컨테이너</u>와 스프링의 핵심 프로그래밍 모델 중 하나인 <u>IoC/DI</u>에 대해 학습한 내용을 정리해보겠습니다.</p>\n<p>참고로 <a href=\"https://m.yes24.com/Goods/Detail/75738556\">토비의 스프링 3.1</a>을 통해 학습을 진행했습니다.</p>\n<h2>1. IoC 컨테이너: Bean Factory와 Application Context</h2>\n<p>스프링 애플리케이션에는 스프링 컨테이너가 존재합니다.<br>\n스프링 컨테이너는 객체 생성, 의존성 주입(DI), 객체 소멸을 개발자 대신 수행합니다.<br>\n이 때문에 제어의 역전, Inversion of Control. 즉, <strong>스프링 컨테이너를 IoC 컨테이너라고도 부릅니다.</strong><br>\n또는 경우에 따라 <strong>Bean Factory</strong>나 <strong>Application Context</strong> 라고 부르기도 합니다.</p>\n<p>하지만 Bean Factory와 Application Context는 느낌이 약간 다릅니다.<br>\n객체의 생성과 소멸, DI를 수행하는 관점에서는 Bean Factory 라고 할 수 있지만, 사실 스프링 컨테이너는 더 많은 작업을 수행하기 때문입니다.<br>\n이러한 작업들을 모두 포함해서 스프링 컨테이너를 봤을 땐 Application Context 라고 부르는 것이 합당할 수 있겠습니다.<br>\n따라서 일반적으로 스프링 컨테이너를 <strong>Application Context</strong>라고 부릅니다.</p>\n<p>실제로 아래 사진을 보시면 <code class=\"language-text\">ApplicationContext</code>가 <code class=\"language-text\">BeanFactory</code>를 상속받아 기능을 확장하고 있는 것을 확인할 수 있습니다.<br>\n(클릭하면 크게 볼 수 있습니다!)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/77eab79253e25860f0f891091dd88d98/67a79/inherit.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.08860759493672%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUUlEQVR42pWT2Y7bOhBE9R0z1kbKFFfttGzL9lgeZ0MC5P+/ptKkJsi9QF7ycNCU1CS7ulqJlga+PWPurnCqAasE+F4iLziynCMvq38i4UJi7zx0M8DaFsa1aNoB4SJjOzBeI81KOpwhK1i8qKCN8fkvJHnJwWULSdVJZVDXCrqWsKYBp2rTrED2QZoWeNlleN3l2NE6fIuXxQu3mPQ9VdZ51LqHtj2kblHVjg62qFVL7wcUXCPnip4dBsrvuw5KWZT0LpCzmuQSTCJZH9+wrD/QHh5Q3QW1O4PJA8p6AlczKruA61NEtVccL58ivb9D9xeoJuR7yj3EmDRSYhpG+GFAYwy6xqEqGcnLo5xNVhElbUYxcOprMG5fa1RCoWAVSiKnHifeODz8E/fLT6zLd6zHJ9b5CxrZkYw9JYpIMKcMB9FGRYdY08JqB6M0WDCJepoHUyouUBmP0sxU9kCbJPVMxkq2Cv9QUm5Niu7+hJt/x3l8xzKsOFKblu4NTjZIGCXZboJsJojmAKEbCHI5Or4XkOS6IGkFyQmyGK+iKbKh/rojtBupBYLkfki+3d4w+Znc7aHsCGnG6HhAKNpoaG22NReOqjTISlJQBnepf1xtU8C2mBxPK/z5ien0GcP8Dje8ofVrpNLB7RGFGFEG6g1GE/B7vTF9MCIZrII/LlguV4x+wuG04Hp/UDzHfu3SFC+vr8RL5HWXIqXh3kXS/5GmGZLJGlxoWJfTV5zmJ2bnMJJ7Aw1uZ4/o2hva5krjdENP0dAfJaSNhEH/77oSGr8AxuuBEf8iRsQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"실제 상속 구조\"\n        title=\"\"\n        src=\"/static/77eab79253e25860f0f891091dd88d98/f058b/inherit.png\"\n        srcset=\"/static/77eab79253e25860f0f891091dd88d98/c26ae/inherit.png 158w,\n/static/77eab79253e25860f0f891091dd88d98/6bdcf/inherit.png 315w,\n/static/77eab79253e25860f0f891091dd88d98/f058b/inherit.png 630w,\n/static/77eab79253e25860f0f891091dd88d98/40601/inherit.png 945w,\n/static/77eab79253e25860f0f891091dd88d98/78612/inherit.png 1260w,\n/static/77eab79253e25860f0f891091dd88d98/67a79/inherit.png 1408w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<h4>요약<br></h4>\n<ol>\n<li>스프링 애플리케이션에는 스프링 컨테이너가 존재한다.<br></li>\n<li>스프링 컨테이너는 객체의 생명주기와 의존성 주입을 수행한다.<br></li>\n<li>경우에 따라 스프링 컨테이너는 IoC 컨테이너, Bean Factory, Application Context 라고 불린다.<br></li>\n<li>하지만 BeanFactory와 ApplicationContext의 역할을 따졌을 때, 일반적으로 Application Context 로 불린다.</li>\n</ol>\n</blockquote>\n<h2>2. IoC 컨테이너의 동작원리</h2>\n<p>그럼 IoC 컨테이너는 어떻게 객체를 생성하고 소멸하며, 필요한 의존성을 주입하게 되는 것일까요?<br>\n바로 <u>POJO 클래스와 설정 메타정보를 이용하기 때문입니다.</u><br></p>\n<h3>POJO 클래스</h3>\n<p>POJO(Plain Old Java Object)는 <u>Java로만 만들어진 순수 클래스 파일입니다.</u><br>\n바로 이 POJO 클래스가 개발자가 작성한 코드가 되는 것이죠.<br>\nRepository 객체가 될 수 있고, Service 객체가 될 수 있으며, 순수한 Domain 객체가 될 수 있습니다.</p>\n<h4>설정 메타정보</h4>\n<p>설정 메타정보는 <u>스프링 애플리케이션에게 런타임에 사용할 POJO 객체임을 선언하고, 이로 인해 IoC 컨테이너가 제어할 수 있도록 알려주는 메타정보입니다.</u><br>\n즉, 스프링에게 Bean으로 등록할 객체를 알리는 방법입니다.<br>\n(여기서 Bean이란, 스프링 컨테이너에 생성되어 관리되는 객체를 일컫는 용어입니다.)</p>\n<p>결국 <u>스프링 컨테이너는 POJO와 설정 메타정보를 가지고 IoC/DI 작업을 수행하는 것입니다.</u></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 498px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dd0e46ebb3c279e93ca5aebf419cd4b5/79e1b/spring-container.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.49367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8UlEQVR42pWTTU8TQRjH9xNULigJNSRw4EC4cOGrcODQhM/AgTs3TnrVEGnQAiE01kZFjQlUTZRELzX75na7td26u27TfWnZZV/+zgx2Y6QSfJJ/Zmfn2V9+M5Pl0jTF2AAstPRuF98UBYIggOd5aJqGer2ORqMBSZLY+36/z3q5fwERxyzJxQV6loWh58F3HHhkHAyHcMiz7/tsThOG4SXwtwSSJGGhsISAvnS6eP9dJ+ngtNnC2Q8LH9o6DNdj/SP7UY1EuJh8HAQBoijKoNTmpaphT2mixMsoCTL2JQX7ZK5YdiYwbmccXVBVFZVKBdVqFbVaDYau422rg7LawoPTd7j/4hjFs894qrWh2r3MCGMs2ZapHT1cURRhmCbSOMIzWUGRmO3yEh6LxFBRsUvmsmldD8wu4c8FYm24PtqOh47jQ+6akHSDxT8PcF1lQHqWcRKzs4lJeoOfsAcmGU2Iza8sAokXuDcDstslIFq2Z2P5YBm3d+4gX7yLqe0pzJbmMLE9ga1PW6wnSqKbAw3XwNLhEmYOZrB4tIiFowXMH84jt5PD5sfN/wearonph9O49SiH2b05TBYnkX+SB3ePw8bJBusJ4/Dqz3AFmF4C3XMX6yfrWD1eReF1AYVXBay9WcPK8xWUhXJm+DeMAn8B1rtqWQIt6icAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"스프링 컨테이너\"\n        title=\"\"\n        src=\"/static/dd0e46ebb3c279e93ca5aebf419cd4b5/79e1b/spring-container.png\"\n        srcset=\"/static/dd0e46ebb3c279e93ca5aebf419cd4b5/c26ae/spring-container.png 158w,\n/static/dd0e46ebb3c279e93ca5aebf419cd4b5/6bdcf/spring-container.png 315w,\n/static/dd0e46ebb3c279e93ca5aebf419cd4b5/79e1b/spring-container.png 498w\"\n        sizes=\"(max-width: 498px) 100vw, 498px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>설정 메타정보는 <code class=\"language-text\">BeanDefinition</code> 으로 만들어진 순수한 추상 정보이고, 스프링 컨테이너는 바로 이 <code class=\"language-text\">BeanDefinition</code>으로 만들어진 객체를 사용해 IoC/DI 작업을 수행하게 되는 것입니다.<br>\n따라서 제공하려는 메타정보를 읽어서 <code class=\"language-text\">BeanDefinition</code> 객체로 만들어 등록하는 <code class=\"language-text\">BeanDefinitionReader</code>만 있다면 어떤 방법으로든 모두 가능합니다.<br>\n주로 XML, 어노테이션 등과 같은 방식으로 메타정보를 나타냅니다.<br></p>\n<p><u>결과적으로 스프링 컨테이너는 각 객체에 대한 정보를 담은 설정 메타정보를 읽고, 이를 활용해 IoC/DI 작업을 수행하게 됩니다.</u><br>\n<u>이 작업들을 통해 만들어진 객체들이 모여 하나의 애플리케이션을 구성하고 동작하게 되는 것입니다.</u></p>\n<blockquote>\n<h4>요약<br></h4>\n<ol>\n<li>IoC 컨테이너는 POJO 클래스와 설정 메타정보를 이용해 IoC/DI 작업을 수행한다.<br></li>\n<li>POJO 클래스는 개발자가 작성한 순수 Java 코드이다.<br></li>\n<li>설정 메타정보는 Bean으로 등록할 객체임을 스프링에게 알리는 방법이다.<br></li>\n<li>IoC 컨테이너는 메타정보를 통해 객체들을 생성하며 DI 작업을 수행하고 마침내 스프링 애플리케이션이 동작하게 된다.<br></li>\n</ol>\n</blockquote>\n<h3>직접 IoC 컨테이너 만들어보기</h3>\n<p>이제는 직접 코드를 통해 IoC 컨테이너를 만들어보고 눈으로 확인해보겠습니다.<br>\n다시 한번 상기시키자면 IoC 컨테이너는 <strong>POJO</strong>와 <strong>설정 메타정보</strong>가 필요합니다.</p>\n<p>우선 POJO 만으로 IoC 컨테이너에 Bean으로 등록해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Hello</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Printer</span> printer<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello \"</span> <span class=\"token operator\">+</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        printer<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setName</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setPrinter</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Printer</span> printer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>printer <span class=\"token operator\">=</span> printer<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Printer</span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token keyword\">void</span> <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">StringPrinter</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Printer</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">StringBuffer</span> buffer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        buffer<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ConsolePrinter</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Printer</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f8b6b9898ec27fd3897b97f965819f47/a6d36/test1-result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.278481012658226%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTklEQVR42nXOT3OaQBzGcd5GggokGUVYRCmwIkRI0KAhbZNpD3rsoebPC8jBXDJj+7q/3Wy95vCZZ5/f/nZmjbFwcT2B1Q9wnAvMjvWpTtem23V06tlHKp2jnnWG4djnxGlOcdWQ5XMSOSOVuZplOmVW6JmcFogwIhAeURSTqp4mU208SRhHCYOhwLAtC284JPAFvuerB4HqnuoBQhkFI5VC94HrcuGeM+j31d6IwO0j3AG27eBYNnbPwqimNdf5HdXslqu85TK9oZ5/Y6Es59+p1N08W6udlixdIpNa/aokDgsKtZtHJVVckYYlclJhDItffFnumK6fkCul2ZE0j+TtC7P2mUn9G/n1lWpzIPtxoNz+odr+Jb1/J1y/Mdb2BM2e0WqPYfV6mKcmpx9ME/NI95P/Zy+UXJYNTfPAYvWTZbshyW/xoxo/Xmji6B/YeMEIizsQYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"테스트1 결과\"\n        title=\"\"\n        src=\"/static/f8b6b9898ec27fd3897b97f965819f47/f058b/test1-result.png\"\n        srcset=\"/static/f8b6b9898ec27fd3897b97f965819f47/c26ae/test1-result.png 158w,\n/static/f8b6b9898ec27fd3897b97f965819f47/6bdcf/test1-result.png 315w,\n/static/f8b6b9898ec27fd3897b97f965819f47/f058b/test1-result.png 630w,\n/static/f8b6b9898ec27fd3897b97f965819f47/a6d36/test1-result.png 650w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>테스트 수행 결과, 개발자가 따로 <code class=\"language-text\">Hello</code> 객체를 만들어주지 않아도 IoC 컨테이너에 객체로 만들어져있는 것을 확인할 수 있습니다.<br>\n이제는 직접 <code class=\"language-text\">BeanDefinition</code>을 활용해 설정 메타정보를 만들고 <code class=\"language-text\">Printer</code>에 대한 의존성 주입까지 해보겠습니다.<br></p>\n<blockquote>\n<p>의존성 주입을 받는 방법으로는 setter 주입, 필드 주입, 생성자 주입이 있습니다.<br>\n본 글에서는 편의를 위해 setter 주입을 사용합니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">test2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// given</span>\n    <span class=\"token class-name\">StaticApplicationContext</span> applicationContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StaticApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">RootBeanDefinition</span> printerBeanDefinition <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RootBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StringPrinter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">registerBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">,</span> stringPrinterBeanDefinition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// when</span>\n    <span class=\"token class-name\">BeanDefinition</span> helloBeanDefinition <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RootBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Hello</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">MutablePropertyValues</span> propertyValues <span class=\"token operator\">=</span> helloBeanDefinition<span class=\"token punctuation\">.</span><span class=\"token function\">getPropertyValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    propertyValues<span class=\"token punctuation\">.</span><span class=\"token function\">addPropertyValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"World!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    propertyValues<span class=\"token punctuation\">.</span><span class=\"token function\">addPropertyValue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeBeanReference</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">registerBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> helloBeanDefinition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// then</span>\n    <span class=\"token class-name\">Hello</span> hello <span class=\"token operator\">=</span> applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Hello</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    hello<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEqualTo</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello World!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위 테스트 코드에서는 <code class=\"language-text\">StringPrinter</code>를 IoC 컨테이너에 Bean으로 등록하고 <code class=\"language-text\">Hello</code> 객체에 <code class=\"language-text\">addPropertyValue</code> 메서드를 통해 주입해주었습니다.<br>\n만약 생성자 주입이라면 아래와 같이 코드를 작성하면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">BeanDefinition</span> helloBeanDefinition <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RootBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Hello</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">ConstructorArgumentValues</span> constructorArgumentValues <span class=\"token operator\">=</span> helloBeanDefinition<span class=\"token punctuation\">.</span><span class=\"token function\">getConstructorArgumentValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconstructorArgumentValues<span class=\"token punctuation\">.</span><span class=\"token function\">addIndexedArgumentValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"World!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconstructorArgumentValues<span class=\"token punctuation\">.</span><span class=\"token function\">addIndexedArgumentValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RuntimeBeanReference</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이번에는 코드 한 줄만 바꿔 <code class=\"language-text\">ConsolePrinter</code>가 주입되도록 수정해보겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/143fe39b4999b45b5285e558446ecb2e/bcb8c/console-printer-injection.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.55696202531645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/0lEQVR42oWTWZKbMBCGOUfsGMQmIUBiswEDnkwmLznBVM397/GnuxkndlUqefiqW2pV7wr61qHwZxjbIFIZojiHIqIHVKwf9J040UiImGzqgYANvh3hfA9T1Cisgy4q0W3pkesSOjdyLzYiI8LU4MspwTFKEao/BCrO4JseTTugdp3QdmfB+Q62KOFcg6YbUDUdNufxs2vw5h3eihxTGuN4inEKdyjDXJxUdYuy8pSVkzNnXNUNZVWj5EytRWIKdLbC5hssFGR1NVySPjvkDNlRri3YOcssL6RHSiWkG2K/Y1uScq8yHMjJIdwJmSjZHfKD+XrDOK+4Li/COC1ynkiu2wvZNwznGRO9u4wz+mGQJEqpppWKSqqGg4rDad7k8bq9ivN5uWG7fZfzQozTirLtUddegs3bHpSd8aByUyIpDFKqJohoMpou0sxIOSz3Eq3odyLqVZxSSyiL7BMu/RSq3/3bh0JO+mGSKfMAOCKvjKHV4QFpUyHRtHO5hqYVMlkuPTscQ3w9RYR6IuCd4wx432QQFPUOZ88olT3d/4vAUnMNZ0bZsLzrT1S7tJ8Uf4HveTDBeVxx+/YD/WXGSsN4Jf08LnIeLlda6Mv/6S9w9DnYcVDTb/D9iImW9X1d8bGtGFv+FQP9IPo9tOCOJC866/ffdD87P4ide89D+QVnB4abaI+PkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ConsolePrinter 주입\"\n        title=\"\"\n        src=\"/static/143fe39b4999b45b5285e558446ecb2e/f058b/console-printer-injection.png\"\n        srcset=\"/static/143fe39b4999b45b5285e558446ecb2e/c26ae/console-printer-injection.png 158w,\n/static/143fe39b4999b45b5285e558446ecb2e/6bdcf/console-printer-injection.png 315w,\n/static/143fe39b4999b45b5285e558446ecb2e/f058b/console-printer-injection.png 630w,\n/static/143fe39b4999b45b5285e558446ecb2e/bcb8c/console-printer-injection.png 879w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>테스트를 돌려보면 실제로 <code class=\"language-text\">Hello World!</code> 가 콘솔창에 출력되는 것을 확인할 수 있습니다.</p>\n<p>마지막으로 IoC 컨테이너에서 Bean을 삭제하는 것도 테스트해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">test4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// given</span>\n    <span class=\"token class-name\">StaticApplicationContext</span> applicationContext <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StaticApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">RootBeanDefinition</span> printerBeanDefinition <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RootBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ConsolePrinter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">registerBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">,</span> printerBeanDefinition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// when</span>\n    applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">removeBeanDefinition</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// then</span>\n    <span class=\"token function\">assertThatThrownBy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> applicationContext<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"printer\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">isInstanceOf</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">NoSuchBeanDefinitionException</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 289px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c9e29010ac9bf1bc5ccbb6e91194abc6/c969a/result-test4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.88607594936709%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA40lEQVR42l2M206DUBBF+RujcoAjCByutlB8sTRSaom3mpiYqJE+mJj4BaZfvTxQ0wcfVvaelZkxTMthRDr4gSKKU/wwGnuoYsIoIdA5eOl6WI7Eds5wpDumLfddWJJjU2BYMsD2Ymx9VF/f0qw3tN0TdXPHor2nuXlguX7UbkNxWaOSApWWRJo4m40keYUbZJzaPoapWqzyEzHpEdUbk9U3zfMPq5cdav7FUfqKmPac5O+Y0w9EsdWpd4t+9Ae0t8qtfuheIMIFIpgj1BXn+ZJ01pFVHV7WYA5+INxzmP9h/vELfuiMnDrXf9cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Bean 삭제 테스트 결과\"\n        title=\"\"\n        src=\"/static/c9e29010ac9bf1bc5ccbb6e91194abc6/c969a/result-test4.png\"\n        srcset=\"/static/c9e29010ac9bf1bc5ccbb6e91194abc6/c26ae/result-test4.png 158w,\n/static/c9e29010ac9bf1bc5ccbb6e91194abc6/c969a/result-test4.png 289w\"\n        sizes=\"(max-width: 289px) 100vw, 289px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Bean 삭제 또한 가능한 것을 확인할 수 있습니다.</p>\n<p>지금까지 POJO와 <code class=\"language-text\">BeanDefinition</code>을 이용한 설정 메타정보를 통해 IoC 컨테이너를 만들어보았습니다.<br>\n코드로 직접 테스트해보니 객체 생성, 의존성 주입, 객체 삭제까지 객체의 모든 생명 주기를 관리하는 것을 확인할 수 있었다.</p>\n<h2>마치며</h2>\n<p>스프링 컨테이너와 IoC/DI에 대해 어느정도 알고 있다고 생각했지만 막상 다시 공부해보니 새로운 느낌이었습니다.<br>\n게다가 테스트 코드를 통해 직접 눈으로 확인해보니 조금 더 잘 와닿는 것 같습니다.</p>\n<p>다음으로는 IoC 컨테이너의 종류 중 하나인 <code class=\"language-text\">WebApplicationContext</code>에 대해 알아보겠습니다.</p>","frontmatter":{"title":"[Spring] 스프링 컨테이너, 그리고 IoC/DI","date":"March 07, 2024","description":"스프링 프레임워크의 기본 뼈대인 스프링 컨테이너와 핵심 프로그래밍 모델 중 하나인 IoC/DI에 대해"}},"previous":{"fields":{"slug":"/network/network-book-study/06-http-header/"},"frontmatter":{"title":"6장. HTTP 헤더"}},"next":{"fields":{"slug":"/java/what-is-jdbc/"},"frontmatter":{"title":"[Java] JDBC 파헤쳐보기"}}},"pageContext":{"id":"2e9fdb2a-8333-5126-99e3-8049a233226e","previousPostId":"6c10e324-361b-5c38-a6ff-5111d1eecfe9","nextPostId":"04e44a5a-f6d5-572b-9179-591adc48ccf0"}},"staticQueryHashes":["2841359383"],"slicesMap":{}}