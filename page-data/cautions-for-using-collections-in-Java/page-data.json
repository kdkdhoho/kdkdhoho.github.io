{"componentChunkName":"component---src-templates-post-jsx","path":"/cautions-for-using-collections-in-Java/","result":{"data":{"site":{"siteMetadata":{"title":"log4dh"}},"markdownRemark":{"id":"c87443bb-4e35-55e7-94d5-a5cb70d2dbc8","excerpt":"문제 상황 인스턴스 필드로 List만을 가지는 일급 컬렉션 객체가 있습니다. 필드에   키워드가 존재하기 떄문에 항상 초기화를 해줘야 합니다. 따라서 객체를 생성하려면 생성자를 List를 항상 주입받아야 합니다. 이때, 문제가 발생합니다.  위 테스트 코드를 보면 MyList 인스턴스를 생성할 때,  라는 List가 생성자 파라미터로 전달됩니다. 그렇게 …","html":"<h2>문제 상황</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyList</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MyList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>list <span class=\"token operator\">=</span> list<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        list<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> list<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>인스턴스 필드로 List만을 가지는 일급 컬렉션 객체가 있습니다.</p>\n<p>필드에 <code class=\"language-text\">final</code>  키워드가 존재하기 떄문에 항상 초기화를 해줘야 합니다.</p>\n<p>따라서 객체를 생성하려면 생성자를 List를 항상 주입받아야 합니다.</p>\n<p>이때, 문제가 발생합니다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 661px; '>\n      <a class='gatsby-resp-image-link' href='/static/164ebf47ea7bb6f704655591acc6ab58/4128c/problem.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 66.47058823529413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+0lEQVR42nVSy3KbQBDkQywJFlj2BSwSSDLIsmzZLquSuMpyLkk5hxzz/x/QmV2Egl3KoWtnXzPd0xNECQdLOa4mEYzKUBQGYVYiETmmIcNkyjCd9XDxZBqdMZyPEbAkA+Opf5ywBEoVMIsNVLEAYymiE8IwRhQlPmYxR0jxxYTuwlWb0YcrWrVUqK3FvF6itAsoXSKTBoJnpMDA5BWMseCZupxQqhIskdD0ODcauW1w3e3QdBvosiI20t//gzhBIr6AICbJjp1jGnpJHClXdOYkxf7Oxf063n8+6xEMvZg5A2YRlBCYE7OyqqFNCUk9zVIySxvo3CIvKi/3v6ZE1OA+YeyNEULDlnMYWyEViswgJnQfjlT0b0dOD5NA+yAk13zCUwXnYCZM7+y5DRSz5Oz4gMHts+SIJLte9PPVJ3TJbNV4yUUxJ5dpjEiqW53rpa29bEHOa1MhJvcjmuMwSZFwgUBQj2KqxDMJ6cZDanKLUzVi55jEH1mFQ0x/BpZjBJvtDWzdobv/hueXH/h6/IXVzYHGZ4GCzNF55c1wMMTMYRx/RpAvH7C++45m+4rd4R23z+9Y7t6w2h1RNS2aZo1m1aJaLD8kk9SCSwhM84D28Yi3n3/w5fgb690Luv2RiryiqK9xt3/C/vGAzfYeq3aLNaHd0OCvuov4C4eggRS4E408AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='문제 상황' title='' src='/static/164ebf47ea7bb6f704655591acc6ab58/4128c/problem.png' srcset='/static/164ebf47ea7bb6f704655591acc6ab58/e7570/problem.png 170w,\n/static/164ebf47ea7bb6f704655591acc6ab58/f46e7/problem.png 340w,\n/static/164ebf47ea7bb6f704655591acc6ab58/4128c/problem.png 661w' sizes='(max-width: 661px) 100vw, 661px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>문제 상황</figcaption>\n  </figure></p>\n<p>위 테스트 코드를 보면 MyList 인스턴스를 생성할 때, <code class=\"language-text\">list</code> 라는 List가 생성자 파라미터로 전달됩니다.</p>\n<p>그렇게 <code class=\"language-text\">myList</code> 라는 이름의 인스턴스가 생성된 후, <code class=\"language-text\">list</code>에 \"c\"를 추가합니다.</p>\n<p>그런데 검증문을 보면, <code class=\"language-text\">myList</code> 인스턴스의 필드에는 <code class=\"language-text\">a, b, c</code>가 존재합니다.</p>\n<p>이 문제는 <code class=\"language-text\">myList</code>가 가지는 필드와, <code class=\"language-text\">list</code> 컬렉션이 <strong>같은 참조 값을 가지기 때문입니다.</strong></p>\n<blockquote>\n<p>참조 값에 대한 내용은 <a href=\"https://www.youtube.com/watch?v=AjpJS9WrDrs\">테코톡 - 히이로의 불변</a> 추천드립니다</p>\n</blockquote>\n<p>결국 객체 내부의 참조값과 외부의 참조값을 끊어주는 작업이 필요합니다.</p>\n<p>이를 <strong>방어적 복사</strong>라고 합니다.</p>\n<h2>방어적 복사 첫 번째 방법: 새로운 객체 할당 (new)</h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyList</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MyList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>list <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>메서드 파라미터로 외부의 컬렉션이 들어올 때, <strong>새로운 컬렉션을 만들어</strong> 그 안에 값을 복사하는 방식으로 해결할 수 있습니다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 602px; '>\n      <a class='gatsby-resp-image-link' href='/static/52d58f017f6c098321fec6132fc67cf8/d1b94/defensive_copy.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 72.35294117647058%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACKUlEQVR42oWT13LbMBBF+R2RKDaQANirGmX1YseJZ/L/H3OzC4rSRH7Iw5nFLoGLLaAltILjC8wcH1WuESc5XFnCVxU8xbZAJGPYM8/sYTvC/iuWH0ZwvICcACEJx3GBtF4jSlsEuoTQg6DrCbhuAM8PH3Dsm+CMbzL4mJAtkwRdWaJqWhRVjSwtoOIMUmpkSiHLSuRFjYTiUaRh2y6eGh6sUKZ0m0JT5pAqRtWu0G+OWLztkFYNRJQgEHogjAlt8MfYC5YfSDhuCBFKEo5oo6ISE3gBt0KYVjiugO0O6xHXo5JN2f9iOS7X/mywjiRyKkfqFCGVJHUCISIoipvSVWLwqN/2zL2ffUKCgREabVUUWHQLzFc98rI2Uw9DhVgq6lsJHecGroAnPZ57DOVV0KG0AxLg9ZQaPpk4mEwd/GAmNjEzTMlnQd5j34fK9ptgTLeXVWuy4ey4PE2lKmoBZxYnhZkw+/Ie46fnCU5EwuLGshC/qUDIhwCLDYJ0iGxEcfZZbBTk4SmdkaA0giJSsMq6Q9102J+u2B3O2OyOBl7zN3nPZCC5M/hmSHc7YhVU3ny1wXzZ4/bxhe3+jKZboiO/na9oMI0h48dMj/p/WNvTGZ+//+D95xcu108cTzecyV7ff6FZLinbAw4UGzKe09/T0V80EFPpr1h53WJ3uuB6+8Tp+mGE9scLukVPWTVY9Ttij+V6a+yaYNu/HbDe0Hq9w2K1NZbjfwGQTqHF93rkKAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='새로운 객체 할당' title='' src='/static/52d58f017f6c098321fec6132fc67cf8/d1b94/defensive_copy.png' srcset='/static/52d58f017f6c098321fec6132fc67cf8/e7570/defensive_copy.png 170w,\n/static/52d58f017f6c098321fec6132fc67cf8/f46e7/defensive_copy.png 340w,\n/static/52d58f017f6c098321fec6132fc67cf8/d1b94/defensive_copy.png 602w' sizes='(max-width: 602px) 100vw, 602px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>새로운 객체 할당</figcaption>\n  </figure></p>\n<h2>List.copyOf()</h2>\n<p>또 다른 방식으로 <code class=\"language-text\">List.copyOf()</code> 메서드가 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyList</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MyList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>list <span class=\"token operator\">=</span> <span class=\"token class-name\">List</span><span class=\"token punctuation\">.</span><span class=\"token function\">copyOf</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 574px; '>\n      <a class='gatsby-resp-image-link' href='/static/577b2e1b439367077851fa3c67586a65/312c2/list_copyof.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 70.58823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACRUlEQVR42n1T2W7bQAzUbzSNDx0rabXSWvftM07aNChaGEiRh/7/b0zJtewcLfowIMU1jxnSliN8zOYOpAxQ5Qq2kFh4EZxAwxUhlraH+cJ5h8XSveLjmyWUxIwc4QrEoYSvG4RpDy9pIQJlkm5nS2pq45ZB/gUc+6vg7cw2SVzUcTwUKsIqWSFJUqzSAipeIdYZZBghVQp6VVC8RJqV8Knhx6KWcabRBVFsmgFNOyJtaoRRbCgzuOnSdmE74op/yUEFzx1mZG2indA0epUjjGM4rm8m+B/O+a+wHE8iIipFprF0JQKpIXxF3X0qGILfXcGIjH9GCJesR7H3kLCWtjCTuF4A35foywJ9v0ZR9ajqHlnRQMkYhU5Rlj2ho7d20o9pupNkLIt31vCyfo80zPIKOs3RdiN2+yM2uzsUZYuuGrGtD1iPe7TDiKysaWGpWVoYKkQBDSQCWBctLudx83mOTzczos1SaMgoMZYT39pQvsaDIIL0AwR+CMs8UFLdDsjLhijWqJqeEs5L4eNmOCTJ1U6+K976pCkNYfE9taTZZnfE49MP3H95MjS5QUr0Fd0j3yHbix/rdPrOpu8zFMHqho0p1vYbHI5fsTs8mAbr7QFVN6CoWzNx24/XBlwoodNS9AeQKpmgjbXGwwGn5xf8evmNn6dn7O8eTNGn7yfkVYNhs8fd/SOOD98wrPc0+YimW6MbtsbPaWElXQPboupgcVWd5UY/psmdOcaT+CR2mlXmx3w+nGBAp1NOZ1VOyIvWxP4A7DamUWXHfVoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='List.copyOf()' title='' src='/static/577b2e1b439367077851fa3c67586a65/312c2/list_copyof.png' srcset='/static/577b2e1b439367077851fa3c67586a65/e7570/list_copyof.png 170w,\n/static/577b2e1b439367077851fa3c67586a65/f46e7/list_copyof.png 340w,\n/static/577b2e1b439367077851fa3c67586a65/312c2/list_copyof.png 574w' sizes='(max-width: 574px) 100vw, 574px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>List.copyOf()</figcaption>\n  </figure></p>\n<p>하지만 이 메서드의 경우, 위 테스트 코드에서 볼 수 있듯이 값을 쓰거나 수정하거나 삭제하는 메서드에 대해서는 <code class=\"language-text\">UnsupportedOperationException</code>을 발생합니다.</p>\n<p>그 이유로는 <code class=\"language-text\">copyOf()</code> 메서드를 까보면 최종적으로 <code class=\"language-text\">ImmutableCollections.ListN&lt;>()</code> 메서드가 호출되는데요.<br>\n<code class=\"language-text\">ImmutableCollections.ListN&lt;E></code>는 <code class=\"language-text\">AbstractImmutableList&lt;E></code>를 상속하고 있으며<br>\n<code class=\"language-text\">AbstractImmutableList&lt;E></code>는 아래와 같이 쓰기 작업에 대해 예외를 던지고 있기 때문입니다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/603b31214448b566070db040479c34da/f91ec/AbstractImmutableList.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 44.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpUlEQVR42k1SuW4bMRTUh0h78ni897Kk2HDpwnCRv0iVIP9fTYYUZKQYcElw583B05YK1lzwfuy4LwW32zu2j1+4f/7G69cf3D7/Ir7+RAoBL2VFWV6wHT9wXN+wc932O/d3+OXArD1Ol27CMCgEcXDWwUiAMg4iHj5kOBcxTRrdMKMfVUPXTzhfhoZLRVcxtvPTOCnEFPizR44ZwXmEuMDFFdEHxLzzu1DJlfcWlJiQy8ahHj2HVKILidpKkHCG9wZiNby1cFojGAMlBVoyz6vqCPEJlmrrPjgK4OBJWShCzxqarmZ+n6ZZMRfH6YKVKr1IU+LS3pBTRqLy6CPW7QrrM4zSEGMxKoHWFkIRNZpK2iyHwENnEKVeMBjdBuPKI8e0UpW0KISZVkX9qJvdkRiY6aWfcT73T8uKlkko5tuyM4LR75j8xmwLUubKHJXUfEuD5Z3IItu5FnTPUqrlnF1TuXjmRSs6HUi02MJn62U9WuPJuUdRjGSazXcZleiJRpiyNMJMwkiVvuYRD6wkynxfjiXUOCq5tXwNJE4kNfbR9P+E/wCz/gpmZQf6LwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='AbstractImmutableList의 쓰기 작업 메서드들' title='' src='/static/603b31214448b566070db040479c34da/ca1dc/AbstractImmutableList.png' srcset='/static/603b31214448b566070db040479c34da/e7570/AbstractImmutableList.png 170w,\n/static/603b31214448b566070db040479c34da/f46e7/AbstractImmutableList.png 340w,\n/static/603b31214448b566070db040479c34da/ca1dc/AbstractImmutableList.png 680w,\n/static/603b31214448b566070db040479c34da/f91ec/AbstractImmutableList.png 714w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>AbstractImmutableList의 쓰기 작업 메서드들</figcaption>\n  </figure></p>\n<p>추가로 <code class=\"language-text\">List.copyOf()</code>도 새로운 객체가 생성되고 값을 복사하는 <em>방어적 복사</em>가 이루어집니다.</p>\n<p>아래 사진은 <code class=\"language-text\">ImmutableCollections.ListN&lt;>()</code>의 생성자입니다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 606px; '>\n      <a class='gatsby-resp-image-link' href='/static/c001ea030157f4fc6f205a04574e4b3e/cec09/last_method_of_copyof.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABHUlEQVR42pWR207EIBiEeRC3WyinclgoPW3NarLxyvd/oPEHTTS6N158YQJh/hlgl1KQ1gU+WIQYIdWInkt0HUd3Fv+GcZ1g0g7rLpiXK1KaoY1vSD1CDBpKu6aVdej7AaeuJ/hDWD0sy4772zuO2x3aBiipYS2ZEsqQEZkZ6aBqeqEwSANOg/hPTdThrKN6PiaUXOB9xDitCKPHumxYt2fs5UCOC0rYEENuJi09mUtlSbtmWnXdY2fqPXCBnCeUaYYNqSVe1gPX44bb/orj+oJ53VHmjd45t2pPp75Vb+sXVTMhLfw4IdiJpgX6nNwSnHtFaXSrWOHCUCVDaWzTn+g/mint4UxCcpTORMTLDDNGehMyoMti+I15sPfNB79hy8Lyw0JkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='List.copyOf()의 최종 실행 메서드' title='' src='/static/c001ea030157f4fc6f205a04574e4b3e/cec09/last_method_of_copyof.png' srcset='/static/c001ea030157f4fc6f205a04574e4b3e/e7570/last_method_of_copyof.png 170w,\n/static/c001ea030157f4fc6f205a04574e4b3e/f46e7/last_method_of_copyof.png 340w,\n/static/c001ea030157f4fc6f205a04574e4b3e/cec09/last_method_of_copyof.png 606w' sizes='(max-width: 606px) 100vw, 606px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>List.copyOf()의 최종 실행 메서드</figcaption>\n  </figure></p>\n<p>가변 인자로 값을 받고 새로운 객체를 만들고 모든 요소에 대해 null 체크를 하며 값을 복사합니다.</p>\n<p>결과적으로 다른 객체가 생성되어 외부 컬렉션과 참조가 끊어집니다.</p>\n<h2>Collections.unmodifiableList()</h2>\n<p>이 메서드를 사용하면 읽기 전용 컬렉션을 만들 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MyList</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MyList</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> list<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>list <span class=\"token operator\">=</span> <span class=\"token class-name\">Collections</span><span class=\"token punctuation\">.</span><span class=\"token function\">unmodifiableList</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 588px; '>\n      <a class='gatsby-resp-image-link' href='/static/f4492226d6a8c9c556ae15c6545248be/f81fd/unmodifiable_list.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 65.29411764705883%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACPElEQVR42n1S2W7bMBDUd7Q+ROoiRVG3ZFuSD9lxnLiBUQRF0T70/z9juqTtoEbRPoyGXC5Hu7N0vFDA9XzMXQ91qaB0grkXg4UJWKCINViU2j0neL6wuXfM5vwBTijpchDYwzgIIVQBUQwI9AJMlvCIPdWCqwZeUiMIJWYzhukNfwm6ro/plGEy4/g0dZGrGEWikOcV8qKCTlIopRFFEjoKoZKM4jUyOhcy+RC+w4mkhstCaKXAvRBt22MYRqw2W+RNSxVRnNrkvrTtepava+4JMB49wBEytYs81TZJqhw6rRDrDJKq8QJ5TfYeL5o9txAPcFzmW08mU26Zc//mE6fY/OYTw9x45PJ/DuPDQ0ZtmoURNj62RYF+ucKq26Bd9MRraJ2TrwmWdYemWqFd9lS9xmTi4vPE/NSlu6Yo8nDOAluBETXVRCJBKBTStLSiXb+1wkXZYrsY0S3XWA0blHWLLKtuw9HQguwSkoZCAqY6n95jREKMBxZ+IOxEY5VCxjRlmmgolc0x072zOY+iGDISCMkqZ709IM1KbHYHPD2fcTx9IX7Fdn/E4fiCI8X69QhNOYKEjbhldWURJ1cmYQMnpbfWLDpUzRLdsMPp9YK67VBULUqKZfTmUmrLsBFV5Of/4AzjHufLV3z/+Qtvl3ecXt7wcr7g/dsPPJ3OWPSDrX7/dKJKd8jLxv7sisaKJGnxAcd8ira1F8bDM4bNiB21a9o3QmW9QEYiSxrQsDlQFyMJ7y3+3Jtzs/4NK7CL0I1XiYYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Collections.unmodifiableList()' title='' src='/static/f4492226d6a8c9c556ae15c6545248be/f81fd/unmodifiable_list.png' srcset='/static/f4492226d6a8c9c556ae15c6545248be/e7570/unmodifiable_list.png 170w,\n/static/f4492226d6a8c9c556ae15c6545248be/f46e7/unmodifiable_list.png 340w,\n/static/f4492226d6a8c9c556ae15c6545248be/f81fd/unmodifiable_list.png 588w' sizes='(max-width: 588px) 100vw, 588px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Collections.unmodifiableList()</figcaption>\n  </figure></p>\n<p>하지만 <code class=\"language-text\">List.copyOf()</code>와 비교해서 한 가지 중요한 점이 있습니다.</p>\n<p>아래 테스트 코드처럼, 외부에 존재하는 컬렉션의 값을 수정하면 그대로 <code class=\"language-text\">myList</code>에 반영이 된다는 사실입니다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 623px; '>\n      <a class='gatsby-resp-image-link' href='/static/7719f4edf72b9ac56f3e7f95b34595c0/6007f/weekpoint_of_unmodifialeList.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 72.94117647058825%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACY0lEQVR42n2T3XLaMBCFeZGCJVm2Zcs/2NhAiLENJYQknWlzlXZ60ZlOZ9L3f4CTXSUhKaW9+EZCslbnrA6jsVBQvo96ZqECg7GM4OkYns8k8FQE4RsInTg8Qvn0jfAxnsi/GE2kD+Ep2MggzBeIqxbSlBBRAWUbqHgGmS5oPodMaoeOLITU+HCu4OvEI6V1liLPckzLGbJsiiRJYYxFpDWsMUjTwmHiFB4XHIszBUkdT5QfYr5YYbFsUV0sEEZkT2iHIHuCRxk4PHne7ktBmlBR7gkX4dv94K1HE4b233NO2Yll5SynUUA2M6RZSZBlsheHIfI0g81L5EXl1v5fkBROxIttFUAS4/GzKlZ+qvBfhY4FldIoUoqICFDO5qhqeml6GI6GK0jWJ94J4h0neyOlDXQQQ1H2gihFaFKXR0nZk5TBV4QKj0i6zKEMXfwnx1fmXLG6spq7HiY2R5zksDTyQ3FPeT2jXkYUJd6LaF1QpBipA/g6omB7zxkUFAVJ9hlNr8wxUj59RHBbtA4RhDE0wQc1uVA0shCHOxtglBYN1ttbdB/vaLzBqrtGuzmgHQ4036PffUJPe2XTIUqmTlXM6m0Gk7zBiplRvbpGRQyHB2yIcnmF+vIGTXtAMd+639PFDrbqkeQNHXorwm3hGCW2cJfwfLT9/AtXXx5xff+IPY37+9/ob39iuv6Kqv+Gon1As/mO7uYHbNngol2jH3YYtleu5/m0RkF/1aqew1KfSWGHze6ObO7RkeVhd4u232NNlgda57V62aGsV6SiwMVlj7bb4nK9pfmAVbs5ri1XPZ4A+NHCnIOU/wkAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Collections.unmodifiableList()의 약점' title='' src='/static/7719f4edf72b9ac56f3e7f95b34595c0/6007f/weekpoint_of_unmodifialeList.png' srcset='/static/7719f4edf72b9ac56f3e7f95b34595c0/e7570/weekpoint_of_unmodifialeList.png 170w,\n/static/7719f4edf72b9ac56f3e7f95b34595c0/f46e7/weekpoint_of_unmodifialeList.png 340w,\n/static/7719f4edf72b9ac56f3e7f95b34595c0/6007f/weekpoint_of_unmodifialeList.png 623w' sizes='(max-width: 623px) 100vw, 623px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Collections.unmodifiableList()의 약점</figcaption>\n  </figure></p>\n<p>그 원인은 다음과 같습니다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 347px; '>\n      <a class='gatsby-resp-image-link' href='/static/eacd099c673e6432ead11135c93ba4ba/c8500/last_method_of_unmodifiableList.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 39.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVR42o2R2W7bMBBF9RlNa4niJm5aSFmL41hyaiBvAfL/X3M7YoM8FAXah4NLcjgczp2idw77lDD3LYY047a9Io4LxjZgO0c85oSJYvI8obcRW9zR+YiScVS1RMXEbyUYUXAuYJWCIlWqgbUeXNBeSBipYJSmtUJJcK7RSA8hDU4VR/nJqay/KJiwYE2PmuAEUyFTKU/nLYQyUI2D1i4X0krmIpqK19pCUtzYgMZ4WNehUO2MsH3AX99hlresljSvlwfW9YqX2z3bMfiAO9nwc4qYYg85JHQd2bA/ME4r1ssNhRCavsowWIN76rAm8my54PqywVPFb08nPH0vczu5vU/Kv7R8+FmwWuEHbeauxX0a0LsBt7RjaM9wocM0XxDTlC8fyRX7E/HFES/Wy4bQJngTMPaRfjUghQXO9ORLSxNf6cEFSnvyy/2TYn99w3h+Rk3DETpANgH8SCZVhKBLB5oG9D/8Ar+X7CASyAE/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Collections.unmodifiableList()의 최종 실행 메서드' title='' src='/static/eacd099c673e6432ead11135c93ba4ba/c8500/last_method_of_unmodifiableList.png' srcset='/static/eacd099c673e6432ead11135c93ba4ba/e7570/last_method_of_unmodifiableList.png 170w,\n/static/eacd099c673e6432ead11135c93ba4ba/f46e7/last_method_of_unmodifiableList.png 340w,\n/static/eacd099c673e6432ead11135c93ba4ba/c8500/last_method_of_unmodifiableList.png 347w' sizes='(max-width: 347px) 100vw, 347px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Collections.unmodifiableList()의 최종 실행 메서드</figcaption>\n  </figure></p>\n<p>파라미터로 넘어오는 외부 컬렉션인 <code class=\"language-text\">list</code>를 아무런 조치없이 그대로 할당하는 것을 볼 수 있습니다.</p>\n<p>따라서, 내부적으로는 값의 변경이 막혀있지만, 외부의 컬렉션과는 같은 레퍼런스를 참조하고 있다는 것을 확인할 수 있습니다.</p>","frontmatter":{"title":"Java에서 컬렉션을 사용할 때 주의할 점","date":"December 11, 2023","update":null,"tags":["java"],"series":null},"fields":{"slug":"/cautions-for-using-collections-in-Java/","readingTime":{"minutes":4.725}}},"seriesList":{"edges":[{"node":{"id":"15ca77a9-4e26-59d5-8c4a-94f6fbae3a07","fields":{"slug":"/unit-test/"},"frontmatter":{"title":"단위 테스트"}}},{"node":{"id":"89b57813-f839-5a4e-b503-545830aec1fb","fields":{"slug":"/using-junit-and-assertJ/"},"frontmatter":{"title":"JUnit과 AssertJ 활용법"}}},{"node":{"id":"6a5cce31-fad7-5c11-bd05-2e75410c5cd0","fields":{"slug":"/about-tdd/"},"frontmatter":{"title":"TDD에 대해"}}},{"node":{"id":"014bd317-3394-5c4d-9a72-e1319712838a","fields":{"slug":"/03-user-identification/"},"frontmatter":{"title":"MySQL에서의 사용자 식별에 대해"}}},{"node":{"id":"10e0dab4-d2e7-52df-8daa-31bfef1b08b6","fields":{"slug":"/static-with-memory-structure/"},"frontmatter":{"title":"static을 더 잘 사용하기"}}},{"node":{"id":"c773b0a0-9610-5605-bdb9-9089df57f52b","fields":{"slug":"/about-garbage-collection/"},"frontmatter":{"title":"JVM의 Garbage Collection과 동작 원리"}}},{"node":{"id":"0bf99b61-98a4-5c40-b8ce-05a918d212f7","fields":{"slug":"/garbage-collection-tuning/"},"frontmatter":{"title":"Garbage Collection 튜닝에 대해"}}},{"node":{"id":"61bd95c2-424a-54c8-96d9-bec4c8a4f58c","fields":{"slug":"/garbage-collection-algorithms/"},"frontmatter":{"title":"Garbage Collection 알고리즘"}}},{"node":{"id":"c87443bb-4e35-55e7-94d5-a5cb70d2dbc8","fields":{"slug":"/cautions-for-using-collections-in-Java/"},"frontmatter":{"title":"Java에서 컬렉션을 사용할 때 주의할 점"}}}]},"previous":{"fields":{"slug":"/garbage-collection-algorithms/"},"frontmatter":{"title":"Garbage Collection 알고리즘"}},"next":{"fields":{"slug":"/why-use-collection-instead-of-array/"},"frontmatter":{"title":"배열 대신 컬렉션을 쓴다. 왜?"}}},"pageContext":{"id":"c87443bb-4e35-55e7-94d5-a5cb70d2dbc8","series":null,"previousPostId":"61bd95c2-424a-54c8-96d9-bec4c8a4f58c","nextPostId":"35d8f587-ab7e-50fa-a624-8d68aec98522"}},"staticQueryHashes":[],"slicesMap":{}}