<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.14.5"/><meta name="description" content="JPA 기본기를 학습하고 이를 기록했습니다." data-gatsby-head="true"/><meta property="og:title" content="JPA 기본기" data-gatsby-head="true"/><meta property="og:description" content="JPA 기본기를 학습하고 이를 기록했습니다." data-gatsby-head="true"/><meta property="og:type" content="article" data-gatsby-head="true"/><meta property="og:url" content="https://kdkdhoho.github.io/posts/jpa/" data-gatsby-head="true"/><meta property="og:site_name" content="김동호 블로그" data-gatsby-head="true"/><meta property="og:locale" content="ko_KR" data-gatsby-head="true"/><meta property="og:image" content="https://kdkdhoho.github.io/static/065347829ad8e5381a4b6c153aa843a2/f058b/thumbnail.png" data-gatsby-head="true"/><meta property="article:published_time" content="2026-02-12" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="JPA 기본기" data-gatsby-head="true"/><meta name="twitter:description" content="JPA 기본기를 학습하고 이를 기록했습니다." data-gatsby-head="true"/><meta name="twitter:image" content="https://kdkdhoho.github.io/static/065347829ad8e5381a4b6c153aa843a2/f058b/thumbnail.png" data-gatsby-head="true"/><style data-href="/styles.1ac54d2a2f310ebc8f8a.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Pretendard;font-style:normal;font-weight:400;src:url(/static/pretendard-latin-400-normal-38bed7de46e7b9049cedbede041d23ed.woff2) format("woff2"),url(/static/pretendard-latin-400-normal-303253288b0ba99db532e29a364b0c09.woff) format("woff")}
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--maxWidth-wrapper-large:64rem;--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:"Pretendard",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Pretendard","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-bold:700;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#2563eb;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5;--color-bg:#fff;--color-bg-body:#f7f8fa;--color-bg-secondary:#f1f5f9;--color-border:#e2e8f0;--color-card-bg:#fff;--color-sidebar-bg:#fff}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{background-color:var(--color-bg-body);color:var(--color-text);font-family:var(--font-body);font-size:var(--fontSize-1);transition:all .3s ease-in-out}@keyframes fadeInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.global-wrapper{animation:fadeInUp .6s ease-out}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);letter-spacing:-.025em;line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-6);margin-top:var(--spacing-12)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-bold)}h1{color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:outside;margin-bottom:var(--spacing-8);margin-left:var(--spacing-0);margin-right:var(--spacing-0)}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper-large);padding:0 var(--spacing-5) var(--spacing-10) var(--spacing-5)}@media (min-width:1024px){.global-wrapper{padding:0 var(--spacing-8) var(--spacing-10) var(--spacing-8)}}@media (max-width:42rem){.global-wrapper{padding:var(--spacing-6) var(--spacing-4)}blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}@media (min-width:80rem){.global-wrapper{max-width:1400px}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.search-module--searchContainer--8062c{--color-nav-blue:#2563eb;--color-nav-blue-soft:#dbeafe;--color-nav-border:#c7d8f5;max-width:22rem;position:relative;width:100%}.search-module--inlineSearchField--2c564{position:relative}.search-module--searchIcon--8a607{color:#4b5f7f;height:1rem;left:var(--spacing-3);pointer-events:none;position:absolute;top:50%;transform:translateY(-50%);width:1rem}.search-module--searchIcon--8a607 svg{fill:currentColor;height:100%;width:100%}.search-module--inlineSearchInput--04259,.search-module--searchInput--bccbf{background:#f8fbff;border:1px solid var(--color-nav-border);border-radius:999px;color:var(--color-heading);font-size:var(--fontSize-0);outline:none;transition:border-color .2s ease,box-shadow .2s ease,background-color .2s ease;width:100%}.search-module--inlineSearchInput--04259{height:2.25rem;padding:.45rem var(--spacing-4) .45rem calc(var(--spacing-4) + 1rem)}.search-module--searchInput--bccbf{background:#fff;border:0;border-bottom:1px solid var(--color-nav-border);border-radius:0;padding:var(--spacing-3) var(--spacing-4)}.search-module--inlineSearchInput--04259::placeholder,.search-module--searchInput--bccbf::placeholder{color:#6b7d98}.search-module--inlineSearchInput--04259:focus,.search-module--searchInput--bccbf:focus{background:#fff;border-color:var(--color-nav-blue);box-shadow:0 0 0 3px rgba(37,99,235,.15)}.search-module--searchDropdown--2b910{background:#fff;border:1px solid var(--color-nav-border);border-radius:12px;box-shadow:0 10px 26px rgba(21,64,126,.14);overflow:hidden;position:absolute;right:0;top:calc(100% + .5rem);width:min(22rem,calc(100vw - 2rem));z-index:40}.search-module--searchResults--5406e{max-height:22rem;overflow-y:auto}.search-module--searchResultsHeader--0602f{align-items:center;background:#f7faff;border-bottom:1px solid #e2ebfb;display:flex;font-size:.75rem;justify-content:space-between;padding:var(--spacing-3) var(--spacing-4)}.search-module--searchResultsHeader--0602f span{color:#274f97;font-weight:600}.search-module--searchResultsHeader--0602f small{color:#6b7d98}.search-module--searchResultItem--ea366{background:#fff;border:0;border-bottom:1px solid #ebf1fc;cursor:pointer;padding:var(--spacing-4);text-align:left;transition:background-color .18s ease;width:100%}.search-module--searchResultItem--ea366:focus-visible,.search-module--searchResultItem--ea366:hover{background:var(--color-nav-blue-soft)}.search-module--searchResultItem--ea366:last-child{border-bottom:0}.search-module--searchResultItem--ea366 h4{color:var(--color-heading);font-size:var(--fontSize-0);line-height:1.3;margin:0 0 var(--spacing-2)}.search-module--searchResultItem--ea366 p{color:var(--color-text-light);font-size:.75rem;line-height:1.4;margin:0 0 var(--spacing-1)}.search-module--searchResultItem--ea366 small{color:#6b7d98;font-size:.72rem}.search-module--searchNoResults--31679{padding:var(--spacing-6);text-align:center}.search-module--searchNoResults--31679 p{color:var(--color-heading);font-size:var(--fontSize-0);margin:0 0 var(--spacing-2)}.search-module--searchNoResults--31679 small{color:#6b7d98;font-size:.72rem}.search-module--searchToggle--76220{align-items:center;background:#f8fbff;border:1px solid var(--color-nav-border);border-radius:999px;color:#274f97;cursor:pointer;display:inline-flex;height:2.25rem;justify-content:center;width:2.25rem}.search-module--searchToggle--76220 svg{fill:currentColor;height:1rem;width:1rem}.search-module--searchToggle--76220:focus-visible,.search-module--searchToggle--76220:hover{background:var(--color-nav-blue-soft);border-color:var(--color-nav-blue)}@media (max-width:42rem){.search-module--searchContainer--8062c{max-width:8.25rem}.search-module--inlineSearchInput--04259{font-size:.74rem;height:2rem;min-width:8.25rem;padding:.38rem .65rem .38rem 1.75rem}.search-module--searchIcon--8a607{height:.9rem;left:.55rem;width:.9rem}.search-module--searchDropdown--2b910{right:0;width:min(20rem,calc(100vw - 1.5rem))}}.bio-module--bioCard--3293a{align-items:flex-start;background:#fff;border:1px solid #d6e3fa;border-radius:14px;box-shadow:0 10px 24px rgba(37,99,235,.06);display:flex;gap:var(--spacing-4);margin-bottom:var(--spacing-12);padding:var(--spacing-5)}.bio-module--avatar--e54eb{border:1px solid #d6e3fa;border-radius:999px;flex-shrink:0}.bio-module--content--6ef75{min-width:0}.bio-module--compactContent--73a50{align-items:flex-start;display:flex;flex-direction:column;gap:var(--spacing-2);justify-content:center;min-width:0;width:100%}.bio-module--compactText--c1ec9{min-width:0}.bio-module--name--b0be6{color:#1e3a8a;font-size:var(--fontSize-1);font-weight:700;margin:0 0 var(--spacing-1)}.bio-module--compactContent--73a50 .bio-module--name--b0be6{font-size:.9rem;margin:0}.bio-module--compactDescription--a8df7{color:#475569;font-size:.75rem;line-height:1.45;margin:0}.bio-module--summary--e6cb7{color:var(--color-text-light);font-size:.92rem;line-height:1.65;margin:0}.bio-module--tags--abab9{display:flex;flex-wrap:wrap;gap:var(--spacing-2);margin-top:var(--spacing-3)}.bio-module--tagLink--18022{align-items:center;background:#dbeafe;border:1px solid #bfdbfe;border-radius:999px;color:#1d4ed8;display:inline-flex;height:2.05rem;justify-content:center;text-decoration:none;transition:background-color .18s ease,border-color .18s ease,color .18s ease,box-shadow .18s ease;width:2.05rem}.bio-module--tagLink--18022:focus-visible,.bio-module--tagLink--18022:hover{background:#bfdbfe;border-color:#93c5fd;box-shadow:0 0 0 3px rgba(37,99,235,.16);color:#1e40af}.bio-module--tagIcon--f5e11{height:1rem;width:1rem}.bio-module--compactBio--f9b9a{box-shadow:0 6px 18px rgba(37,99,235,.07);margin-bottom:var(--spacing-4);padding:var(--spacing-3) var(--spacing-4)}.bio-module--compactBio--f9b9a .bio-module--tags--abab9{margin-top:0}.bio-module--compactBio--f9b9a .bio-module--tagLink--18022{height:1.9rem;width:1.9rem}@media (max-width:42rem){.bio-module--bioCard--3293a{margin-bottom:var(--spacing-4)}.bio-module--tags--abab9{justify-content:center}.bio-module--compactBio--f9b9a{align-items:center;gap:var(--spacing-3);margin-bottom:var(--spacing-2);padding:.65rem .85rem}.bio-module--compactContent--73a50{align-items:center;flex-direction:row;gap:var(--spacing-3);justify-content:space-between}.bio-module--compactText--c1ec9{flex:1 1;min-width:0;text-align:left}.bio-module--compactBio--f9b9a .bio-module--tags--abab9{flex-wrap:nowrap;gap:.35rem;justify-content:flex-end;margin-top:0}.bio-module--compactBio--f9b9a .bio-module--tagLink--18022{height:1.7rem;width:1.7rem}.bio-module--compactBio--f9b9a .bio-module--compactDescription--a8df7{font-size:.72rem;line-height:1.35;margin-top:.08rem}}.layout-module--globalHeader--d828d{--color-nav-blue:#2563eb;--color-nav-blue-soft:#dbeafe;--color-nav-border:#d1dff5;border-bottom:1px solid var(--color-nav-border);margin-bottom:var(--spacing-6);margin-top:var(--spacing-4)}.layout-module--headerContainer--c48da{align-items:center;display:grid;gap:var(--spacing-4);grid-template-columns:minmax(0,1fr) auto minmax(0,1fr);padding:0 0 var(--spacing-4)}.layout-module--headerSide--63b5d{align-items:center;display:flex;min-width:0}.layout-module--headerCenter--747d9{align-items:center;display:flex;justify-content:center}.layout-module--headerRight--d5448{align-items:center;display:flex;justify-content:flex-end;min-width:14rem}.layout-module--mainHeading--acad2{font-size:var(--fontSize-3);font-weight:800;line-height:1.2;margin:0}.layout-module--titleLink--a4c58{color:var(--color-heading);font-size:var(--fontSize-3);font-weight:800;letter-spacing:-.01em;text-decoration:none;transition:color .2s ease}.layout-module--titleLink--a4c58:focus-visible,.layout-module--titleLink--a4c58:hover{color:var(--color-nav-blue)}.layout-module--layoutContainer--2ee2a{display:flex;flex-direction:column;gap:var(--spacing-8)}.layout-module--postWrapper--01261{max-width:88rem}.layout-module--sidebar--65e08{position:-webkit-sticky;position:sticky;top:1.75rem}.layout-module--sidebarSection--78de8{background:linear-gradient(180deg,#f8fbff,#fdfefe);border:1px solid #d6e3fa;border-radius:14px;box-shadow:0 10px 26px rgba(37,99,235,.08);padding:var(--spacing-5)}.layout-module--sidebarSection--78de8+.layout-module--sidebarSection--78de8{margin-top:var(--spacing-4)}.layout-module--sidebarTitle--1b0b5{border-bottom:1px solid #d6e3fa;color:#1e3a8a;font-size:var(--fontSize-1);letter-spacing:.02em;margin:0 0 var(--spacing-4);padding-bottom:var(--spacing-2)}.layout-module--latestPostList--5cbe9{list-style:none;margin:0;padding:0}.layout-module--latestPostListItem--7ce3b+.layout-module--latestPostListItem--7ce3b{margin-top:var(--spacing-3)}.layout-module--latestPostLink--c63ff{color:#1f2937;display:block;font-size:.9rem;line-height:1.4;text-decoration:none;transition:color .18s ease}.layout-module--latestPostLink--c63ff:focus-visible,.layout-module--latestPostLink--c63ff:hover{color:#1d4ed8}.layout-module--latestPostDate--bc893{color:#64748b;display:block;font-size:.75rem;margin-top:.2rem}.layout-module--categoryScrollArea--495be{max-height:calc(100vh - 13rem);overflow-y:auto;overscroll-behavior:contain;padding-right:.25rem}.layout-module--sidebarCategoryList--f27f3{list-style:none;margin:0;padding:0}.layout-module--sidebarCategoryListItem--07ff4{margin:0}.layout-module--sidebarCategoryListItem--07ff4+.layout-module--sidebarCategoryListItem--07ff4{margin-top:var(--spacing-1)}.layout-module--sidebarCategoryItem--b3e02{--depth:0;align-items:center;border-radius:10px;color:#334155;display:flex;gap:var(--spacing-3);justify-content:space-between;padding:.5rem .625rem;padding-left:calc(.625rem + var(--depth)*.75rem);text-decoration:none;transition:background-color .18s ease,color .18s ease}.layout-module--sidebarCategoryItem--b3e02:focus-visible,.layout-module--sidebarCategoryItem--b3e02:hover{background:#eaf2ff;color:#1d4ed8}.layout-module--activeCategory--8af0e{background:#2563eb;color:#fff}.layout-module--activeCategory--8af0e .layout-module--categoryCount--f72a4{background:hsla(0,0%,100%,.2);color:#fff}.layout-module--categoryName--a37ca{font-size:.9rem;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.layout-module--categoryCount--f72a4{align-items:center;background:#dbeafe;border-radius:999px;color:#1d4ed8;display:inline-flex;flex-shrink:0;font-size:.72rem;font-weight:600;height:1.25rem;justify-content:center;min-width:1.75rem;padding:0 .4rem}.layout-module--mainContent--2f1b6{max-width:100%;min-width:0;overflow-x:hidden}.layout-module--siteFooter--80c5d{border-top:1px solid var(--color-border);color:var(--color-text-light);font-size:var(--fontSize-0);margin-top:var(--spacing-16);padding:var(--spacing-12) 0;text-align:center}.layout-module--siteFooterLink--72b70{color:#2563eb;font-weight:500;text-decoration:none}@media (min-width:768px){.layout-module--layoutContainer--2ee2a{align-items:start;display:grid;gap:var(--spacing-10);grid-template-columns:280px minmax(0,1fr)}.layout-module--postLayoutContainer--36d0e{gap:2.75rem;grid-template-columns:240px minmax(0,1fr)}}@media (min-width:1280px){.layout-module--postWrapper--01261{max-width:none;padding-left:1.25rem;padding-right:1.75rem;width:100%}.layout-module--postLayoutContainer--36d0e{margin-left:18.75rem;margin-right:20rem}.layout-module--postGlobalHeader--933d9{border-bottom:0;position:relative}.layout-module--postGlobalHeader--933d9:after{background:var(--color-nav-border);bottom:0;content:"";height:1px;left:18.75rem;position:absolute;right:0}.layout-module--postHeaderContainer--cfcda{max-width:none}.layout-module--postLayoutContainer--36d0e{display:block}.layout-module--postSidebar--e569d{height:calc(100vh - 2.5rem);left:1.25rem;overflow-y:auto;padding-right:.25rem;position:fixed;top:1.25rem;width:17.5rem;z-index:20}.layout-module--postMainContent--3004a{margin:0 auto;max-width:min(82rem,calc(100vw - 41.25rem));width:100%}}@media (min-width:1600px) and (max-width:2199px){.layout-module--postLayoutContainer--36d0e{margin-right:21.25rem}.layout-module--postMainContent--3004a{max-width:min(86rem,calc(100vw - 42.5rem))}}@media (min-width:2200px){.layout-module--postWrapper--01261{margin:0 auto;max-width:132rem;padding-left:clamp(1.5rem,2vw,3rem);padding-right:clamp(1.5rem,2vw,3rem);width:100%}.layout-module--postGlobalHeader--933d9:after{left:0}.layout-module--postLayoutContainer--36d0e{align-items:start;display:grid;gap:1.5rem;grid-template-columns:17.5rem minmax(0,1fr);margin-left:0}.layout-module--postSidebar--e569d{height:calc(100vh - 2.5rem);left:auto;padding-right:.25rem;position:-webkit-sticky;position:sticky;top:1.25rem;width:17.5rem}.layout-module--postMainContent--3004a{max-width:100%;width:100%}}@media (min-width:900px) and (max-width:1279px){.layout-module--postLayoutContainer--36d0e{gap:0;grid-template-columns:minmax(0,1fr)}.layout-module--postSidebar--e569d{display:none}.layout-module--postMainContent--3004a{max-width:100%;overflow:visible;width:100%}}@media (max-width:42rem){.layout-module--layoutContainer--2ee2a{gap:var(--spacing-4)}.layout-module--globalHeader--d828d{margin-bottom:var(--spacing-4);margin-top:var(--spacing-3)}.layout-module--headerContainer--c48da{gap:var(--spacing-2);grid-template-columns:minmax(0,1fr) auto;padding-bottom:var(--spacing-3)}.layout-module--headerSide--63b5d{display:none}.layout-module--headerCenter--747d9{justify-content:flex-start;min-width:0;padding-left:.25rem}.layout-module--headerRight--d5448{min-width:7rem}.layout-module--mainHeading--acad2,.layout-module--titleLink--a4c58{font-size:var(--fontSize-2)}.layout-module--sidebar--65e08{position:static}.layout-module--sidebarSection--78de8{display:none}.layout-module--categoryScrollArea--495be{max-height:none;overflow:visible;overscroll-behavior:auto;padding-right:0}}._404-module--notFoundPage--973d2{display:grid;min-height:60vh;place-items:center}._404-module--heroCard--2c155{background:linear-gradient(180deg,#f8fbff,#fff);border:1px solid #dbe7fb;border-radius:20px;box-shadow:0 14px 36px rgba(37,99,235,.1);padding:clamp(1.5rem,4vw,2.5rem);text-align:center;width:min(100%,44rem)}._404-module--errorCode--27f6e{align-items:center;background:#dbeafe;border:1px solid #bfdbfe;border-radius:999px;color:#1d4ed8;display:inline-flex;font-size:var(--fontSize-1);font-weight:800;justify-content:center;letter-spacing:.08em;margin-bottom:var(--spacing-4);padding:.35rem .8rem}._404-module--title--65a8e{color:var(--color-heading-black);font-size:clamp(1.5rem,4vw,2.1rem);line-height:1.25;margin:0 0 var(--spacing-3)}._404-module--description--7019f{color:var(--color-text-light);line-height:1.65;margin:0 auto;max-width:36rem}._404-module--actions--cff5b{align-items:center;display:inline-flex;flex-wrap:wrap;gap:var(--spacing-3);justify-content:center;margin-top:var(--spacing-6)}._404-module--primaryButton--bb5a9,._404-module--secondaryButton--b3086{align-items:center;border-radius:999px;display:inline-flex;font-size:.86rem;font-weight:700;justify-content:center;min-width:8rem;padding:.62rem 1rem;text-decoration:none;transition:transform .16s ease,box-shadow .16s ease,background-color .16s ease,border-color .16s ease,color .16s ease}._404-module--primaryButton--bb5a9{background:#2563eb;border:1px solid #2563eb;box-shadow:0 8px 18px rgba(37,99,235,.24);color:#fff}._404-module--primaryButton--bb5a9:focus-visible,._404-module--primaryButton--bb5a9:hover{background:#1d4ed8;border-color:#1d4ed8;transform:translateY(-1px)}._404-module--secondaryButton--b3086{background:#eff6ff;border:1px solid #bfdbfe;color:#1d4ed8}._404-module--secondaryButton--b3086:focus-visible,._404-module--secondaryButton--b3086:hover{background:#dbeafe;border-color:#93c5fd;transform:translateY(-1px)}.index-module--latestPostsSection--79bc9{background:linear-gradient(180deg,#f8fbff,#fdfefe);border:1px solid #d6e3fa;border-radius:14px;box-shadow:0 10px 26px rgba(37,99,235,.08);margin-bottom:var(--spacing-8);padding:var(--spacing-5)}.index-module--latestPostsTitle--ca566{border-bottom:1px solid #d6e3fa;color:#1e3a8a;font-size:var(--fontSize-1);letter-spacing:.02em;margin:0 0 var(--spacing-4);padding-bottom:var(--spacing-2)}.index-module--latestPostsList--56efe{-webkit-overflow-scrolling:touch;display:flex;gap:var(--spacing-4);list-style:none;margin:0;overflow-x:auto;overscroll-behavior-x:contain;padding:0 0 .25rem;scroll-snap-type:x proximity}.index-module--latestPostsItem--8ad84{flex:0 0 15rem;min-width:15rem;scroll-snap-align:start}.index-module--latestPostsLink--f6ceb{--latest-card-border:#dbe7fb;background:#fff;border:1px solid var(--latest-card-border);border-radius:12px;color:#1f2937;display:flex;flex-direction:column;height:100%;overflow:hidden;text-decoration:none;transition:transform .18s ease,box-shadow .18s ease,border-color .18s ease}.index-module--latestPostThumbnailWrap--de293{aspect-ratio:16/9;background:#edf3ff;border-bottom:1px solid #d6e3fa;overflow:hidden;width:100%}.index-module--latestPostThumbnailImage--e17a1{display:block;height:100%;object-fit:cover;width:100%}.index-module--latestPostThumbnailFallback--ee473{background:linear-gradient(135deg,#eef4ff,#dbeafe);height:100%;width:100%}.index-module--latestPostContent--10204{padding:.75rem .85rem .9rem}.index-module--latestPostTitle--f798b{-webkit-line-clamp:2;-webkit-box-orient:vertical;color:#1f2937;display:-webkit-box;font-size:.88rem;line-height:1.35;margin:0;overflow:hidden}.index-module--latestPostsLink--f6ceb:focus-visible,.index-module--latestPostsLink--f6ceb:hover{border-color:#c8d9fb;box-shadow:0 10px 20px rgba(37,99,235,.08);transform:translateY(-2px)}.index-module--latestPostsLink--f6ceb:focus-visible .index-module--latestPostTitle--f798b,.index-module--latestPostsLink--f6ceb:hover .index-module--latestPostTitle--f798b{color:#1d4ed8}.index-module--latestPostsDate--6d630{color:#64748b;display:block;font-size:.75rem;margin-top:.35rem}.index-module--postsGrid--a20bc{display:grid;gap:var(--spacing-8);grid-template-columns:1fr;list-style:none;margin:0;padding:0}.index-module--postListItem--882a1{--card-blue:#2563eb;--card-blue-soft:#dbeafe;--card-border:#dbe7fb;background:var(--color-card-bg);border:1px solid var(--card-border);border-radius:10px;display:flex;flex-direction:column;height:100%;overflow:hidden;position:relative;transition:transform .18s ease,box-shadow .18s ease,border-color .18s ease}.index-module--postListItem--882a1:hover{border-color:#c8d9fb;box-shadow:0 10px 20px rgba(37,99,235,.08);transform:translateY(-2px)}.index-module--postListItem--882a1:before{background:var(--card-blue);bottom:0;content:"";left:0;position:absolute;top:0;width:3px}.index-module--postLink--fe43b{color:inherit;display:block;height:100%;padding:var(--spacing-5) var(--spacing-5) var(--spacing-5) calc(var(--spacing-5) + 4px);text-decoration:none}.index-module--postCardBody--40dc9{align-items:flex-start;display:flex;gap:var(--spacing-4)}.index-module--postThumbnailWrapper--d34a6{aspect-ratio:4/3;background:#edf3ff;border:1px solid #d6e3fa;border-radius:8px;min-width:12rem;overflow:hidden;width:12rem}.index-module--postThumbnailImage--488fd{display:block;height:100%;object-fit:cover;width:100%}.index-module--postCardContent--2b185{display:flex;flex:1 1;flex-direction:column;min-width:0}.index-module--postCardHeader--73db4{margin-bottom:var(--spacing-3)}.index-module--postMeta--53065{align-items:center;display:inline-flex;gap:.35rem}.index-module--readingTimeText--25c45{align-items:center;color:#1d4ed8;display:inline-flex;font-size:.76rem;font-weight:600;line-height:1}.index-module--readingTimeText--25c45:before{color:#94a3b8;content:"•";margin-right:.35rem}.index-module--postDate--22344{color:var(--color-text-light);display:inline-block;font-size:.78rem;margin-bottom:0}.index-module--postTitle--5f6ce{color:var(--color-heading-black);font-size:var(--fontSize-2);font-weight:700;letter-spacing:-.01em;line-height:1.35;margin:0}.index-module--postCardExcerpt--fc40a p{-webkit-line-clamp:2;-webkit-box-orient:vertical;color:var(--color-text-light);display:-webkit-box;font-size:.9rem;line-height:1.45;margin:0;overflow:hidden}.index-module--postListItem--882a1:hover .index-module--postTitle--5f6ce{color:var(--card-blue)}@media (max-width:42rem){.index-module--latestPostsSection--79bc9{margin-bottom:var(--spacing-6);padding:var(--spacing-4)}.index-module--latestPostsTitle--ca566{margin-bottom:var(--spacing-3)}.index-module--latestPostsList--56efe{gap:var(--spacing-3)}.index-module--latestPostsItem--8ad84{flex-basis:13.5rem;min-width:13.5rem}.index-module--postsGrid--a20bc{gap:var(--spacing-6)}.index-module--postLink--fe43b{padding:var(--spacing-4) var(--spacing-4) var(--spacing-4) calc(var(--spacing-4) + 4px)}.index-module--postCardBody--40dc9{flex-direction:column;gap:var(--spacing-3)}.index-module--postCardHeader--73db4{margin-bottom:var(--spacing-2)}.index-module--postThumbnailWrapper--d34a6{aspect-ratio:21/9;min-width:0;width:100%}}@media (min-width:768px){.index-module--postsGrid--a20bc{gap:var(--spacing-8);grid-template-columns:1fr}}@media (min-width:1400px){.index-module--postsGrid--a20bc{gap:var(--spacing-12);grid-template-columns:1fr}}.search-page-module--searchPage--b5a14{width:100%}.search-page-module--searchHeader--2b955{margin-bottom:var(--spacing-8)}.search-page-module--searchTitle--5e402{color:var(--color-heading-black);font-size:var(--fontSize-5);margin:0 0 var(--spacing-4);text-align:center;width:100%}.search-page-module--searchForm--65ecc{align-items:center;display:flex;gap:var(--spacing-3)}.search-page-module--searchInput--c6d92{background:#f8fbff;border:1px solid #bfd3f4;border-radius:999px;color:var(--color-heading);flex:1 1;font-size:1rem;min-width:0;outline:none;padding:.74rem 1.05rem;transition:border-color .2s ease,box-shadow .2s ease}.search-page-module--searchInput--c6d92:focus{border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,.15)}.search-page-module--searchButton--21bcd{background:#2563eb;border:1px solid #2563eb;border-radius:999px;color:#fff;cursor:pointer;font-size:.92rem;font-weight:700;padding:.74rem 1.05rem}.search-page-module--searchButton--21bcd:hover{background:#1d4ed8;border-color:#1d4ed8}.search-page-module--resultsHeader--a1410{align-items:center;display:flex;flex-wrap:wrap;gap:var(--spacing-3);justify-content:space-between;margin-bottom:var(--spacing-4)}.search-page-module--resultsTitle--7fb23{color:var(--color-heading);font-size:var(--fontSize-2);margin:0}.search-page-module--resultsTitle--7fb23 span{color:var(--color-text-light);font-weight:500}.search-page-module--sortWrap--bfb72{align-items:center;display:inline-flex;gap:.4rem}.search-page-module--sortWrap--bfb72 label{color:var(--color-text-light);font-size:.78rem}.search-page-module--sortSelect--c4f11{background:#fff;border:1px solid #bfd3f4;border-radius:8px;color:var(--color-heading);font-size:.78rem;padding:.35rem .5rem}.search-page-module--resultsList--68d78{display:grid;gap:var(--spacing-6);grid-template-columns:1fr}.search-page-module--resultCard--3e5b1{--card-blue:#2563eb;--card-border:#dbe7fb;background:var(--color-card-bg);border:1px solid var(--card-border);border-radius:10px;overflow:hidden;position:relative;transition:transform .18s ease,box-shadow .18s ease,border-color .18s ease}.search-page-module--resultCard--3e5b1:before{background:var(--card-blue);bottom:0;content:"";left:0;position:absolute;top:0;width:3px}.search-page-module--resultCard--3e5b1:hover{border-color:#c8d9fb;box-shadow:0 10px 20px rgba(37,99,235,.08);transform:translateY(-2px)}.search-page-module--resultLink--26e35{color:inherit;display:block;padding:var(--spacing-5) var(--spacing-5) var(--spacing-5) calc(var(--spacing-5) + 4px);text-decoration:none}.search-page-module--cardBody--7455f{align-items:flex-start;display:flex;gap:var(--spacing-4)}.search-page-module--thumbnailWrap--809a7{aspect-ratio:4/3;background:#edf3ff;border:1px solid #d6e3fa;border-radius:8px;min-width:12rem;overflow:hidden;width:12rem}.search-page-module--thumbnailImage--eb467{display:block;height:100%;object-fit:cover;width:100%}.search-page-module--cardContent--25e7a{flex:1 1;min-width:0}.search-page-module--cardTitle--bed52{color:var(--color-heading-black);font-size:var(--fontSize-2);font-weight:700;letter-spacing:-.01em;line-height:1.35;margin:0}.search-page-module--cardMeta--21132{align-items:center;display:inline-flex;gap:.35rem;margin-top:.25rem}.search-page-module--cardDate--1c374{color:var(--color-text-light);font-size:.78rem}.search-page-module--readingTime--47b82{align-items:center;color:#1d4ed8;display:inline-flex;font-size:.76rem;font-weight:600}.search-page-module--readingTime--47b82:before{color:#94a3b8;content:"•";margin-right:.35rem}.search-page-module--cardDescription--f2906{-webkit-line-clamp:2;-webkit-box-orient:vertical;color:var(--color-text-light);display:-webkit-box;font-size:.9rem;line-height:1.45;margin:var(--spacing-2) 0 0;overflow:hidden}.search-page-module--cardDescription--f2906 mark,.search-page-module--cardTitle--bed52 mark{background:#dbeafe;border-radius:4px;color:#1e3a8a;padding:0 .1em}.search-page-module--resultCard--3e5b1:hover .search-page-module--cardTitle--bed52{color:#2563eb}.search-page-module--emptyState--37d88,.search-page-module--placeholderState--68e8a{background:#f8fbff;border:1px solid #dbe7fb;border-radius:12px;padding:var(--spacing-6)}.search-page-module--emptyState--37d88 h3,.search-page-module--placeholderState--68e8a h3{font-size:var(--fontSize-3);margin:0 0 var(--spacing-2)}.search-page-module--emptyState--37d88 p,.search-page-module--placeholderState--68e8a p{color:var(--color-text-light);margin:0}.search-page-module--emptyState--37d88 ul{color:var(--color-text-light);margin:var(--spacing-3) 0 0;padding-left:1.1rem}.search-page-module--emptyState--37d88 li+li{margin-top:.2rem}@media (max-width:42rem){.search-page-module--searchForm--65ecc{align-items:stretch;flex-direction:column}.search-page-module--searchButton--21bcd{width:100%}.search-page-module--resultLink--26e35{padding:var(--spacing-4) var(--spacing-4) var(--spacing-4) calc(var(--spacing-4) + 4px)}.search-page-module--cardBody--7455f{flex-direction:column;gap:var(--spacing-3)}.search-page-module--thumbnailWrap--809a7{aspect-ratio:21/9;min-width:0;width:100%}}.toc-module--tocContainer--ffa0b{background:#fff;border:1px solid #dbe7fb;border-radius:16px;box-shadow:0 10px 28px rgba(37,99,235,.08);height:-webkit-fit-content;height:fit-content;margin:var(--spacing-6) 0;max-height:none;max-width:none;overflow-y:visible;padding:.95rem .9rem 1rem;position:static;width:100%;z-index:100}.toc-module--mobileCloseButton--e0810,.toc-module--mobileTocBackdrop--a19ba,.toc-module--mobileTocButton--56883{display:none}@media (min-width:1280px){.toc-module--tocContainer--ffa0b{margin:0;max-height:min(78vh,48rem);overflow-y:auto;overscroll-behavior:contain;position:fixed;right:1.5rem;top:50%;transform:translateY(-50%);width:17.5rem}}@media (min-width:900px) and (max-width:1279px){.toc-module--tocContainer--ffa0b{align-self:start;margin:0;max-height:calc(100vh - 2rem);overflow-y:auto;overscroll-behavior:contain;position:-webkit-sticky;position:sticky;top:1rem}}@media (min-width:1600px){.toc-module--tocContainer--ffa0b{right:2rem;width:19rem}}@media (min-width:2200px){.toc-module--tocContainer--ffa0b{margin:0;max-height:calc(100vh - 2.5rem);position:-webkit-sticky;position:sticky;right:auto;top:1.25rem;transform:none;width:20rem}}@media (max-width:768px){.toc-module--tocContainer--ffa0b{margin:var(--spacing-4) 0;padding:.9rem .8rem .85rem}}@media (max-width:42rem){.toc-module--mobileTocButton--56883{align-items:center;background:#2563eb;border:1px solid #2563eb;border-radius:999px;bottom:1.25rem;box-shadow:0 10px 24px rgba(37,99,235,.28);color:#fff;display:inline-flex;font-size:.78rem;font-weight:700;height:2.5rem;justify-content:center;min-width:3.25rem;padding:0 .85rem;position:fixed;right:1rem;z-index:130}.toc-module--mobileTocBackdrop--a19ba{background:rgba(15,23,42,.46);border:0;display:block;inset:0;opacity:0;pointer-events:none;position:fixed;transition:opacity .2s ease;z-index:120}.toc-module--mobileVisible--a82c0{opacity:1;pointer-events:auto}.toc-module--tocContainer--ffa0b{border-radius:16px;bottom:.75rem;box-shadow:0 20px 42px rgba(15,23,42,.24);left:.75rem;margin:0;max-height:min(70vh,32rem);opacity:0;overflow-y:auto;padding:1rem .85rem .95rem;pointer-events:none;position:fixed;right:.75rem;top:auto;transform:translateY(112%);transition:transform .24s ease,opacity .24s ease;width:auto;z-index:125}.toc-module--mobileOpen--ceec0{opacity:1;pointer-events:auto;transform:translateY(0)}.toc-module--mobileCloseButton--e0810{align-items:center;background:#eff6ff;border:1px solid #bfdbfe;border-radius:999px;color:#1d4ed8;cursor:pointer;display:inline-flex;font-size:.72rem;font-weight:700;justify-content:center;line-height:1;padding:.32rem .58rem}}.toc-module--tocHeader--b1f84{align-items:center;display:flex;gap:.5rem;justify-content:space-between}.toc-module--tocTitle--0befc{color:#1e3a8a;font-size:1.05rem;font-weight:700;letter-spacing:.01em;margin:0}.toc-module--tocProgress--b5e48{background:#dbeafe;border-radius:999px;height:3px;margin-top:.65rem;overflow:hidden;position:relative}.toc-module--tocProgressFill--48e0b{background:linear-gradient(90deg,#2563eb,#3b82f6);border-radius:inherit;display:block;height:100%;transition:width .2s ease-out;width:0}.toc-module--tocContent--d6318{font-size:.85rem;line-height:1.45;margin-top:.6rem}.toc-module--tocContent--d6318 ul{list-style:none;margin:0;padding-left:0}.toc-module--tocContent--d6318>ul{margin:0}.toc-module--tocContent--d6318 li{margin:.14rem 0}.toc-module--tocContent--d6318>ul>li{margin:.16rem 0}.toc-module--tocContent--d6318 li a{border:1px solid transparent;border-radius:9px;color:#475569;display:block;font-size:.845rem;line-height:1.28;padding:.3rem .48rem;text-decoration:none;transition:background-color .18s ease,color .18s ease,border-color .18s ease}.toc-module--tocContent--d6318 li>a{margin-bottom:.02rem}.toc-module--tocContent--d6318 li a:hover{background:#eff6ff;border-color:#bfdbfe;color:#1d4ed8}.toc-module--active--399c5{background:#dbeafe!important;border-color:#93c5fd!important;box-shadow:inset 2px 0 0 #2563eb;color:#1e40af!important;font-weight:700}.toc-module--tocContent--d6318 ul ul{border-left:1px solid #dbeafe;margin-left:.45rem;margin-top:.02rem;padding-left:.55rem}.toc-module--tocContent--d6318 li>a+ul{margin-top:0}.toc-module--tocContent--d6318 ul ul li{margin:.08rem 0}.toc-module--tocContent--d6318 ul ul li a{color:#64748b;font-size:.8rem}.toc-module--tocContainer--ffa0b::-webkit-scrollbar{width:6px}.toc-module--tocContainer--ffa0b::-webkit-scrollbar-thumb{background:#bfdbfe;border-radius:999px}.toc-module--tocContainer--ffa0b::-webkit-scrollbar-track{background:transparent}.blog-post-module--scrollProgress--ba33a{background:linear-gradient(90deg,#2563eb,#3b82f6);height:3px;left:0;position:fixed;top:0;transition:width .25s ease-out;width:0;z-index:1000}.blog-post-module--blogPostLayout--47121{margin:0 auto;max-width:100%;position:relative;width:100%}.blog-post-module--blogPostContainer--50728{margin:0 auto;max-width:1100px;width:100%}.blog-post-module--blogPost--72ffc{background:var(--color-card-bg);border:1px solid var(--color-border);border-radius:20px;box-shadow:0 10px 30px rgba(15,23,42,.05);padding:clamp(1.25rem,3vw,2.5rem);width:100%}.blog-post-module--blogPostHeader--0de78{align-items:center;border-bottom:1px solid var(--color-border);display:flex;flex-direction:column;margin-bottom:var(--spacing-10);padding-bottom:var(--spacing-6);text-align:center}.blog-post-module--postTitle--2c12c{color:var(--color-heading-black);font-size:clamp(1.9rem,4vw,2.6rem);letter-spacing:-.03em;line-height:1.2;margin:0 0 .8rem}.blog-post-module--postDate--2d1aa{align-items:center;background:var(--color-bg-secondary);border:1px solid var(--color-border);border-radius:999px;color:var(--color-text-light);display:inline-flex;font-size:.84rem;font-weight:600;line-height:1;margin:0 0 .65rem;padding:.4rem .75rem}.blog-post-module--shareButton--0c58e{align-items:center;background:#eff6ff;border:1px solid #bfdbfe;border-radius:999px;color:#1d4ed8;cursor:pointer;display:inline-flex;height:2.1rem;justify-content:center;padding:0;transition:background-color .2s ease,border-color .2s ease,transform .2s ease;width:2.1rem}.blog-post-module--shareButton--0c58e:focus-visible,.blog-post-module--shareButton--0c58e:hover{background:#dbeafe;border-color:#93c5fd;transform:translateY(-1px)}.blog-post-module--shareIcon--a967e{height:1.1rem;width:1.1rem}.blog-post-module--metaRow--1f5ff{align-items:center;display:flex;justify-content:center;margin-top:.35rem;min-height:2.1rem;position:relative;width:100%}.blog-post-module--metaRow--1f5ff .blog-post-module--shareButton--0c58e{position:absolute;right:0;top:50%;transform:translateY(-50%)}.blog-post-module--metaRow--1f5ff .blog-post-module--shareButton--0c58e:focus-visible,.blog-post-module--metaRow--1f5ff .blog-post-module--shareButton--0c58e:hover{transform:translateY(-50%)}.blog-post-module--toast--c08b7{background:rgba(15,23,42,.92);border-radius:10px;bottom:1.4rem;color:#fff;font-size:.84rem;left:50%;line-height:1;opacity:0;padding:.62rem .92rem;pointer-events:none;position:fixed;transform:translateX(-50%) translateY(12px);transition:opacity .2s ease,transform .2s ease;z-index:1200}.blog-post-module--toastVisible--a9577{opacity:1;transform:translateX(-50%) translateY(0)}.blog-post-module--tagsContainer--c8b91{display:flex;flex-wrap:wrap;gap:.45rem;justify-content:flex-start;margin:0}.blog-post-module--tag--a09fc{align-items:center;background:#eff6ff;border:1px solid #bfdbfe;border-radius:999px;color:#1d4ed8;display:inline-flex;font-size:.78rem;font-weight:600;line-height:1;margin:0;padding:.38rem .72rem;transition:border-color .2s ease,background-color .2s ease,color .2s ease}.blog-post-module--tag--a09fc:hover{background:#dbeafe;border-color:#93c5fd;color:#1d4ed8;cursor:default}.blog-post-module--blogPostContent--a2bdd{color:var(--color-text);font-size:1.06rem;line-height:1.85}.blog-post-module--blogPostContent--a2bdd>*{margin-bottom:1.4rem}.blog-post-module--blogPostContent--a2bdd>:last-child{margin-bottom:0}.blog-post-module--blogPostContent--a2bdd p{margin-bottom:1.35rem}.blog-post-module--blogPostContent--a2bdd h2,.blog-post-module--blogPostContent--a2bdd h3,.blog-post-module--blogPostContent--a2bdd h4{margin-bottom:.95rem;margin-top:2.4rem;scroll-margin-top:5rem}.blog-post-module--blogPostContent--a2bdd h2{border-bottom:1px solid var(--color-border);font-size:clamp(1.45rem,3vw,1.9rem);padding-bottom:.35rem}.blog-post-module--blogPostContent--a2bdd h3{font-size:clamp(1.2rem,2.2vw,1.45rem)}.blog-post-module--blogPostContent--a2bdd h4{font-size:1.1rem}.blog-post-module--blogPostContent--a2bdd ol,.blog-post-module--blogPostContent--a2bdd ul{margin:0 0 1.4rem;padding-left:1.35rem}.blog-post-module--blogPostContent--a2bdd li{margin-bottom:.5rem}.blog-post-module--blogPostContent--a2bdd li:last-child{margin-bottom:0}.blog-post-module--blogPostContent--a2bdd blockquote{background:#eff6ff;border-left:4px solid #2563eb;border-radius:0 12px 12px 0;color:var(--color-text-light);font-size:1rem;font-style:normal;margin:1.9rem 0;padding:.95rem 1.1rem}.blog-post-module--blogPostContent--a2bdd blockquote p:last-child{margin-bottom:0}.blog-post-module--blogPostContent--a2bdd strong{background:linear-gradient(0deg,#fff176 40%,transparent 0);padding:0 2px}.blog-post-module--blogPostContent--a2bdd code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:.9em}.blog-post-module--blogPostContent--a2bdd :not(pre)>code{background:var(--color-bg-secondary);border-radius:.42rem;color:#be185d;padding:.12rem .4rem}.blog-post-module--blogPostContent--a2bdd .gatsby-highlight,.blog-post-module--blogPostContent--a2bdd pre{border-radius:14px;margin:1.7rem 0}.blog-post-module--blogPostContent--a2bdd pre{border:1px solid var(--color-border)}.blog-post-module--blogPostContent--a2bdd table{border:1px solid var(--color-border);border-radius:10px;margin:1.7rem 0;overflow:hidden}.blog-post-module--blogPostContent--a2bdd td,.blog-post-module--blogPostContent--a2bdd th{border-bottom:1px solid var(--color-border);padding:.7rem .8rem;text-align:left}.blog-post-module--blogPostContent--a2bdd tr:last-child td{border-bottom:0}.blog-post-module--blogPostContent--a2bdd img{border:1px solid var(--color-border);border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.05);display:block;height:auto;margin:1.7rem auto;max-width:100%}.blog-post-module--postDivider--aa8ca{margin:2.2rem 0 1.4rem}.blog-post-module--blogPostNav--d05de{background:var(--color-card-bg);border:1px solid var(--color-border);border-radius:16px;margin-top:var(--spacing-16);padding:var(--spacing-8)}.blog-post-module--blogPostNav--d05de ul{display:flex;flex-wrap:wrap;gap:var(--spacing-6);justify-content:space-between;list-style:none;margin:0;padding:0}.blog-post-module--blogPostNav--d05de li{flex:1 1;min-width:0}.blog-post-module--blogPostNav--d05de a{background:var(--color-bg);border:2px solid var(--color-border);border-radius:12px;color:var(--color-text);display:block;font-size:.84rem;line-height:1.35;overflow:hidden;padding:var(--spacing-4) var(--spacing-6);position:relative;text-decoration:none;transition:all .3s ease}.blog-post-module--blogPostNav--d05de a:hover{border-color:#2563eb;box-shadow:0 6px 20px rgba(37,99,235,.15);transform:translateY(-2px)}.blog-post-module--blogPostNav--d05de a:before{color:var(--color-text-light);content:attr(rel);display:block;font-size:var(--fontSize-0);letter-spacing:.5px;margin-bottom:var(--spacing-1);text-transform:uppercase}@media (min-width:1280px){.blog-post-module--blogPostLayout--47121{display:block;max-width:100%}.blog-post-module--blogPostContainer--50728{margin:0 auto;max-width:min(76rem,100%);width:100%}}@media (min-width:900px) and (max-width:1279px){.blog-post-module--blogPostLayout--47121{align-items:start;column-gap:var(--spacing-6);display:grid;grid-template-columns:minmax(0,1fr) 16rem}.blog-post-module--blogPostContainer--50728{margin:0;max-width:none}}@media (min-width:1600px){.blog-post-module--blogPostContainer--50728{max-width:min(82rem,100%)}}@media (min-width:2200px){.blog-post-module--blogPostLayout--47121{align-items:flex-start;column-gap:1.25rem;display:grid;grid-template-columns:minmax(0,1fr) 20rem}.blog-post-module--blogPostContainer--50728{margin:0;max-width:100%}}@media (max-width:42rem){.blog-post-module--blogPostNav--d05de{padding:var(--spacing-6)}.blog-post-module--blogPostNav--d05de ul{flex-direction:column;gap:var(--spacing-4)}.blog-post-module--blogPostNav--d05de a{padding:var(--spacing-4);text-align:center}}@media (max-width:768px){.blog-post-module--blogPost--72ffc{border-radius:14px;padding:1rem}.blog-post-module--blogPostHeader--0de78{margin-bottom:var(--spacing-8)}.blog-post-module--blogPostContent--a2bdd{font-size:1rem;line-height:1.78}.blog-post-module--blogPostContent--a2bdd h2,.blog-post-module--blogPostContent--a2bdd h3,.blog-post-module--blogPostContent--a2bdd h4{margin-top:2rem}.blog-post-module--shareButton--0c58e{height:2rem;width:2rem}.blog-post-module--metaRow--1f5ff{justify-content:center;min-height:0}.blog-post-module--tagsContainer--c8b91{justify-content:center}.blog-post-module--metaRow--1f5ff .blog-post-module--shareButton--0c58e{margin-top:.4rem;position:static;transform:none}.blog-post-module--metaRow--1f5ff .blog-post-module--shareButton--0c58e:focus-visible,.blog-post-module--metaRow--1f5ff .blog-post-module--shareButton--0c58e:hover{transform:none}.blog-post-module--toast--c08b7{bottom:1rem;font-size:.8rem}}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .anchor-header.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor-header.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor-header svg,
    h2 .anchor-header svg,
    h3 .anchor-header svg,
    h4 .anchor-header svg,
    h5 .anchor-header svg,
    h6 .anchor-header svg {
      visibility: hidden;
    }
    h1:hover .anchor-header svg,
    h2:hover .anchor-header svg,
    h3:hover .anchor-header svg,
    h4:hover .anchor-header svg,
    h5:hover .anchor-header svg,
    h6:hover .anchor-header svg,
    h1 .anchor-header:focus svg,
    h2 .anchor-header:focus svg,
    h3 .anchor-header:focus svg,
    h4 .anchor-header:focus svg,
    h5 .anchor-header:focus svg,
    h6 .anchor-header:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 100)
          }), 0)
        }
      }
    })
  </script><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=8023343bd3d2fc1124b2397f8fb68057" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=8023343bd3d2fc1124b2397f8fb68057"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=8023343bd3d2fc1124b2397f8fb68057"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=8023343bd3d2fc1124b2397f8fb68057"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=8023343bd3d2fc1124b2397f8fb68057"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=8023343bd3d2fc1124b2397f8fb68057"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=8023343bd3d2fc1124b2397f8fb68057"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=8023343bd3d2fc1124b2397f8fb68057"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=8023343bd3d2fc1124b2397f8fb68057"/><title data-gatsby-head="true">JPA 기본기 | 김동호 블로그</title><link rel="canonical" href="https://kdkdhoho.github.io/posts/jpa/" data-gatsby-head="true"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper layout-module--postWrapper--01261" data-is-root-path="false"><header class="layout-module--globalHeader--d828d layout-module--postGlobalHeader--933d9"><div class="layout-module--headerContainer--c48da layout-module--postHeaderContainer--cfcda"><div class="layout-module--headerSide--63b5d" aria-hidden="true"></div><div class="layout-module--headerCenter--747d9"><a class="layout-module--titleLink--a4c58" href="/">김동호 블로그</a></div><div class="layout-module--headerRight--d5448"><div class="search-module--searchContainer--8062c"><div class="search-module--inlineSearchField--2c564"><span class="search-module--searchIcon--8a607" aria-hidden="true"><svg viewBox="0 0 24 24" focusable="false"><path d="M11 4a7 7 0 1 1 0 14 7 7 0 0 1 0-14zm0 2a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm6.7 11.3 3 3-1.4 1.4-3-3 1.4-1.4z"></path></svg></span><input type="text" placeholder="검색 (2글자 이상)" class="search-module--inlineSearchInput--04259" aria-label="포스트 검색" value=""/></div></div></div></div></header><div class="layout-module--layoutContainer--2ee2a layout-module--postLayoutContainer--36d0e"><aside class="layout-module--sidebar--65e08 layout-module--postSidebar--e569d"><section class="bio-module--bioCard--3293a bio-module--compactBio--f9b9a"><div data-gatsby-image-wrapper="" style="width:40px;height:40px" class="gatsby-image-wrapper bio-module--avatar--e54eb"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#989898;width:40px;height:40px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/8023343bd3d2fc1124b2397f8fb68057/0c7f7/profile_img.avif 40w,/static/8023343bd3d2fc1124b2397f8fb68057/457e4/profile_img.avif 80w" sizes="40px"/><source type="image/webp" data-srcset="/static/8023343bd3d2fc1124b2397f8fb68057/3a6ff/profile_img.webp 40w,/static/8023343bd3d2fc1124b2397f8fb68057/1deab/profile_img.webp 80w" sizes="40px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="40px" decoding="async" loading="lazy" data-src="/static/8023343bd3d2fc1124b2397f8fb68057/996dd/profile_img.png" data-srcset="/static/8023343bd3d2fc1124b2397f8fb68057/996dd/profile_img.png 40w,/static/8023343bd3d2fc1124b2397f8fb68057/4ed6d/profile_img.png 80w" alt="김동호 프로필 이미지"/></picture><noscript><picture><source type="image/avif" srcSet="/static/8023343bd3d2fc1124b2397f8fb68057/0c7f7/profile_img.avif 40w,/static/8023343bd3d2fc1124b2397f8fb68057/457e4/profile_img.avif 80w" sizes="40px"/><source type="image/webp" srcSet="/static/8023343bd3d2fc1124b2397f8fb68057/3a6ff/profile_img.webp 40w,/static/8023343bd3d2fc1124b2397f8fb68057/1deab/profile_img.webp 80w" sizes="40px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="40px" decoding="async" loading="lazy" src="/static/8023343bd3d2fc1124b2397f8fb68057/996dd/profile_img.png" srcSet="/static/8023343bd3d2fc1124b2397f8fb68057/996dd/profile_img.png 40w,/static/8023343bd3d2fc1124b2397f8fb68057/4ed6d/profile_img.png 80w" alt="김동호 프로필 이미지"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div class="bio-module--compactContent--73a50"><div class="bio-module--compactText--c1ec9"><p class="bio-module--name--b0be6">김동호</p><p class="bio-module--compactDescription--a8df7">유기견 문제를 해결하고 싶은   개발자</p></div><div class="bio-module--tags--abab9"><a href="https://github.com/kdkdhoho" target="_blank" rel="noopener noreferrer" class="bio-module--tagLink--18022" aria-label="GitHub 프로필 바로가기"><svg class="bio-module--tagIcon--f5e11" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2C6.48 2 2 6.58 2 12.23c0 4.51 2.87 8.34 6.84 9.69.5.09.68-.22.68-.49 0-.24-.01-.88-.01-1.72-2.78.62-3.37-1.37-3.37-1.37-.45-1.18-1.1-1.5-1.1-1.5-.9-.63.07-.61.07-.61 1 .08 1.52 1.05 1.52 1.05.88 1.55 2.3 1.1 2.87.84.09-.66.35-1.1.63-1.36-2.22-.26-4.56-1.14-4.56-5.05 0-1.12.39-2.04 1.03-2.76-.1-.26-.45-1.31.1-2.73 0 0 .84-.28 2.75 1.05A9.33 9.33 0 0 1 12 6.9c.85 0 1.7.12 2.5.35 1.9-1.33 2.74-1.05 2.74-1.05.56 1.42.21 2.47.11 2.73.64.72 1.02 1.64 1.02 2.76 0 3.92-2.34 4.79-4.58 5.04.36.32.68.95.68 1.92 0 1.39-.01 2.5-.01 2.84 0 .27.18.59.69.49A10.24 10.24 0 0 0 22 12.23C22 6.58 17.52 2 12 2z"></path></svg></a><a href="mailto:hkim4410@gmail.com" class="bio-module--tagLink--18022" aria-label="Email 보내기"><svg class="bio-module--tagIcon--f5e11" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M20 6H4c-1.1 0-2 .9-2 2v8.5A2.5 2.5 0 0 0 4.5 19h15a2.5 2.5 0 0 0 2.5-2.5V8c0-1.1-.9-2-2-2zm0 2-8 5-8-5h16zm-.5 9h-15a.5.5 0 0 1-.5-.5V9.3l7.47 4.66a1 1 0 0 0 1.06 0L20 9.3v7.2a.5.5 0 0 1-.5.5z"></path></svg></a><a href="https://www.instagram.com/kdkdhoho/" target="_blank" rel="noopener noreferrer" class="bio-module--tagLink--18022" aria-label="Instagram 프로필 바로가기"><svg class="bio-module--tagIcon--f5e11" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 2A3.75 3.75 0 0 0 4 7.75v8.5A3.75 3.75 0 0 0 7.75 20h8.5A3.75 3.75 0 0 0 20 16.25v-8.5A3.75 3.75 0 0 0 16.25 4h-8.5zM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6zm5.25-3a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5z"></path></svg></a></div></div></section><div class="layout-module--sidebarSection--78de8"><h3 class="layout-module--sidebarTitle--1b0b5">Latest Posts</h3><ul class="layout-module--latestPostList--5cbe9"><li class="layout-module--latestPostListItem--7ce3b"><a class="layout-module--latestPostLink--c63ff" href="/posts/remember-to-use-group-by/">[SQL] GROUP BY 사용할 때 명심할 점</a><time class="layout-module--latestPostDate--bc893">2026.02.26</time></li><li class="layout-module--latestPostListItem--7ce3b"><a class="layout-module--latestPostLink--c63ff" href="/posts/sql-union-and-union-all/">[SQL] UNION과 UNION ALL 정리</a><time class="layout-module--latestPostDate--bc893">2026.02.26</time></li><li class="layout-module--latestPostListItem--7ce3b"><a class="layout-module--latestPostLink--c63ff" href="/posts/python-syntax/">Python Syntax, 각종 라이브러리</a><time class="layout-module--latestPostDate--bc893">2026.02.25</time></li><li class="layout-module--latestPostListItem--7ce3b"><a class="layout-module--latestPostLink--c63ff" href="/posts/what-is-computer-network/">컴퓨터 네트워크 개요</a><time class="layout-module--latestPostDate--bc893">2026.02.25</time></li><li class="layout-module--latestPostListItem--7ce3b"><a class="layout-module--latestPostLink--c63ff" href="/posts/manacher-algorithm/">Manacher 알고리즘</a><time class="layout-module--latestPostDate--bc893">2026.02.16</time></li></ul></div><div class="layout-module--sidebarSection--78de8"><h3 class="layout-module--sidebarTitle--1b0b5">카테고리</h3><div class="layout-module--categoryScrollArea--495be"><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 layout-module--activeCategory--8af0e" style="--depth:0" href="/"><span class="layout-module--categoryName--a37ca">All</span><span class="layout-module--categoryCount--f72a4">132</span></a></li></ul><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=AI"><span class="layout-module--categoryName--a37ca">AI</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Cloud"><span class="layout-module--categoryName--a37ca">Cloud</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Dart%2C%20Flutter"><span class="layout-module--categoryName--a37ca">Dart, Flutter</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Docker"><span class="layout-module--categoryName--a37ca">Docker</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Git%2C%20Github"><span class="layout-module--categoryName--a37ca">Git, Github</span><span class="layout-module--categoryCount--f72a4">3</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=InfraStructure"><span class="layout-module--categoryName--a37ca">InfraStructure</span><span class="layout-module--categoryCount--f72a4">9</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Java"><span class="layout-module--categoryName--a37ca">Java</span><span class="layout-module--categoryCount--f72a4">17</span></a><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=Java%2FGarbage%20Collection"><span class="layout-module--categoryName--a37ca">Garbage Collection</span><span class="layout-module--categoryCount--f72a4">3</span></a></li></ul></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=JPA"><span class="layout-module--categoryName--a37ca">JPA</span><span class="layout-module--categoryCount--f72a4">2</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Kotlin"><span class="layout-module--categoryName--a37ca">Kotlin</span><span class="layout-module--categoryCount--f72a4">2</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Linux"><span class="layout-module--categoryName--a37ca">Linux</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=OOP"><span class="layout-module--categoryName--a37ca">OOP</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Python"><span class="layout-module--categoryName--a37ca">Python</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=React.js"><span class="layout-module--categoryName--a37ca">React.js</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Software%20Architecture"><span class="layout-module--categoryName--a37ca">Software Architecture</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=Spring%2C%20Spring%20Boot"><span class="layout-module--categoryName--a37ca">Spring, Spring Boot</span><span class="layout-module--categoryCount--f72a4">5</span></a><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=Spring%2C%20Spring%20Boot%2Fspring-core"><span class="layout-module--categoryName--a37ca">spring core</span><span class="layout-module--categoryCount--f72a4">2</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=Spring%2C%20Spring%20Boot%2Fspring-mvc"><span class="layout-module--categoryName--a37ca">spring mvc</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=Spring%2C%20Spring%20Boot%2Ftest"><span class="layout-module--categoryName--a37ca">test</span><span class="layout-module--categoryCount--f72a4">1</span></a></li></ul></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EA%B0%9C%EB%B0%9C%20%EB%8F%84%EA%B5%AC"><span class="layout-module--categoryName--a37ca">개발 도구</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC"><span class="layout-module--categoryName--a37ca">네트워크</span><span class="layout-module--categoryCount--f72a4">13</span></a><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%2FHTTP-%EC%B1%85-%EC%8A%A4%ED%84%B0%EB%94%94"><span class="layout-module--categoryName--a37ca">HTTP 책 스터디</span><span class="layout-module--categoryCount--f72a4">10</span></a></li></ul></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4"><span class="layout-module--categoryName--a37ca">데이터베이스</span><span class="layout-module--categoryCount--f72a4">18</span></a><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%2Finterview-study"><span class="layout-module--categoryName--a37ca">interview study</span><span class="layout-module--categoryCount--f72a4">2</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%2Freal-mysql-book-study"><span class="layout-module--categoryName--a37ca">real mysql book study</span><span class="layout-module--categoryCount--f72a4">9</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%2FSQL"><span class="layout-module--categoryName--a37ca">SQL</span><span class="layout-module--categoryCount--f72a4">2</span></a></li></ul></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EB%8F%85%EC%84%9C%20%EA%B8%B0%EB%A1%9D"><span class="layout-module--categoryName--a37ca">독서 기록</span><span class="layout-module--categoryCount--f72a4">3</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EB%A6%AC%EC%8A%A4%ED%8B%B0%EC%9B%A8%EC%9D%B4%EB%B8%8C%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8"><span class="layout-module--categoryName--a37ca">리스티웨이브 프로젝트</span><span class="layout-module--categoryCount--f72a4">2</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EC%83%9D%EA%B0%81%20%EA%B8%B0%EB%A1%9D"><span class="layout-module--categoryName--a37ca">생각 기록</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EC%85%80%EB%9F%BD%EC%9E%87%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8"><span class="layout-module--categoryName--a37ca">셀럽잇 프로젝트</span><span class="layout-module--categoryCount--f72a4">4</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%20%ED%85%8C%EC%8A%A4%ED%8A%B8"><span class="layout-module--categoryName--a37ca">소프트웨어 테스트</span><span class="layout-module--categoryCount--f72a4">5</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EC%98%81%EC%96%B4"><span class="layout-module--categoryName--a37ca">영어</span><span class="layout-module--categoryCount--f72a4">5</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C"><span class="layout-module--categoryName--a37ca">운영체제</span><span class="layout-module--categoryCount--f72a4">5</span></a><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%2F%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EC%9D%B8%ED%84%B0%EB%B7%B0-%EC%8A%A4%ED%84%B0%EB%94%94"><span class="layout-module--categoryName--a37ca">운영체제 인터뷰 스터디</span><span class="layout-module--categoryCount--f72a4">5</span></a></li></ul></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EC%9D%B4%EB%A0%A5%EC%84%9C%2C%20%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A4"><span class="layout-module--categoryName--a37ca">이력서, 포트폴리오</span><span class="layout-module--categoryCount--f72a4">1</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0%2C%20%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98"><span class="layout-module--categoryName--a37ca">자료구조, 알고리즘</span><span class="layout-module--categoryCount--f72a4">15</span></a><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0%2C%20%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%2FLeetCode"><span class="layout-module--categoryName--a37ca">LeetCode</span><span class="layout-module--categoryCount--f72a4">2</span></a></li></ul></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:0" href="/?category=%ED%9A%8C%EA%B3%A0"><span class="layout-module--categoryName--a37ca">회고</span><span class="layout-module--categoryCount--f72a4">12</span></a><ul class="layout-module--sidebarCategoryList--f27f3"><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%ED%9A%8C%EA%B3%A0%2F%EB%A6%AC%EC%8A%A4%ED%8B%B0%EC%9B%A8%EC%9D%B4%EB%B8%8C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%9A%8C%EA%B3%A0%EB%A1%9D"><span class="layout-module--categoryName--a37ca">리스티웨이브 프로젝트 회고록</span><span class="layout-module--categoryCount--f72a4">2</span></a></li><li class="layout-module--sidebarCategoryListItem--07ff4"><a class="layout-module--sidebarCategoryItem--b3e02 " style="--depth:1" href="/?category=%ED%9A%8C%EA%B3%A0%2F%ED%9A%8C%EA%B3%A0%EB%A1%9D"><span class="layout-module--categoryName--a37ca">회고록</span><span class="layout-module--categoryCount--f72a4">7</span></a></li></ul></li></ul></div></div></aside><main class="layout-module--mainContent--2f1b6 layout-module--postMainContent--3004a"><div class="blog-post-module--scrollProgress--ba33a" style="width:0%" aria-hidden="true"></div><div class="blog-post-module--blogPostLayout--47121"><div class="blog-post-module--blogPostContainer--50728"><article class="blog-post-module--blogPost--72ffc" itemscope="" itemType="http://schema.org/Article"><header class="blog-post-module--blogPostHeader--0de78"><h1 class="blog-post-module--postTitle--2c12c">JPA 기본기</h1><time class="blog-post-module--postDate--2d1aa">2026년 2월 12일</time><div class="blog-post-module--metaRow--1f5ff"><div class="blog-post-module--tagsContainer--c8b91"><span class="blog-post-module--tag--a09fc">#<!-- -->JPA</span><span class="blog-post-module--tag--a09fc">#<!-- -->Hibernate</span><span class="blog-post-module--tag--a09fc">#<!-- -->JPA 기본</span></div><button type="button" class="blog-post-module--shareButton--0c58e" aria-label="링크 공유" title="링크 공유"><svg viewBox="0 0 24 24" class="blog-post-module--shareIcon--a967e" aria-hidden="true" focusable="false"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a2.9 2.9 0 0 0 0-1.39l7.05-4.11A2.99 2.99 0 1 0 15 5a3 3 0 0 0 .05.52L8 9.63a3 3 0 1 0 0 4.74l7.05 4.11c-.03.17-.05.34-.05.52a3 3 0 1 0 3-2.92Z" fill="currentColor"></path></svg></button></div></header><section class="blog-post-module--blogPostContent--a2bdd blog-post-content" itemProp="articleBody"><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a class="gatsby-resp-image-link"
    href="/static/065347829ad8e5381a4b6c153aa843a2/c2d9c/thumbnail.png"
    style="display: block"
    target="_blank"
    rel="noopener noreferrer"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 55.06329113924051%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUElEQVR42nWST2saQRjG9zOIt3wCUcg1CbkJXg1eAhJvfgCFHuJFAoJFhOBNPAhN06JVqzVSNUVNdtVaNWpJDK4h/qnGpNmmpMZSxX9P17FapXRgeHZmdn68z/MOhYUxGo2IulwuMAyDarUKnU4HjUYDk8kEjuPIeTweh9lsxmAwIOvxeDxnUIvA4XBIVC6Xw2AwIBAIQCgUYn9/H6urq9jZ2ZmfUxQFmqaX7v0XqFAoYDQa4fV6sb6+Tva0Wi2kUilKpRI2NzehVquhUqmWnP0D7Pf7RLe2tkiFoVCIVCISiSAWi3F+fg69Xo+1tTXYbDYIBAK0Wq0l29Tso9vtQiaToVAoELVYLHC73eTybHQ6HUgkEmxsbECpVJI4JlkuuqOm9GnJu7u7WFlZIZBmswmn04nt7e05MBqNEru9Xo+srVbrPBKeQqqkZv7zfGXhcBgvDw6IVafDgSO/nzTG4/HAbrfD5/MhGAzx+g6ZTBaHr17D+NwElmXnWVITxz/bX1G+zCOXL/Chs+SHBl9hKp1GJpvFKc0gEoshkfyI4kUen1JJ1KrXKLNFNOplPHBNdH89EqfUde0Ge4ZnuLk6xo/2EyJMAkwqTabvfRhH4Q84TaYQ5+H+4xialQRalRN8vy+jcRXDt7tLcK0L1Eon0wzv7jnEkycIhgM4fPMW9UYTl2wZOb6jEToOmoelsjlkC5+RzJzh4b6CeplGq5bF7Zc8D2Tx9HiL2/rZ36a0uSIcL/Z4SHHpXU06N+IzGUyU3xsOR/PnMdHpHP25MySN+Q2WEdYx6p2mrwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="thumbnail"
        title=""
        src="/static/065347829ad8e5381a4b6c153aa843a2/f058b/thumbnail.png"
        srcset="/static/065347829ad8e5381a4b6c153aa843a2/c26ae/thumbnail.png 158w,
/static/065347829ad8e5381a4b6c153aa843a2/6bdcf/thumbnail.png 315w,
/static/065347829ad8e5381a4b6c153aa843a2/f058b/thumbnail.png 630w,
/static/065347829ad8e5381a4b6c153aa843a2/40601/thumbnail.png 945w,
/static/065347829ad8e5381a4b6c153aa843a2/78612/thumbnail.png 1260w,
/static/065347829ad8e5381a4b6c153aa843a2/c2d9c/thumbnail.png 1326w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<h1 id="1-jpa-시작하기-왜-객체-중심-개발인가" style="position:relative;"><a href="#1-jpa-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0-%EC%99%9C-%EA%B0%9D%EC%B2%B4-%EC%A4%91%EC%8B%AC-%EA%B0%9C%EB%B0%9C%EC%9D%B8%EA%B0%80" aria-label="1 jpa 시작하기 왜 객체 중심 개발인가 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. JPA 시작하기: 왜 객체 중심 개발인가?</h1>
<h2 id="jpa를-써야-하는-이유" style="position:relative;"><a href="#jpa%EB%A5%BC-%EC%8D%A8%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0" aria-label="jpa를 써야 하는 이유 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JPA를 써야 하는 이유</h2>
<ul>
<li><strong>SQL 중심에서 객체 중심으로</strong>: JPA 없이 JdbcTemplate만 사용하면 객체를 RDB에 저장하고 불러오는 반복적인 매핑 과정이 매우 번거롭습니다. JPA는 이 과정을 자동화합니다.</li>
<li><strong>생산성 및 유지보수 향상</strong>: 필드 하나가 추가될 때 수많은 SQL을 수정해야 하는 고통에서 해방됩니다.</li>
<li><strong>성능 최적화</strong>: 지연 로딩, 쓰기 지연 등 다양한 성능 최적화 기능을 제공합니다.</li>
</ul>
<h2 id="jpa의-두-가지-핵심" style="position:relative;"><a href="#jpa%EC%9D%98-%EB%91%90-%EA%B0%80%EC%A7%80-%ED%95%B5%EC%8B%AC" aria-label="jpa의 두 가지 핵심 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JPA의 두 가지 핵심</h2>
<ol>
<li><strong>매핑(Mapping)</strong>: 객체와 테이블을 어떻게 연결할 것인가?</li>
<li><strong>영속성 컨텍스트 동작 방식</strong>: 영속성 컨텍스트가 내부적으로 어떻게 데이터를 관리하는가?</li>
</ol>
<hr>
<h1 id="2-내부-동작-방식영속성-관리" style="position:relative;"><a href="#2-%EB%82%B4%EB%B6%80-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D%EC%98%81%EC%86%8D%EC%84%B1-%EA%B4%80%EB%A6%AC" aria-label="2 내부 동작 방식영속성 관리 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 내부 동작 방식(영속성 관리)</h1>
<h2 id="entitymanagerfactory와-entitymanager" style="position:relative;"><a href="#entitymanagerfactory%EC%99%80-entitymanager" aria-label="entitymanagerfactory와 entitymanager permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>EntityManagerFactory와 EntityManager</h2>
<ul>
<li>
<p>EntityManagerFactory</p>
<ul>
<li>EntityManager를 생성하는 Factory 객체입니다.</li>
<li><strong>생성 비용이 비싸서</strong> 애플리케이션 전역에서 1개만 생성하고 재사용합니다.</li>
</ul>
</li>
<li>
<p><strong>EntityManager</strong></p>
<ul>
<li><strong>영속성 컨텍스트를 관리하는 객체</strong>입니다.</li>
<li>Client의 요청마다 EntityManager를 생성하고, 하나의 EntityManager는 하나의 Connection을 사용합니다.</li>
<li><strong>Entity의 상태 변경 시, 반드시 트랜잭션이 필요</strong>합니다. 단순 조회에서는 필수는 아니지만 트랜잭션을 읽기 전용으로 설정하여 최적화 할 수 있습니다.</li>
<li>Bean으로 주입받으려면 <code class="language-text">@PersistenceContext</code> 를 필드에 추가합니다. Spring Data JPA를 쓰면 <code class="language-text">@Autowired</code> 로도 주입받을 수 있습니다.</li>
</ul>
</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a class="gatsby-resp-image-link"
    href="/static/fb39233707f71ba069323ff5e9e42f5f/4b2cc/entity-manager-architecture.png"
    style="display: block"
    target="_blank"
    rel="noopener noreferrer"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.59493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVR42n1Ti46DMAzj///yBtwY9AkFWl4+nK3TTToukkUEqeO4ocArlmXBPM+CGCNSTPDBo/MKcY7yLoM1V1HkZBxHeO8xDAPqun7DeYcQArZtw77vOI5Dapn/S0iivu+fatcF67oKGNM0fRCwwSUhOzOojjg1wMwOzdjCp/5NmOsyIZvxPfM8Ga0oqqqCtRa32w11WaFWdzxCh27SKP03+jDg0TxkfNY2TQPnnJCRgBZkO0he8AMvpOs6GG3g4wA9Gbjo0ZzE276JFVTAA4QxBm3bygUxsnpyFezAYFcqlfwko8KwjO8Rf49MZRSRUhJlmVgIc6GxRrxYjhVqtkKoTqXHawN4OIMNlFJCwMiihJCecNyyLKGVFg/vfSsX8+UqGGfFN/rHOhJxXKqkFXyyYfa0YDdKprrxzNO+wEQHFS1s8s8Rp+eIsvCnQh6mqr/wsdhaazE/rxB95ZPeck3oF8HaPOblYvMAJZMwXxBBQk5BEoI1VHn16/0APZGkdS5Lv78AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="EntityManagerFactory와 EntityManager 구조"
        title=""
        src="/static/fb39233707f71ba069323ff5e9e42f5f/f058b/entity-manager-architecture.png"
        srcset="/static/fb39233707f71ba069323ff5e9e42f5f/c26ae/entity-manager-architecture.png 158w,
/static/fb39233707f71ba069323ff5e9e42f5f/6bdcf/entity-manager-architecture.png 315w,
/static/fb39233707f71ba069323ff5e9e42f5f/f058b/entity-manager-architecture.png 630w,
/static/fb39233707f71ba069323ff5e9e42f5f/40601/entity-manager-architecture.png 945w,
/static/fb39233707f71ba069323ff5e9e42f5f/4b2cc/entity-manager-architecture.png 1013w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<h2 id="영속성-컨텍스트" style="position:relative;"><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8" aria-label="영속성 컨텍스트 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>영속성 컨텍스트</h2>
<ul>
<li>JPA에서 가장 중요한 용어로, <strong>논리적인 개념</strong>입니다.</li>
<li>EntityManager를 통해서 영속성 컨텍스트에 접근합니다.
<ul>
<li>EntityManager는 트랜잭션 단위로 생성됩니다. 즉, <strong>트랜잭션이 끝나면 EntityManager도 종료되고, 영속성 컨텍스트도 종료</strong>된다.</li>
</ul>
</li>
</ul>
<h2 id="영속성-컨텍스트의-특징" style="position:relative;"><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8%EC%9D%98-%ED%8A%B9%EC%A7%95" aria-label="영속성 컨텍스트의 특징 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>영속성 컨텍스트의 특징</h2>
<h3 id="1차-캐시" style="position:relative;"><a href="#1%EC%B0%A8-%EC%BA%90%EC%8B%9C" aria-label="1차 캐시 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1차 캐시</h3>
<p>영속성 컨텍스트 내부에는 Key-Value 형태의 <strong>1차 캐시</strong>가 존재합니다.<br>
(<strong>Key: <code class="language-text">@Id</code> 어노테이션을 설정한 필드의 값</strong>, Value: Entity의 인스턴스)</p>
<p>영속 상태의 Entity는 모두 1차 캐시에 저장됩니다.<br>
덕분에, DB에 조회할 때 우선 1차 캐시에서 데이터(인스턴스)를 조회합니다.</p>
<p>존재하면 DB를 거치지 않고 바로 반환하기에 성능 상 이점이 있습니다.<br>
(사실상 한 트랜잭션 안에서만 사용되는 성능 상의 이점이기 떄문에, 극적인 효과를 누릴 순 없습니다. 이때 애플리케이션 전역에서 사용하기 위한 캐시로, <em>2차 캐시</em> 가 존재하긴 합니다.)</p>
<h3 id="동일성-보장" style="position:relative;"><a href="#%EB%8F%99%EC%9D%BC%EC%84%B1-%EB%B3%B4%EC%9E%A5" aria-label="동일성 보장 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>동일성 보장</h3>
<p><a href="#1%EC%B0%A8-%EC%BA%90%EC%8B%9C" target="_blank" rel="noopener noreferrer">1차 캐시</a> 덕분에, 똑같은 식별자로 조회한 두 Entity의 인스턴스 주소값이 동일함을 항상 보장합니다.<br>
이는 애플리케이션 레벨에서 트랜잭션 격리 수준 중, <a href="https://kdkdhoho.github.io/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4/understanding-transaction-and-concurrency-problem/#3-3-repeatable-read" target="_blank" rel="noopener noreferrer">Repeatable Reade</a>를 보장합니다.</p>
<h3 id="쓰기-지연" style="position:relative;"><a href="#%EC%93%B0%EA%B8%B0-%EC%A7%80%EC%97%B0" aria-label="쓰기 지연 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>쓰기 지연</h3>
<p>영속성 컨텍스트 내부에는 1차 캐시 외에도 <strong>쓰기 지연 SQL 저장소</strong>가 있습니다.</p>
<p>이 곳에 <code class="language-text">INSERT</code>, <code class="language-text">UPDATE</code>, <code class="language-text">DELETE</code> 쿼리를 저장해두다가 <strong>트랜잭션이 커밋하는 순간에 DB로 전달</strong>합니다. 이를 <strong>Flush</strong> 라고 합니다.</p>
<p>덕분에 DB와의 네트워크 통신 비용을 줄일 수 있습니다.</p>
<h3 id="dirty-checking-변경-감지" style="position:relative;"><a href="#dirty-checking-%EB%B3%80%EA%B2%BD-%EA%B0%90%EC%A7%80" aria-label="dirty checking 변경 감지 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dirty Checking (변경 감지)</h3>
<p>영속 상태의 Entity 필드값이 변경되면, 트랜잭션 커밋 시점에 별도의 <code class="language-text">persist()</code> 호출 없이도 자동으로 UPDATE 쿼리가 실행되는 기능입니다.</p>
<p>동작 원리는 다음과 같습니다.</p>
<ol>
<li><strong>스냅샷</strong>: Entity를 영속성 컨텍스트에 처음 저장할 때의 상태를 복사해서 보관합니다.</li>
<li><strong>비교 및 생성</strong>: <code class="language-text">flush()</code> 호출 시, 1차 캐시의 현재 Entity 상태와 스냅샷을 비교합니다.</li>
<li><strong>SQL 저장</strong>: 차이점이 발견되면 UPDATE 쿼리를 생성하여 쓰기 지연 SQL 저장소에 보관 후 DB에 전달합니다.</li>
</ol>
<h3 id="lazy-loading" style="position:relative;"><a href="#lazy-loading" aria-label="lazy loading permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lazy Loading</h3>
<p>연관된 객체를 즉시 조회하지 않고, <strong>실제로 사용할 때(프록시 객체 초기화 시점) 조회하는 전략</strong>입니다.</p>
<p>가급적 모든 연관관계에는 지연 로딩을 사용하는 것이 실무적인 권장 사항입니다.</p>
<h2 id="플러시" style="position:relative;"><a href="#%ED%94%8C%EB%9F%AC%EC%8B%9C" aria-label="플러시 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>플러시</h2>
<p>영속성 컨텍스트의 변경 사항을 DB에 동기화하는 작업입니다.<br>
플러시는 영속성 컨텍스트를 비우는 것이 아닌 <strong>단순히 쓰기 지연 SQL 저장소에 쌓인 SQL을 DB로 전달</strong>할 뿐입니다.<br>
따라서 1차 캐시도 유지가 됩니다.</p>
<p>플러시가 발생하는 시점은 다음과 같습니다.</p>
<ul>
<li><code class="language-text">em.flush()</code> 직접 호출</li>
<li>트랜잭션 커밋 전 자동 호출</li>
<li>JPQL 쿼리 실행: SQL로 변환되어 DB에 직접 날아가기 전, 정합성을 위해 자동 호출합니다. 이유가 중요한데, <strong>JPQL로 <code class="language-text">SELECT</code> 문을 실행하면 영속성 컨텍스트를 거치지 않고 바로 DB를 조회</strong>합니다. 이떄 영속성 컨텍스트에 저장된 Entity가 DB에 반영이 되어 있어야 정합성에 문제가 발생하지 않기 떄문입니다.</li>
</ul>
<h2 id="entity" style="position:relative;"><a href="#entity" aria-label="entity permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Entity</h2>
<p>데이터베이스 테이블과 매핑되는 <strong>자바 객체</strong>입니다.<br>
JPA가 Java의 Reflection 기능을 활용하기 때문에 <strong>기본 생성자가 필수</strong>입니다.</p>
<h2 id="entity의-생명주기" style="position:relative;"><a href="#entity%EC%9D%98-%EC%83%9D%EB%AA%85%EC%A3%BC%EA%B8%B0" aria-label="entity의 생명주기 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Entity의 생명주기</h2>
<ul>
<li><strong>비영속 상태</strong>: 영속성 컨텍스트에 한번도 포함되지 않은 상태입니다.</li>
<li><strong>영속 상태</strong>: 영속성 컨텍스트에 포함되어 있는 상태입니다.</li>
<li><strong>준영속</strong>: 영속성 컨텍스트에 포함됐다가 분리된 상태입니다.</li>
<li><strong>삭제</strong>: 영속성 컨텍스트에 포함은 되지만 <em>REMOVED</em> 로 기록된 상태입니다. 트랜잭션 커밋 시점에 DELETE 쿼리가 나갑니다.</li>
</ul>
<h1 id="3-entity-매핑" style="position:relative;"><a href="#3-entity-%EB%A7%A4%ED%95%91" aria-label="3 entity 매핑 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Entity 매핑</h1>
<h2 id="기본-매핑-어노테이션" style="position:relative;"><a href="#%EA%B8%B0%EB%B3%B8-%EB%A7%A4%ED%95%91-%EC%96%B4%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98" aria-label="기본 매핑 어노테이션 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 매핑 어노테이션</h2>
<ul>
<li><code class="language-text">@Entity</code>
<ul>
<li>JPA가 관리할 클래스임을 지정합니다.</li>
<li>기본 생성자가 필수입니다. 기본 생성자의 접근 제어자는 public이나 protected 수준이어야 합니다.</li>
<li><code class="language-text">final</code>, <code class="language-text">enum</code>, <code class="language-text">interface</code>, <code class="language-text">inner</code> 클래스에는 사용이 불가합니다.</li>
<li>속성
<ul>
<li>name: JPA에서 사용할 Entity의 이름</li>
</ul>
</li>
</ul>
</li>
<li><code class="language-text">@Table</code>: 엔티티와 매핑할 테이블 명칭을 지정합니다.
<ul>
<li>Entity와 매핑할 테이블을 설정합니다.</li>
<li>속성
<ul>
<li>name: 매핑할 테이블 이름</li>
<li>catalog: DB Catalog 매핑</li>
<li>schema: DB Schema 매핑</li>
<li>uniqueConstraints: DDL 생성 시, 유니크 제약 조건 생성</li>
</ul>
</li>
</ul>
</li>
<li><code class="language-text">@Column</code>: 필드와 컬럼을 매핑합니다. 제약조건 설정이 가능합니다.</li>
<li><code class="language-text">@Enumerated</code>: Enum 객체를 매핑합니다. 이떄 반드시 <strong>STRING 타입을 사용</strong>해야 합니다. <em>ORDINAL</em> 은 Enum의 필드 순서 변경 시 치명적 오류가 발생합니다.</li>
</ul>
<h2 id="db-schema-자동-생성" style="position:relative;"><a href="#db-schema-%EC%9E%90%EB%8F%99-%EC%83%9D%EC%84%B1" aria-label="db schema 자동 생성 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DB Schema 자동 생성</h2>
<ul>
<li><code class="language-text">ddl-auto</code> 옵션 ^4dcc88
<ul>
<li>create: 기존 테이블 삭제 후 다시 생성</li>
<li>create-drop: create 이후, 애플리케이션 종료 시점에 테이블 DROP</li>
<li>update: 변경된 부분만 <code class="language-text">ALTER</code>. <strong>삭제, 변경은 하지 않고 추가만 한다</strong>. 운영 환경에서는 사용 X</li>
<li>validate: Entity와 테이블이 정상적으로 매핑됐는지만 확인</li>
<li>none: 사용하지 않음</li>
</ul>
</li>
<li><strong>운영 DB에서는 <em>validate</em>만 사용하고, [[Flyway]]로 스키마를 관리하는 것이 안전</strong>하다.
<code class="language-text">ALTER</code> 쿼리를 잘못 날리면 DB가 중단될 수 있다.</li>
</ul>
<h2 id="필드와-칼럼-매핑" style="position:relative;"><a href="#%ED%95%84%EB%93%9C%EC%99%80-%EC%B9%BC%EB%9F%BC-%EB%A7%A4%ED%95%91" aria-label="필드와 칼럼 매핑 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>필드와 칼럼 매핑</h2>
<ul>
<li><code class="language-text">@Entity</code>를 붙인 클래스의 필드와 DB 테이블의 칼럼을 매핑한다.</li>
<li>필드에 <code class="language-text">@Column</code>을 안붙여도 자동으로 매핑된다.</li>
<li><code class="language-text">@Column</code>
<ul>
<li>칼럼명을 다르게 하고 싶거나, null, unique, length 같은 제약조건을 명시하고 싶을 때, 혹은 별도 설정을 하고 싶을 때 사용한다.</li>
<li>속성
<ul>
<li>unique
<ul>
<li>유니크 제약 조건을 설정하는 옵션이다.</li>
<li>다만, [[#^4dcc88|ddl-auto]] 옵션으로 자동 생성될 때 제약 조건이 이름이 이상하게 생성되고 복합 설정도 안된다.
따라서 <code class="language-text">@Table</code> 어노테이션의 <code class="language-text">uniqueConstraints</code> 속성을 활용하는 것이 좋다.</li>
</ul>
</li>
<li>columnDefinition
<ul>
<li>DB 칼럼 정보를 직접 설정한다.</li>
</ul>
</li>
<li>table:</li>
<li>precision, scale
<ul>
<li>BigDecimal 타입일 때 사용한다. double, float 타입에는 적용되지 않는다.</li>
<li>precision: 소수점을 포함한 전체 자리수
scale: 소수의 자리수</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code class="language-text">@Enumerated</code>
<ul>
<li>Java의 Enum 타입을 매핑한다.</li>
<li><strong>무조건 <code class="language-text">EnumType.ORDINAL</code> 말고 <code class="language-text">EnumType.STRING</code>을 사용한다.</strong></li>
</ul>
</li>
<li><code class="language-text">@Lob</code>
<ul>
<li>CLob, BLob 타입을 매핑한다.</li>
</ul>
</li>
<li><code class="language-text">@Transient</code>
<ul>
<li>필드를 <strong>칼럼에 매핑하고 싶지 않을 때</strong> 사용한다.</li>
<li>주로 메모리 상에서 임시로 값을 저장할 때 사용한다.</li>
</ul>
</li>
</ul>
<h2 id="기본-키-매핑" style="position:relative;"><a href="#%EA%B8%B0%EB%B3%B8-%ED%82%A4-%EB%A7%A4%ED%95%91" aria-label="기본 키 매핑 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 키 매핑</h2>
<ul>
<li><code class="language-text">@Id</code>
<ul>
<li>단독으로 사용하면 애플리케이션에서 직접 할당한다.</li>
</ul>
</li>
<li><code class="language-text">@GeneratedValue</code>
<ul>
<li>ID 값을 <strong>자동으로 할당</strong>할 때 사용한다.</li>
<li>속성
<ul>
<li>IDENTITY
<ul>
<li>기본키 값 할당을 DB에 위임하는 전략이다. (AUTO_INCREMENT)</li>
<li>전략 특성 상, <strong><code class="language-text">em.persist()</code> 가 호출되는 시점에 즉시 DB로 <code class="language-text">INSERT</code> 쿼리를 실행한다.</strong>
Entity를 영속성 컨텍스트에서 관리하기 위함인데, Entity가 영속성 컨텍스트에 관리되려면 반드시 기본키 값이 필요한다. 하지만 <em>IDENTITY</em> 일 때는 기본키 필드에 <code class="language-text">null</code>이 할당된다. 따라서 곧바로 <code class="language-text">INSERT</code> 쿼리를 실행한다.</li>
<li>영한님) 그렇다고 유의미한 성능 저하가 발생하진 않더라.</li>
<li>예: MySQL, PostgreSQL, SQL Server</li>
</ul>
</li>
<li>SEQUENCE
<ul>
<li>DB 시퀀스 오브젝트를 사용한다.</li>
<li>시퀀스 오브젝트를 매핑하는 <code class="language-text">@SequenceGenerator</code>가 필요하다.
<ul>
<li>속성
<ul>
<li>name: <code class="language-text">@GeneratedValue</code>의 <em>generator</em> 속성에 할당할 이름</li>
<li>sequenceName: 매핑할 DB 시퀀스 오브젝트 이름</li>
<li>initialValue
<ul>
<li>DDL 생성 시에만 사용한다.</li>
<li>초기 값을 설정한다.</li>
</ul>
</li>
<li><strong>allocationSize</strong>
<ul>
<li>시퀀스 한 번 호출에 증가하는 수.</li>
<li><strong>기본값은 50이다.</strong></li>
<li>동시성 문제는 발생하지 않는다.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Entity 초기 저장 시, ID 값을 가져오기 위해 <code class="language-text">call next value</code>를 DB에 실행해서 시퀀스 오브젝트를 호출한다.
<ul>
<li>Entity를 저장할 때마다 네트워크 통신이 이뤄진다는 점에서, 성능 최적화를 위해 <code class="language-text">allocationSize</code> 를 이용한다.</li>
</ul>
</li>
<li>예: Oracle, H2</li>
</ul>
</li>
<li>TABLE
<ul>
<li>별도의 키 생성용 테이블을 사용한다.</li>
<li>모든 DB에 적용이 가능하기에 범용성있게 활용할 수 있지만, 최적화가 안되어 있어 성능 문제가 발생할 수 있다.</li>
<li><code class="language-text">@TableGenerator</code>가 필요하다.</li>
</ul>
</li>
<li>AUTO (default)
<ul>
<li>방언에 따라 자동으로 지정된다.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="연관관계-매핑" style="position:relative;"><a href="#%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91" aria-label="연관관계 매핑 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>연관관계 매핑</strong></h1>
<h2 id="단방향-연관관계" style="position:relative;"><a href="#%EB%8B%A8%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84" aria-label="단방향 연관관계 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단방향 연관관계</h2>
<ul>
<li><code class="language-text">@ManyToOne</code> ^f134d7
<ul>
<li>단방향 연관관계를 맺는 데 사용되는 기본적인 어노테이션</li>
<li>Entity가 <strong>참조 Entity와 다대일 관계</strong>일 때 사용한다.</li>
</ul>
</li>
<li><code class="language-text">@JoinColumn</code> ^b3adc0
<ul>
<li><strong>외래키 칼럼을 매핑</strong>할 때 사용한다.</li>
<li>속성
<ul>
<li><strong><code class="language-text">name</code></strong>
<ul>
<li>DB에 생성할 <strong>외래키 칼럼명</strong>을 설정한다.</li>
<li>생략 시 기본값: <code class="language-text">필드명_참조테이블의PK칼럼명</code> (예: <code class="language-text">user_id</code>)</li>
</ul>
</li>
<li><code class="language-text">nullable</code>, <code class="language-text">insertable</code>, <code class="language-text">updatable</code></li>
<li><code class="language-text">unique</code>
<ul>
<li>일대일 관계에서 주로 사용한다.</li>
</ul>
</li>
<li><code class="language-text">columnDefinition</code>
<ul>
<li>DDL을 직접 정의한다.</li>
</ul>
</li>
<li><strong><code class="language-text">foreginKey</code></strong>
<ul>
<li><strong>외래키 제약조건을 설정</strong>한다.</li>
<li>DDL 자동생성 시에만 영향이 있다.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="양방향-연관관계" style="position:relative;"><a href="#%EC%96%91%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84" aria-label="양방향 연관관계 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>양방향 연관관계</h2>
<ul>
<li>
<p><strong>연관관계의 주인</strong></p>
<ul>
<li><strong>외래키를 관리(Create, Update, Delete)하는 쪽의 Entity</strong>를 의미한다.</li>
<li>연관관계의 주인만이 외래키를 관리하고, <strong>주인이 아닌 쪽은 읽기만 가능</strong>하다.</li>
</ul>
</li>
<li>
<p><code class="language-text">@OneToMany</code></p>
<ul>
<li>속성
<ul>
<li><code class="language-text">mappedBy</code>
<ul>
<li><strong>연관관계의 주인</strong>을 의미한다.</li>
<li>참조하는 Entity의 <code class="language-text">@ManyToOne</code>에 해당하는 필드명을 입력한다.</li>
</ul>
</li>
</ul>
</li>
<li><strong>컬렉션 초기화 시점은 필드에서 곧바로 초기화하는 것이 Hibernate의 권장 사항</strong>이다. 또한, <strong>할당된 인스턴스를 변경하지 않는다</strong>.
<code class="language-text">null</code> 관련 문제를 방지할 수 있고, 무엇보다 JPA가 컬렉션을 영속성 컨텍스트에서 관리할 때 <code class="language-text">PersistenceBag</code> 이라는 일종의 프록시 객체로 감싼다.
이때, <code class="language-text">PersistenceBag</code> 가 참조하는 컬렉션의 참조값을 변경하면 JPA 동작에 문제가 발생할 수 있기 때문이다.</li>
</ul>
</li>
</ul>
<h3 id="양방향-매핑-시-신경써야-할-것-연관관계-편의-메서드-순환-참조-문제" style="position:relative;"><a href="#%EC%96%91%EB%B0%A9%ED%96%A5-%EB%A7%A4%ED%95%91-%EC%8B%9C-%EC%8B%A0%EA%B2%BD%EC%8D%A8%EC%95%BC-%ED%95%A0-%EA%B2%83-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%ED%8E%B8%EC%9D%98-%EB%A9%94%EC%84%9C%EB%93%9C-%EC%88%9C%ED%99%98-%EC%B0%B8%EC%A1%B0-%EB%AC%B8%EC%A0%9C" aria-label="양방향 매핑 시 신경써야 할 것 연관관계 편의 메서드 순환 참조 문제 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>양방향 매핑 시 신경써야 할 것: 연관관계 편의 메서드, 순환 참조 문제</h3>
<ul>
<li>연관관계의 주인에 해당하는 Entity가 아닌 <code class="language-text">@OneToMany</code>에 해당하는 Entity에만 값을 쓰는 경우이다.
이 경우, DB에 값이 의도한대로 저장되지 않는다.
<code class="language-text">@OneToMany</code>는 읽기 전용이기 때문이다.
따라서 <strong>반드시 연관관계 주인</strong>에 해당하는 Entity에 값(객체)을 할당해야 한다.</li>
<li>그렇다고 <code class="language-text">@ManyToOne</code> 쪽 Entity에만 값을 할당하는 것도 정답은 아니다.
왜냐하면, 객체지향 관점에서 생각해봤을 때, <code class="language-text">@ManyToOne</code> Entity에 <code class="language-text">@OneToMany</code> Entity가 할당되었다면, <code class="language-text">@OneToMany</code> Entity에서도 <code class="language-text">@ManyToOne</code> Entity로도 할당이 되어야 말이 된다.
따라서 <strong>연관관계 편의 메서드</strong>를 생성한다.
<ul>
<li>
<p>메서드의 위치는 둘 중 하나에만 두면 되는데, 핵심 비즈니스에 가까운 도메인에 위치하는 것이 나은 선택이 된다.
DDD의 Aggregate Root 개념을 사용한다면, Aggregate Root에 위치하는 게 좋은 선택일 확률이 높다.
한 가지 조언으로는, 비즈니스 로직을 구현할 때 양쪽 엔티티에 구현해보면 편한 쪽이 보일 것이다.
또한, 연관관계 편의 메서드의 위치는 개발 중간에 리팩터링 할 수 있으니 큰 부담을 안가지는 게 좋겠다.</p>
<p>관련한 자세한 내용은 <a href="https://www.inflearn.com/community/questions/16308?focusComment=42558" target="_blank" rel="noopener noreferrer">인프런의 QnA 글</a>을 참고하자.</p>
</li>
<li>
<p>예제 코드</p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">changeUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">getOrders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> user<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// null 체크 필수</span>
        user<span class="token punctuation">.</span><span class="token function">getOrders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
</li>
</ul>
</li>
<li>또한, 양방향 매핑 시 <strong>순환 참조 문제</strong>를 조심하자</li>
</ul>
<h3 id="단방향-연관관계와-양방향-연관관계-중-어느-것을-하나" style="position:relative;"><a href="#%EB%8B%A8%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84%EC%99%80-%EC%96%91%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EC%A4%91-%EC%96%B4%EB%8A%90-%EA%B2%83%EC%9D%84-%ED%95%98%EB%82%98" aria-label="단방향 연관관계와 양방향 연관관계 중 어느 것을 하나 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단방향 연관관계와 양방향 연관관계 중 어느 것을 하나?</h3>
<ul>
<li><strong>처음에는 단방향 매핑으로 객체 설계</strong>를 끝낸다.</li>
<li>이후, <code class="language-text">@OneToMany</code>에서 <code class="language-text">@ManyToOne</code> 으로 참조가 필요하다면 그때 양방향 연관관계로 확장한다.</li>
</ul>
<h2 id="일대다-단방향-dcdba0" style="position:relative;"><a href="#%EC%9D%BC%EB%8C%80%EB%8B%A4-%EB%8B%A8%EB%B0%A9%ED%96%A5-dcdba0" aria-label="일대다 단방향 dcdba0 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>일대다 단방향 ^dcdba0</h2>
<ul>
<li>
<p><code class="language-text">@OneToMany</code> 쪽이 연관관계의 주인이 되는 연관관계 매핑 방법이다.
이때, <code class="language-text">@JoinColumn(name = "${외래키 칼럼명}")</code> 을 꼭 붙여줘야 한다.
그렇지 않으면 JPA가 중간 매핑 테이블을 생성한다.</p>
</li>
<li>
<p>외래키를 가지지 않는 Entity에서 외래키를 관리하게 된다.</p>
</li>
<li>
<p>객체 설계 관점에서 이런 구조가 높은 확률로 나타날 수 있지만, [[#^f134d7|다대일 단방향]]과 비교했을 때 추가적인 쿼리가 나가야 한다.</p>
</li>
<li>
<p>권장되지 않는 방법인데, 이유는 다음과 같다.
애플리케이션 코드 상으로는 <code class="language-text">@OneToMany</code> Entity만 수정했는데, 정작 외래키를 가지는 테이블에도 <code class="language-text">UPDATE</code> 쿼리가 나가는 점이, 복잡성보다는 단순함이 지향되는 실무적인 관점에서는 복잡성을 키우기 때문이다.</p>
<p>따라서 외래키를 가지는 Entity 쪽을 연관관계의 주인으로 설정하고, 필요시 양방향 연관관계를 매핑하는 것이 권장된다. 만약 외래키를 가지는 Entity에서 참조하는 Entity로 접근할 일이 없다 하더라도, 위에서 말한 복잡성을 낮추기 위해 객체 설계 관점에서 단순성을 희생하는 방식으로 채택하는 것이 권장된다.</p>
</li>
</ul>
<h2 id="일대다-양방향" style="position:relative;"><a href="#%EC%9D%BC%EB%8C%80%EB%8B%A4-%EC%96%91%EB%B0%A9%ED%96%A5" aria-label="일대다 양방향 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>일대다 양방향</h2>
<ul>
<li>[[#^dcdba0|일대다 단방향]]처럼 <code class="language-text">@OneToMany</code> 쪽이 연관관계의 주인인 구조에서, <code class="language-text">@ManyToOne</code>은 읽기 전용으로 객체 참조를 추가하는 방식이다.</li>
<li><code class="language-text">@ManyToOne</code>에 <code class="language-text">@JoinColumn(name = "${외래키 칼럼명}", insertable = false, updatable = false)</code> 를 추가해야 한다.
<ul>
<li><code class="language-text">insertable</code>과 <code class="language-text">updatable</code>을 끔으로서 읽기 전용으로 만드는 야매 방식이다.</li>
</ul>
</li>
<li>일대다 양방향도 예측하기 힘든 특성이 유지되므로 다대일 양방향을 사용하자.</li>
</ul>
<h2 id="일대일-연관관계" style="position:relative;"><a href="#%EC%9D%BC%EB%8C%80%EC%9D%BC-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84" aria-label="일대일 연관관계 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>일대일 연관관계</h2>
<h3 id="단방향" style="position:relative;"><a href="#%EB%8B%A8%EB%B0%A9%ED%96%A5" aria-label="단방향 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단방향</h3>
<ul>
<li><code class="language-text">@OneToOne</code>를 사용한다.</li>
<li>외래키를 가지는 쪽에 [[#^b3adc0||@JoinColumn]] 을 추가한다.</li>
</ul>
<h3 id="양방향" style="position:relative;"><a href="#%EC%96%91%EB%B0%A9%ED%96%A5" aria-label="양방향 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>양방향</h3>
<ul>
<li>마찬가지로 <code class="language-text">@OneToOne</code>을 사용한다.</li>
<li><code class="language-text">mappedBy</code> 속성을 통해서 연관관계의 주인을 나타낸다.</li>
</ul>
<h3 id="대상-테이블에-연관관계-주인-설정" style="position:relative;"><a href="#%EB%8C%80%EC%83%81-%ED%85%8C%EC%9D%B4%EB%B8%94%EC%97%90-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EC%A3%BC%EC%9D%B8-%EC%84%A4%EC%A0%95" aria-label="대상 테이블에 연관관계 주인 설정 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>대상 테이블에 연관관계 주인 설정</h3>
<ul>
<li>단방향은 아예 불가한 방법이다.</li>
<li>양방향은 사실상 연관관계의 주인을 반대 방향으로 설정하면 된다.</li>
</ul>
<h2 id="다대다-연관관계" style="position:relative;"><a href="#%EB%8B%A4%EB%8C%80%EB%8B%A4-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84" aria-label="다대다 연관관계 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>다대다 연관관계</h2>
<ul>
<li>실무에서 쓰면 안된다.
왜냐하면 <strong>다대다 연관관계에서 생성되는 중간 테이블은 확장 할 수 없다.</strong></li>
<li>그래서 두 Entity와 중간 테이블을, <code class="language-text">@ManyToOne</code>(중간 테이블 -> Entity)과 <code class="language-text">@OneToMany</code>(Entity -> 중간 테이블) 로 연결하고 중간 테이블을 Entity로 승격하는 방식이 권장된다.</li>
<li>이때 두 Entity의 ID를 복합키로 PK 제약조건을 걸 수 있는데, 이 구조는 유연성이 다소 떨어진다.
따라서 PK 필드는 별도의 대체키로 두는 것이 권장된다.</li>
</ul>
<h2 id="상속관계-매핑" style="position:relative;"><a href="#%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91" aria-label="상속관계 매핑 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>상속관계 매핑</h2>
<ul>
<li>객체의 상속 관계를 RDB에서 풀기 위한 모델링 전략으로 세 가지 전략이 있다.
JPA는 세 가지 전략에 대해서 모두 매핑이 가능하다.</li>
<li><code class="language-text">@Inheritance(strategy = InheritanceType.XXX)</code> 어노테이션을 부모 클래스에 추가하여 상속관계를 매핑한다.</li>
<li><code class="language-text">@DiscriminatorColumn(name = "${구분지을 칼럼명}")</code> 어노테이션을 부모 Entity에 작성하여 자식 Entity를 구분지을 칼럼명을 설정한다. 기본값은 <code class="language-text">DTYPE</code> 이다.
<code class="language-text">@DiscriminatorValue("${DTYPE에 저장될 값}")</code> 어노테이션을 자식 Entity에 작성하여, 자식 Entity를 나타내는 값을 설정한다.</li>
<li>예제 코드
<ul>
<li><code class="language-text">@Inheritance</code>의 strategy 값만 바꾸면 매핑 방법을 변경할 수 있다.</li>
</ul>
</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Inheritance</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">InheritanceType</span><span class="token punctuation">.</span><span class="token constant">JOINED</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span> 
	<span class="token annotation punctuation">@Id</span> <span class="token annotation punctuation">@GeneratedValue</span> 
	<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span> 
	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span> 
	<span class="token keyword">private</span> <span class="token keyword">int</span> price<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 

<span class="token annotation punctuation">@Entity</span> 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Album</span> <span class="token keyword">extends</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span> 
	<span class="token keyword">private</span> <span class="token class-name">String</span> artist<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 

<span class="token annotation punctuation">@Entity</span> 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Movie</span> <span class="token keyword">extends</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span> 
	<span class="token keyword">private</span> <span class="token class-name">String</span> director<span class="token punctuation">;</span> 
	<span class="token keyword">private</span> <span class="token class-name">String</span> actor<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 

<span class="token annotation punctuation">@Entity</span> 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token keyword">extends</span> <span class="token class-name">Item</span> <span class="token punctuation">{</span> 
	<span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span> 
	<span class="token keyword">private</span> <span class="token class-name">String</span> isbn<span class="token punctuation">;</span>
 <span class="token punctuation">}</span></code></pre></div>
<h3 id="조인-전략" style="position:relative;"><a href="#%EC%A1%B0%EC%9D%B8-%EC%A0%84%EB%9E%B5" aria-label="조인 전략 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>조인 전략</h3>
<ul>
<li>가장 정석적인 방법이다.</li>
<li>부모 Entity에 PK를 두고, 공통 속성을 정의한다. 자식 Entity를 구분하는 칼럼(<code class="language-text">DTYPE</code>)을 포함한다.
자식 Entity에는 부모 Entity의 PK 값을 기본키로 설정한다.</li>
<li><code class="language-text">InheritanceType.JOINED</code> 로 설정한다.</li>
<li>특징
<ul>
<li>[[데이터베이스 정규화]]가 지켜진다. -> 저장 공간 효율적</li>
<li>FK 제약조건을 활용할 수 있다.</li>
<li>자식 테이블 조회 시 부모 테이블과 JOIN이 필요하다. -> 성능 고려</li>
<li>INSERT 쿼리가 2번 발생한다. -> 성능 고려</li>
<li>단일 테이블 전략에 비해, 테이블 구조의 복잡성이 증가한다.</li>
</ul>
</li>
</ul>
<h3 id="단일-테이블-전략" style="position:relative;"><a href="#%EB%8B%A8%EC%9D%BC-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%A0%84%EB%9E%B5" aria-label="단일 테이블 전략 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단일 테이블 전략</h3>
<ul>
<li>상속 구조에 존재하는 모든 속성(필드)을 하나의 테이블에 포함한다.</li>
<li>JPA의 기본 전략이다.</li>
<li><code class="language-text">InheritanceType.SINGLE_TABLE</code>로 설정한다.
단일 테이블 전략의 경우에는 <code class="language-text">@DiscriminatorColumn</code>를 생략할 수 있지만, JPA가 자동으로 추가해준다.</li>
<li>특징
<ul>
<li>[[데이터베이스 정규화||정규화]]가 이뤄지지 않는다.</li>
<li>조회 시 JOIN이 불필요하다.</li>
<li>여러 칼럼에 <code class="language-text">null</code>이 할당된다.</li>
<li>테이블이 매우 비대해질 수 있다. -> 상황에 따라 조회 성능이 느려질 수 있다. -> 성능이 느려지는 임계점이 있는데, 사실상 그 임계점도 잘 안넘는다.</li>
<li><code class="language-text">INSERT</code>와 <code class="language-text">SELECT</code> 쿼리가 가장 단순하다.</li>
</ul>
</li>
</ul>
<h3 id="구현-클래스마다-테이블-전략" style="position:relative;"><a href="#%EA%B5%AC%ED%98%84-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A7%88%EB%8B%A4-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%A0%84%EB%9E%B5" aria-label="구현 클래스마다 테이블 전략 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>구현 클래스마다 테이블 전략</h3>
<ul>
<li><strong>잘 사용되지 않는 방법</strong>이다.</li>
<li>부모 Entity의 필드를 자식 Entity에 모두 (중복되게끔) 저장한다.</li>
<li><code class="language-text">InheritanceType.TABLE_PER_CLASS</code>를 할당한다.</li>
<li><code class="language-text">@DiscriminatorColumn</code>이 무의미해서 추가해도 동작하지 않는다.</li>
<li>특징
<ul>
<li><strong>부모 타입으로 조회 시, <code class="language-text">UNION ALL</code> 연산으로 모든 자식 테이블을 조회한다. -> 성능 문제 발생 가능</strong></li>
<li>변경 관점에서 보면 매우 번거로운 작업이 된다.</li>
</ul>
</li>
</ul>
<h3 id="전략-선택-기준" style="position:relative;"><a href="#%EC%A0%84%EB%9E%B5-%EC%84%A0%ED%83%9D-%EA%B8%B0%EC%A4%80" aria-label="전략 선택 기준 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>전략 선택 기준</h3>
<ul>
<li>상속 구조가 단순하고 확장 가능성이 낮다고 판단될 경우 -> 싱글 테이블 전략</li>
<li>하지만, 비즈니스 적으로 중요한 가치를 지니고 복잡한 구조인 경우 -> 조인 전략</li>
</ul>
<h2 id="mappedsuperclass" style="position:relative;"><a href="#mappedsuperclass" aria-label="mappedsuperclass permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">@MappedSuperclass</code></h2>
<ul>
<li>
<p>하위 Entity에서 <strong>공통으로 매핑할 필드가 있을 때 사용</strong>한다. (예: <em>createdAt</em>, <em>lastUpdatedAt</em>)</p>
</li>
<li>
<p>부모 클래스를 상속받는 <strong>자식 Entity에 매핑 정보만 제공</strong>한다.</p>
</li>
<li>
<p><code class="language-text">@Id</code> 필드는 하지 않는 것 같다.
JPA 기본편에서도 ID 필드를 추가하지 않으시고, Q&#x26;A에서도 ID 필드의 경우 <code class="language-text">member_id</code> 처럼 이름이 Entity마다 다르기에 따로 <code class="language-text">@MappedSuperclass</code>에 두지 않는다고 하신다.</p>
<p>추가로, <a href="https://stackoverflow.com/questions/29943132/overriding-id-defined-in-a-mappedsuperclass-with-jpa" target="_blank" rel="noopener noreferrer">Stackoverflow</a>에서도 <code class="language-text">@Id</code> 필드를 <code class="language-text">BaseEntity</code>에 정의하면 하위 클래스에서 재정의할 수 없으므로 <code class="language-text">@Id</code>는 각각의 구체 클래스에 두는 것이 좋다고 한다.</p>
</li>
<li>
<p>예시 코드</p>
</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@MappedSuperclass</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">SoftDeleteEntity</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> deleted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> deletedDate<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">softDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deleted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deletedDate <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Member</span> <span class="token keyword">extends</span> <span class="token class-name">SoftDeleteEntity</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span> <span class="token annotation punctuation">@GeneratedValue</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 사용</span>
member<span class="token punctuation">.</span><span class="token function">softDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// DB에서 실제로 삭제하지 않고 플래그만 변경</span></code></pre></div>
<h3 id="부모-클래스의-속성-재정의" style="position:relative;"><a href="#%EB%B6%80%EB%AA%A8-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EC%86%8D%EC%84%B1-%EC%9E%AC%EC%A0%95%EC%9D%98" aria-label="부모 클래스의 속성 재정의 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>부모 클래스의 속성 재정의</h3>
<ul>
<li>부모 클래스(<code class="language-text">BaseEntity</code>)의 속성을 재정의할 수 있다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@MappedSuperclass</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createdDate<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> createdBy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@AttributeOverrides</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"createdDate"</span><span class="token punctuation">,</span> 
        column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"member_created_date"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"createdBy"</span><span class="token punctuation">,</span> 
        column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"member_created_by"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Member</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<h1 id="프록시와-연관관계-관리" style="position:relative;"><a href="#%ED%94%84%EB%A1%9D%EC%8B%9C%EC%99%80-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EA%B4%80%EB%A6%AC" aria-label="프록시와 연관관계 관리 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>프록시와 연관관계 관리</strong></h1>
<h2 id="emfind와-emgetreference" style="position:relative;"><a href="#emfind%EC%99%80-emgetreference" aria-label="emfind와 emgetreference permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">em.find()</code>와 <code class="language-text">em.getReference()</code></h2>
<p>JPA를 통해 Entity를 조회할 때, <code class="language-text">em.find()</code> 와 <code class="language-text">em.getReference()</code> 두 메서드가 있다.
<code class="language-text">em.find()</code>는 실제 Entity 객체를 조회하고, <code class="language-text">em.getReference()</code>는 프록시 객체로 조회한다.</p>
<h2 id="지연-로딩" style="position:relative;"><a href="#%EC%A7%80%EC%97%B0-%EB%A1%9C%EB%94%A9" aria-label="지연 로딩 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>지연 로딩</h2>
<ul>
<li>특정 Entity를 DB에서 조회할 때, 그 Entity가 참조하는 다른 Entity를 매번 함께 조회하는 것은 불필요한 오버헤드가 될 수 있다.</li>
<li>JPA는 이러한 오버헤드를 줄여주기 위해 [[#프록시 객체]]를 이용한 [[#지연 로딩]]을 지원한다.</li>
<li>이후, 해당 Entity의 ID가 아닌 다른 필드에 접근하면 그때 프록시를 초기화한다.</li>
</ul>
<h2 id="프록시-객체" style="position:relative;"><a href="#%ED%94%84%EB%A1%9D%EC%8B%9C-%EA%B0%9D%EC%B2%B4" aria-label="프록시 객체 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프록시 객체</h2>
<ul>
<li>Target 클래스를 <strong>상속받아서 생성</strong>된다.
이 특징 때문에 <strong>타입 체크 시</strong> <code class="language-text">==</code> 연산자 말고 <code class="language-text">instanceOf</code> 를 사용해야 한다.
<code class="language-text">==</code> 연산자는 두 인스턴스가 동일한지 비교하고, <code class="language-text">instanceOf</code>는 인스턴스가 특정 타입(클래스 or 인터페이스)인지 확인한다.</li>
<li>프록시 객체의 초기화
<ol>
<li>프록시 객체를 초기화하기 위해 <strong>영속성 컨텍스트에 초기화 요청</strong>을 한다.
때문에, <strong>Entity가 준영속 상태일 때 초기화하면 <code class="language-text">LazyInitializatinException</code>이 발생</strong>한다.</li>
<li>영속성 컨텍스트는 DB에 조회를 하고, 결과인 Entity를 <code class="language-text">T target</code>에 할당한다.</li>
</ol>
</li>
<li>영속성 컨텍스트에 이미 Target 인스턴스가 할당 된 상태라면 굳이 초기화하지 않는다.</li>
</ul>
<h3 id="관련-유틸성-메서드" style="position:relative;"><a href="#%EA%B4%80%EB%A0%A8-%EC%9C%A0%ED%8B%B8%EC%84%B1-%EB%A9%94%EC%84%9C%EB%93%9C" aria-label="관련 유틸성 메서드 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>관련 유틸성 메서드</h3>
<p><code class="language-text">EntityManagerFactory</code>에서 <code class="language-text">.getPersistenceUnitUitl()</code>을 호출해서 <code class="language-text">PersistenceUnitUtil</code> 객체를 가져올 수 있다.</p>
<ul>
<li><code class="language-text">PersistenceUnitUtil.isLoaded(Object entity)</code>: 프록시 인스턴스 초기화 여부 확인</li>
<li><code class="language-text">entity.getClass().getName()</code>: 프록시 클래스 확인</li>
<li><code class="language-text">org.hibernate.Hibernate.initialize(entity)</code>: 프록시 강제 초기화</li>
</ul>
<h2 id="즉시-로딩" style="position:relative;"><a href="#%EC%A6%89%EC%8B%9C-%EB%A1%9C%EB%94%A9" aria-label="즉시 로딩 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>즉시 로딩</h2>
<ul>
<li>Entity를 조회할 때, 참조하는 Entity도 <code class="language-text">LEFT OUTER JOIN</code>을 통해 함께 조회한다.</li>
</ul>
<h2 id="실무에서-즉시-로딩-지연-로딩" style="position:relative;"><a href="#%EC%8B%A4%EB%AC%B4%EC%97%90%EC%84%9C-%EC%A6%89%EC%8B%9C-%EB%A1%9C%EB%94%A9-%EC%A7%80%EC%97%B0-%EB%A1%9C%EB%94%A9" aria-label="실무에서 즉시 로딩 지연 로딩 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>실무에서 즉시 로딩? 지연 로딩?</h2>
<ul>
<li>실무에서는 <strong>가급적 지연 로딩만 사용</strong>한다.</li>
<li>이유
<ol>
<li>즉시 로딩으로 참조하는 Entity가 3개만 돼도 3중 JOIN 쿼리문이 나간다.
실무에서는 객체 참조가 많을 확률이 높다.</li>
<li><strong>JPQL에서 [[#N+1 문제]]가 발생</strong>한다.</li>
</ol>
</li>
</ul>
<h2 id="n1-문제" style="position:relative;"><a href="#n1-%EB%AC%B8%EC%A0%9C" aria-label="n1 문제 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>N+1 문제</h2>
<ul>
<li>1개의 조회 쿼리가 수행되고, 그 결과의 개수가 N일 때, <strong>N개의 쿼리</strong>가 추가적으로 나가는 문제다.</li>
<li><code class="language-text">@ManyToOne</code> Entity 이거나, <code class="language-text">@OneToMany</code> Entity 상관없이, <strong>조회한 Entity들의 컬렉션을 순회하면서, 각 Entity의 LAZY 로딩된 참조 Entity에 접근</strong>하면서 생기는 문제다.</li>
<li>만약, <code class="language-text">Order</code> 가 <code class="language-text">@ManyToOne</code> 으로 <code class="language-text">User</code> 엔티티를 참조하고, <code class="language-text">@OneToOne</code>으로 <code class="language-text">Address</code>를 참조한다고 했을 때,
1번의 쿼리로 N개의 <code class="language-text">Order</code> 엔티티가 조회되었을 때, <code class="language-text">User</code> 엔티티를 조회하기 위해 N개의 쿼리와 <code class="language-text">Address</code> 엔티티를 조회하기 위해 N개의 쿼리가 추가적으로 실행된다.
결과적으로 <strong>1 + 2N 개의 쿼리가 실행</strong>된다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Team</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span> <span class="token annotation punctuation">@GeneratedValue</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"team"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Member</span><span class="token punctuation">></span></span> members <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Member</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Id</span> <span class="token annotation punctuation">@GeneratedValue</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    
	<span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"team_id"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ManyToOne</span><span class="token punctuation">(</span>fetch <span class="token operator">=</span> <span class="token class-name">FetchType</span><span class="token punctuation">.</span><span class="token constant">LAZY</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Team</span> team<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">case1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 전체 Member 조회 => 쿼리 1개</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Member</span><span class="token punctuation">></span></span> members <span class="token operator">=</span> em
	    <span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token string">"SELECT m FROM Member m"</span><span class="token punctuation">,</span> <span class="token class-name">Member</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 각 Member의 Team에 접근 => 쿼리 N개</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Member</span> member <span class="token operator">:</span> members<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">getTeam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Team 프록시 초기화 시점에 쿼리 발생</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">case2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 전체 Team 조회 => 쿼리 1개</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Team</span><span class="token punctuation">></span></span> teams <span class="token operator">=</span> em
		<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token string">"SELECT t FROM Team t"</span><span class="token punctuation">,</span> <span class="token class-name">Team</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	    <span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 각 Team의 Members에 접근 => 쿼리 N개</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Team</span> team <span class="token operator">:</span> teams<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>team<span class="token punctuation">.</span><span class="token function">getMembers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="영속성-전이-cascade" style="position:relative;"><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%A0%84%EC%9D%B4-cascade" aria-label="영속성 전이 cascade permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>영속성 전이: CASCADE</h2>
<ul>
<li>특정 Entity를 영속 상태로 만들 때, <strong>참조하는 Entity도 함께 영속 상태로 만들고 싶을 때 사용</strong>한다.</li>
<li><code class="language-text">@OneToMany</code> Entity에서 <code class="language-text">@ManyToOne</code> Entity를 참조할 때, Collection을 가진다.
이 Collection에 참조하는 Entity를 저장하면, 해당 Entity를 <code class="language-text">persist()</code>하지 않아도, 함께 영속성 컨텍스트에 저장된다.</li>
<li>보통 <code class="language-text">ALL</code> 또는 <code class="language-text">PERSIST</code> 만 사용한다.</li>
<li><em>CASCADE</em> 를 적용하려는 Entity을 참조하는 Entity가 하나일 때 사용해도 된다. 만약 둘 이상이면 사용하면 안된다.
Parent1 -> Child, Parent2 -> Child 라는 구조일 때, Parent1만 삭제해도 Child가 삭제되고, Parent2 관점에서는 의도하지 않은 삭제가 이뤄지기 때문이다.
그리고 라이프사이클이 동일할 때 사용한다.</li>
</ul>
<h2 id="고아-객체" style="position:relative;"><a href="#%EA%B3%A0%EC%95%84-%EA%B0%9D%EC%B2%B4" aria-label="고아 객체 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>고아 객체</h2>
<ul>
<li>부모 Entity와 연관관계가 끊어진 자식 Entity를 자동으로 삭제하는 기능이다.</li>
<li><code class="language-text">orphanRemoval=true</code> 로 설정한다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">Parent</span> parent <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
parent<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0번 째 인덱스의 자식 Entity 제거</span>
<span class="token comment">// 'DELETE FROM child WHERE id=?' 쿼리 실행</span></code></pre></div>
<ul>
<li>영속성 전이와 마찬가지로 <strong>참조하는 곳이 하나일 때 사용</strong>해야 한다.
== 특정 Entity가 개인 소유(소유자가 하나일 때) 사용해야 한다.</li>
</ul>
<h2 id="영속성-전이--고아-객체" style="position:relative;"><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%A0%84%EC%9D%B4--%EA%B3%A0%EC%95%84-%EA%B0%9D%EC%B2%B4" aria-label="영속성 전이  고아 객체 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>영속성 전이 + 고아 객체</h2>
<ul>
<li>두 옵션 모두 활성화하면, 부모 Entity를 통해서 자식의 생명 주기를 관리할 수 있게 된다.</li>
<li>DDD의 Aggregate Root 개념을 구현할 때 유용하다.</li>
</ul>
<h1 id="값-타입" style="position:relative;"><a href="#%EA%B0%92-%ED%83%80%EC%9E%85" aria-label="값 타입 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>값 타입</h1>
<h2 id="엔티티-타입" style="position:relative;"><a href="#%EC%97%94%ED%8B%B0%ED%8B%B0-%ED%83%80%EC%9E%85" aria-label="엔티티 타입 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>엔티티 타입</h2>
<ul>
<li><code class="language-text">@Entity</code> 로 정의하는 객체</li>
<li>식별자(<code class="language-text">@Id</code>)로 <strong>추적가능</strong>한 객체</li>
</ul>
<h2 id="값-타입-1" style="position:relative;"><a href="#%EA%B0%92-%ED%83%80%EC%9E%85-1" aria-label="값 타입 1 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>값 타입</h2>
<ul>
<li><code class="language-text">int</code>, <code class="language-text">Integer</code>, <code class="language-text">String</code>처럼 단순히 값으로 사용하는 자바 기본 타입 또는 객체</li>
<li>식별자가 없고 값만 있으므로 변경 시 <strong>추적 불가</strong></li>
<li>값이 다르면 다른 객체다.</li>
<li>불변성을 가져야 한다. -> 값이 다르면 서로 다른 객체가 되어야 하기 때문</li>
</ul>
<h2 id="값-타입의-종류" style="position:relative;"><a href="#%EA%B0%92-%ED%83%80%EC%9E%85%EC%9D%98-%EC%A2%85%EB%A5%98" aria-label="값 타입의 종류 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>값 타입의 종류</h2>
<h3 id="기본값-타입" style="position:relative;"><a href="#%EA%B8%B0%EB%B3%B8%EA%B0%92-%ED%83%80%EC%9E%85" aria-label="기본값 타입 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본값 타입</h3>
<ul>
<li>자바 기본 타입(<code class="language-text">int</code>, <code class="language-text">double</code>) 또는 래퍼 클래스(<code class="language-text">Integer</code>, <code class="language-text">Long</code>) 또는 <code class="language-text">String</code></li>
</ul>
<h3 id="임베디드-타입" style="position:relative;"><a href="#%EC%9E%84%EB%B2%A0%EB%94%94%EB%93%9C-%ED%83%80%EC%9E%85" aria-label="임베디드 타입 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>임베디드 타입</h3>
<ul>
<li>2개 이상의 기본값 타입을 묶은 하나의 클래스를 의미한다. (예: Coordinate)</li>
<li><strong>엔티티가 아니라 값 타입</strong>이다.</li>
<li>값 타입 클래스에 <code class="language-text">@Embeddable</code> 을, 값 타입 객체를 사용하는 곳에 <code class="language-text">@Embedded</code> 를 추가한다.
<ul>
<li><code class="language-text">@Embeddable</code>: JPA에게 임베디드 타입임을 알린다.</li>
<li><code class="language-text">@Embedded</code>: JPA에게 임베디드 타입으로 사용함을 알린다.</li>
<li>둘 중 하나 생략 가능하지만, 둘 다 추가하는 걸 권장한다.</li>
</ul>
</li>
<li>하이버네이트 6.2 버전부터는 Record 클래스 사용 가능하다.</li>
<li>임베디드 타입 사용 전과 후에 매핑하는 테이블은 동일하다.</li>
<li>특징
<ul>
<li>높은 응집도</li>
<li>캡슐화</li>
<li>재사용성</li>
</ul>
</li>
<li>임베디드 타입이 엔티티 타입을 참조할 수 있다.</li>
<li>하나의 엔티티 안에서 동일한 타입의 임베디드 타입을 두 개 사용할 때는 <code class="language-text">@AttributeOverrides</code>, <code class="language-text">@AttributeOverride</code> 어노테이션을 활용해서 칼럼 명이 중복되는 문제를 해결해야 한다.
예제 코드
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Member</span> <span class="token punctuation">{</span>

  	<span class="token annotation punctuation">@Embedded</span>
  	<span class="token annotation punctuation">@AttributeOverrides</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  		<span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"city"</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span><span class="token string">"work_city"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  		<span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"street"</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span><span class="token string">"work_street"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  	<span class="token punctuation">}</span><span class="token punctuation">)</span>
  	<span class="token keyword">private</span> <span class="token class-name">Address</span> workAddress<span class="token punctuation">;</span>
  	
  	<span class="token annotation punctuation">@Embedded</span>
  		<span class="token annotation punctuation">@AttributeOverrides</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  			<span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"city"</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span><span class="token string">"home_city"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  			<span class="token annotation punctuation">@AttributeOverride</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"street"</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span><span class="token string">"home_street"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  		<span class="token punctuation">}</span><span class="token punctuation">)</span>
  		<span class="token keyword">private</span> <span class="token class-name">Address</span> homeAddress<span class="token punctuation">;</span>
  	<span class="token punctuation">}</span></code></pre></div>
</li>
</ul>
<h3 id="컬렉션-값-타입" style="position:relative;"><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%ED%83%80%EC%9E%85" aria-label="컬렉션 값 타입 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컬렉션 값 타입</h3>
<ul>
<li>값 타입(임베디드 타입)을 하나 이상 저장할 때 사용한다. 자바 컬렉션에 담아서 사용한다.</li>
<li>컬렉션을 저장하기 위해 <strong>별도의 테이블이 필요</strong>하다.</li>
<li><code class="language-text">@ElementCollection</code> 어노테이션을 컬렉션에 추가하고, <code class="language-text">@CollectionTable</code>을 사용한다.</li>
<li>값 타입 컬렉션도 <strong>지연 로딩</strong> 전략이 default로 적용된다.</li>
<li>[[#영속성 전이 CASCADE|영속성 전이]]와 [[#고아 객체]] 제거 기능이 자동으로 적용된다.</li>
<li>예제 코드
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Member</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span> <span class="token annotation punctuation">@GeneratedValue</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ElementCollection</span>
    <span class="token annotation punctuation">@CollectionTable</span><span class="token punctuation">(</span>
        name <span class="token operator">=</span> <span class="token string">"favorite_food"</span><span class="token punctuation">,</span>
        joinColumns <span class="token operator">=</span> <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"member_id"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"food_name"</span><span class="token punctuation">)</span> <span class="token comment">// 'favorite_food' 테이블에 매핑될 칼럼영</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> favoriteFoods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ElementCollection</span>
    <span class="token annotation punctuation">@CollectionTable</span><span class="token punctuation">(</span>
        name <span class="token operator">=</span> <span class="token string">"address"</span><span class="token punctuation">,</span>
        joinColumns <span class="token operator">=</span> <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"member_id"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Address</span><span class="token punctuation">></span></span> addressHistory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
</li>
</ul>
<h3 id="컬렉션-값-타입의-제약사항" style="position:relative;"><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%ED%83%80%EC%9E%85%EC%9D%98-%EC%A0%9C%EC%95%BD%EC%82%AC%ED%95%AD" aria-label="컬렉션 값 타입의 제약사항 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컬렉션 값 타입의 제약사항</h3>
<ul>
<li>값 타입 컬렉션에 수정이 일어나면, 기존의 모든 데이터를 삭제하고, 최신 버전의 데이터를 모두 새로 저장한다.
값 타입은 추적할 수 없기 때문이다.</li>
<li>또한, 값 타입 컬렉션을 매핑하는 테이블은 <strong>모든 칼럼을 묶어서 기본키로 구성해야 한다.</strong>
이로 인해 null을 입력할 수 없으며 중복 값도 저장할 수 없다.</li>
<li>이러한 제약 사항들 때문에 <strong>상황에 따라 값 타입 컬렉션 대신, 일대다 관계를 고려하는 것도 방법</strong>이다.
[[#일대다 단방향 dcdba0|일대다 단방향]]으로 매핑하거나, 양방향으로 매핑한다.</li>
<li>예시 코드
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AddressEntity</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Id</span> <span class="token annotation punctuation">@GeneratedValue</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ManyToOne</span>
    <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"member_id"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Member</span> member<span class="token punctuation">;</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

</code></pre></div>
</li>
</ul>
<h3 id="컬렉션-값-타입-사용-시점" style="position:relative;"><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%ED%83%80%EC%9E%85-%EC%82%AC%EC%9A%A9-%EC%8B%9C%EC%A0%90" aria-label="컬렉션 값 타입 사용 시점 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컬렉션 값 타입 사용 시점</h3>
<ul>
<li>컬렉션 크기가 작고 변경이 적을 때</li>
<li>비즈니스 규칙이 복잡할 때</li>
</ul>
<h1 id="jpql" style="position:relative;"><a href="#jpql" aria-label="jpql permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JPQL</h1>
<ul>
<li>JPA가 지원하는 쿼리 방법 중 하나다.</li>
<li>JPQL은 <strong>엔티티 객체를 대상으로 쿼리</strong>를 한다.</li>
<li>지원 키워드
: <code class="language-text">SELECT</code>, <code class="language-text">DISTINCT</code>, <code class="language-text">FROM</code>, <code class="language-text">WHERE</code>, <code class="language-text">GROUP BY</code>, <code class="language-text">HAVING</code>, <code class="language-text">ORDER BY</code>, <code class="language-text">JOIN</code>, <code class="language-text">COUNT</code>, <code class="language-text">SUM</code>, <code class="language-text">AVG</code>, <code class="language-text">MAX</code>, <code class="language-text">MIN</code>, <code class="language-text">EXISTS</code>, <code class="language-text">IN</code>, <code class="language-text">AND</code>, <code class="language-text">OR</code>, <code class="language-text">NOT</code>, <code class="language-text">=</code>, <code class="language-text">></code>, <code class="language-text">>=</code>, <code class="language-text">&lt;</code>, <code class="language-text">&lt;=</code>, <code class="language-text">&lt;></code>, <code class="language-text">BETWEEN</code>, <code class="language-text">LIKE</code>, <code class="language-text">IS NULL</code>
<h2 id="문법" style="position:relative;"><a href="#%EB%AC%B8%EB%B2%95" aria-label="문법 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>문법</h2>
<ul>
<li>엔티티와 속성은 대소문자를 구분한다.</li>
<li>JPQL 키워드는 대소문자를 구분하지 않는다.</li>
<li>엔티티 이름을 사용한다. 테이블 이름이 아니다.</li>
<li>별칭은 필수이다.</li>
</ul>
<h2 id="코드" style="position:relative;"><a href="#%EC%BD%94%EB%93%9C" aria-label="코드 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>코드</h2>
<ul>
<li><code class="language-text">TypeQuery</code>: 반환 타입이 명확할 때 사용</li>
</ul>
<code class="language-text">Query</code>: 반환 타입이 명확하지 않을 때 사용
<ul>
<li><code class="language-text">query.getResultList()</code>: 반환 값이 N개일 때</li>
</ul>
<code class="language-text">query.getSingleResult()</code>: 반환 값이 <strong>무조건</strong> 1개일 때.
(결과가 없으면 <code class="language-text">NoResultException</code>이 발생, 결과가 2개 이상이면 <code class="language-text">NonUniqueResultException</code> 발생)
<h2 id="파라미터-바인딩" style="position:relative;"><a href="#%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0-%EB%B0%94%EC%9D%B8%EB%94%A9" aria-label="파라미터 바인딩 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>파라미터 바인딩</h2>
<ul>
<li>JPQL에 <code class="language-text">:{필드명}</code> 으로 적고, <code class="language-text">.setParameter()</code> 으로 값을 할당한다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">String</span> jpql <span class="token operator">=</span> <span class="token string">"SELECT m FROM Member m WHERE m.name = :username"</span>
<span class="token class-name">Member</span> member <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>jpql<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token string">"동호"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">getSingleResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
</li>
</ul>
<h2 id="프로젝션" style="position:relative;"><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98" aria-label="프로젝션 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>프로젝션</h2>
<ul>
<li><strong>SELECT 절에 조회할 대상을 지정하는 것</strong>이다.</li>
<li>아래 세 종류가 있다.</li>
</ul>
<h3 id="엔티티-프로젝션" style="position:relative;"><a href="#%EC%97%94%ED%8B%B0%ED%8B%B0-%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98" aria-label="엔티티 프로젝션 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>엔티티 프로젝션</h3>
<ul>
<li>Entity를 조회하는 경우다. (예: <code class="language-text">SELECT m FROM Member m</code>)</li>
<li>엔티티 프로젝션으로 조회한 엔티티는 영속성 컨텍스트에 영속된다.</li>
<li><code class="language-text">SELECT m.team FROM Member m</code>처럼 특정 Entity의 참조 Entity도 조회할 수 있다.
<ul>
<li>
<p>하지만, <code class="language-text">SELECT t FROM Member m JOIN m.team t</code> 처럼 <code class="language-text">JOIN</code>을 JPQL에 드러내는 것이 좋다.
<code class="language-text">SELECT m.team FROM Member m</code>을 실행하면 <code class="language-text">JOIN</code> 쿼리가 나가는데, 이것이 숨겨지기 때문이다.</p>
<p><code class="language-text">JOIN</code> 쿼리는 성능에 큰 영향을 줄 수 있으며, 쿼리 튜닝의 여지가 있기에 JPQL에 명시적으로 드러내는 것이 권장된다.</p>
</li>
</ul>
</li>
</ul>
<h3 id="임베디드-타입-프로젝션" style="position:relative;"><a href="#%EC%9E%84%EB%B2%A0%EB%94%94%EB%93%9C-%ED%83%80%EC%9E%85-%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98" aria-label="임베디드 타입 프로젝션 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>임베디드 타입 프로젝션</h3>
<ul>
<li>Entity의 임베디드 타입을 조회하는 경우다. (예: <code class="language-text">SELECT m.address FROM Member m</code>)</li>
</ul>
<h3 id="기본-데이터-타입-프로젝션" style="position:relative;"><a href="#%EA%B8%B0%EB%B3%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85-%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98" aria-label="기본 데이터 타입 프로젝션 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 데이터 타입 프로젝션</h3>
<ul>
<li>기본 데이터 타입을 조회하는 경우다. (예: <code class="language-text">SELECT m.username, m.age FROM Member m</code>)</li>
<li>반환 타입을 세 가지 방법으로 설정할 수 있다.
<ul>
<li><code class="language-text">Query</code></li>
<li><code class="language-text">Object[]</code></li>
<li>DTO 객체</li>
</ul>
</li>
<li>가장 권장되는 방식은 DTO 객체로 반환받는 것이다.
예제 코드
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MemberFindResponse</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>
  <span class="token string">"SELECT new com.example.MemberFindResponse(m.username, m.age) FROM Member m"</span><span class="token punctuation">,</span>
  <span class="token class-name">MemberFindResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
</li>
</ul>
<h2 id="페이징" style="position:relative;"><a href="#%ED%8E%98%EC%9D%B4%EC%A7%95" aria-label="페이징 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>페이징</h2>
<ul>
<li>JPA는 페이징을 다음 두 메서드로 추상화한다.
<ul>
<li><code class="language-text">setFirstResult(int startPosition)</code>: 조회 시작 위치 (0부터 시작)</li>
<li><code class="language-text">setMaxResults(int maxResult)</code>: 조회할 데이터 수</li>
</ul>
</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MemberFindResponse</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>
		<span class="token string">"SELECT m FROM Member m ORDER BY m.name DESC"</span><span class="token punctuation">,</span> 
		<span class="token class-name">Member</span><span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setFirstResult</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setMaxResults</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="조인" style="position:relative;"><a href="#%EC%A1%B0%EC%9D%B8" aria-label="조인 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>조인</h2>
<ul>
<li>내부 조인
<ul>
<li><code class="language-text">SELECT m FROM Member m [INNER] JOIN m.team t</code></li>
</ul>
</li>
<li>외부 조인
<ul>
<li><code class="language-text">SELECT m FROM Member m LEFT [OUTER] JOIN m.team t</code></li>
</ul>
</li>
<li>세타 조인
<ul>
<li><code class="language-text">SELECT COUNT(m) FROM Member m, Team t WHERE m.username = t.name</code></li>
</ul>
</li>
<li><strong>ON 절을 이용한 JOIN</strong>
<ul>
<li>조인 대상 필터링이 가능해진다.</li>
<li>연관관계가 없는 엔티티 대상으로 외부 조인이 가능해진다.</li>
<li><code class="language-text">SELECT m FROM Member m LEFT JOIN m.team t ON t.name = 'teamA'</code></li>
</ul>
</li>
</ul>
<h2 id="서브-쿼리" style="position:relative;"><a href="#%EC%84%9C%EB%B8%8C-%EC%BF%BC%EB%A6%AC" aria-label="서브 쿼리 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>서브 쿼리</h2>
<ul>
<li>SQL의 서브쿼리와 동일하다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// 나이가 평균보다 많은 회원</span>
<span class="token constant">SELECT</span> m <span class="token constant">FROM</span> <span class="token class-name">Member</span> m
<span class="token constant">WHERE</span> m<span class="token punctuation">.</span>age <span class="token operator">></span> <span class="token punctuation">(</span><span class="token class-name">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>m2<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token constant">FROM</span> <span class="token class-name">Member</span> m2<span class="token punctuation">)</span>

<span class="token comment">// 한 건이라도 주문한 고객</span>
<span class="token constant">SELECT</span> m <span class="token constant">FROM</span> <span class="token class-name">Member</span> m
<span class="token constant">WHERE</span> <span class="token punctuation">(</span><span class="token class-name">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token constant">FROM</span> <span class="token class-name">Order</span> o <span class="token class-name">WHERE</span> m <span class="token operator">=</span> o<span class="token punctuation">.</span>member<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span></code></pre></div>
<h3 id="서브쿼리-지원-함수" style="position:relative;"><a href="#%EC%84%9C%EB%B8%8C%EC%BF%BC%EB%A6%AC-%EC%A7%80%EC%9B%90-%ED%95%A8%EC%88%98" aria-label="서브쿼리 지원 함수 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>서브쿼리 지원 함수</h3>
<ul>
<li><code class="language-text">[NOT] EXISTS</code>
<ul>
<li>서브쿼리에 결과가 하나라도 있으면 true</li>
<li><code class="language-text">WHERE EXISTS (SELECT 1 FROM Team t WHERE t.name = 'teamA')</code>: <code class="language-text">t.name='teamA'</code>인 팀이 존재하면 true</li>
</ul>
</li>
<li><code class="language-text">ALL</code>
<ul>
<li>모든 조건을 만족해야 true</li>
<li><code class="language-text">WHERE m.age > ALL (SELECT m2.age FROM Member m2)</code>: <code class="language-text">m.age</code>가 전체 회원의 나이보다 커야 true</li>
</ul>
</li>
<li><code class="language-text">ANY</code>, <code class="language-text">SOME</code>
<ul>
<li>하나라도 조건을 만족해야 true</li>
<li><code class="language-text">WHERE m.age > ANY (SELECT m2.age FROM Member m2)</code>: <code class="language-text">m.age</code>가 전체 회원 중, 한 명의 나이보다 많을 경우 true</li>
</ul>
</li>
<li><code class="language-text">IN</code>
<ul>
<li>하나라도 같으면 true</li>
<li><code class="language-text">WHERE m.team IN (SELECT t FROM Team t WHERE t.name = 'teamA'</code>: teamA에 속한 회원을 필터링</li>
</ul>
</li>
<li>제약사항
<ul>
<li><code class="language-text">WHERE</code>, <code class="language-text">HAVING</code> 절에서만 사용 가능하다.</li>
<li><code class="language-text">SELECT</code>, <code class="language-text">FROM</code> 절에서 사용 불가하다. (하이버네이트는 <code class="language-text">SELECT</code> 절을 지원한다.)</li>
<li><code class="language-text">FROM</code> 절의 서브쿼리의 해결 방안은 다음과 같다.
<ol>
<li>서브쿼리를 Join으로 변경한다. (불가능한 상황이 있을 수 있다.)</li>
<li>애플리케이션에서 쿼리를 2번 분리해서 실행한다.</li>
<li>nativeSQL을 사용한다.</li>
</ol>
</li>
</ul>
</li>
</ul>
<h2 id="jpql-타입-표현" style="position:relative;"><a href="#jpql-%ED%83%80%EC%9E%85-%ED%91%9C%ED%98%84" aria-label="jpql 타입 표현 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JPQL 타입 표현</h2>
<ul>
<li>문자: 'HELLO', 'She''s'</li>
<li>숫자: 10L(Long), 10D(Double), 10F(Float)</li>
<li>Boolean: TRUE, FALSE (대소문자 구분 X)</li>
<li>ENUM: com.example.MemberType.Admin (패키지명 포함)</li>
<li>엔티티 타입
<ul>
<li>상속 관계 매핑에서 <code class="language-text">DTYPE</code> 칼럼을 조회할 때 사용한다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">em<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token string">"SELECT i FROM Item i WHERE TYPE(i) = Book"</span><span class="token punctuation">,</span> <span class="token class-name">Item</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
</li>
</ul>
<h2 id="조건식---case-식" style="position:relative;"><a href="#%EC%A1%B0%EA%B1%B4%EC%8B%9D---case-%EC%8B%9D" aria-label="조건식   case 식 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>조건식 - CASE 식</h2>
<h3 id="기본-case-식" style="position:relative;"><a href="#%EA%B8%B0%EB%B3%B8-case-%EC%8B%9D" aria-label="기본 case 식 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>기본 CASE 식</h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token constant">SELECT</span>
	<span class="token constant">CASE</span> <span class="token constant">WHEN</span> m<span class="token punctuation">.</span>age <span class="token operator">&lt;=</span> <span class="token number">10</span> then <span class="token char">'학생요금'</span>
		 <span class="token constant">WHEN</span> m<span class="token punctuation">.</span>age <span class="token operator">>=</span> <span class="token number">60</span> then <span class="token char">'경로요금'</span>
		 <span class="token keyword">else</span> <span class="token char">'일반요금'</span>
	<span class="token constant">END</span>
<span class="token constant">FROM</span> <span class="token class-name">Member</span> m</code></pre></div>
<h3 id="단순-case-식" style="position:relative;"><a href="#%EB%8B%A8%EC%88%9C-case-%EC%8B%9D" aria-label="단순 case 식 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단순 CASE 식</h3>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token constant">SELECT</span>
	<span class="token constant">CASE</span> t<span class="token punctuation">.</span>name
		<span class="token constant">WHEN</span> <span class="token char">'teamA'</span> <span class="token constant">THEN</span> '인센티브<span class="token number">110</span><span class="token operator">%</span>'
		<span class="token constant">WHEN</span> <span class="token char">'teamB'</span> <span class="token constant">THEN</span> '인센티브<span class="token number">120</span><span class="token operator">%</span>'
	<span class="token constant">END</span>
<span class="token constant">FROM</span> <span class="token class-name">Team</span> t</code></pre></div>
<h3 id="coalesce" style="position:relative;"><a href="#coalesce" aria-label="coalesce permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>COALESCE</h3>
<ul>
<li>하나씩 조회해서 <code class="language-text">null</code>이 아니면 반환한다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// m.username이 null이면 '이름 없는 회원'을 반환한다.</span>
<span class="token class-name">SELECT</span> <span class="token function">COALESCE</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>username<span class="token punctuation">,</span> '이름 없는 회원'<span class="token punctuation">)</span> <span class="token constant">FROM</span> <span class="token class-name">Member</span> m</code></pre></div>
<h3 id="nullif" style="position:relative;"><a href="#nullif" aria-label="nullif permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>NULLIF</h3>
<ul>
<li>두 값이 같으면 <code class="language-text">null</code>을 반환한다. 다르면 첫 번째 값을 반환한다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// m.username이 '관리자'이면 null을 반환하고, 나머지는 본인의 이름을 반환한다.</span>
<span class="token class-name">SELECT</span> <span class="token function">NULLIF</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token char">'관리자'</span><span class="token punctuation">)</span> <span class="token constant">FROM</span> <span class="token class-name">Member</span> m</code></pre></div>
<h2 id="jpql-기본-함수" style="position:relative;"><a href="#jpql-%EA%B8%B0%EB%B3%B8-%ED%95%A8%EC%88%98" aria-label="jpql 기본 함수 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JPQL 기본 함수</h2>
<ul>
<li>CONCAT, SUBSTRING, TRIM, LOWER, UPPER, LENGTH, LOCATE</li>
<li>ABS, SQRT, MOD</li>
<li>SIZE: 컬렉션의 사이즈를 반환한다.
<ul>
<li>예시 코드: <code class="language-text">SIZE(t.members)</code></li>
</ul>
</li>
</ul>
<h3 id="사용자-정의-함수-호출" style="position:relative;"><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C" aria-label="사용자 정의 함수 호출 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>사용자 정의 함수 호출</h3>
<ul>
<li>하이버네이트는 사용 전, 방언을 추가해야 한다.</li>
<li>사용하는 DB 방언을 상속받고, 사용자 정의 함수를 등록한다.
또한, 애플리케이션 프로퍼티에도 사용자 정의 함수를 등록해야 한다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// 사용하는 DB 방언 상속받고, 사용자 정의 함수 등록</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyH2Dialect</span> <span class="token keyword">extends</span> <span class="token class-name">H2Dialect</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token class-name">MyH2Dialect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">registerFunction</span><span class="token punctuation">(</span><span class="token string">"group_concat"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">StandardSQLFunction</span><span class="token punctuation">(</span><span class="token string">"group_concat"</span><span class="token punctuation">,</span> <span class="token class-name">StandardBasicTypes<span class="token punctuation">.</span>String</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// application.yml</span>
spring<span class="token operator">:</span>
	hibernate<span class="token operator">:</span>
		dialect<span class="token operator">:</span> <span class="token class-name">MyH2Dialect</span>

<span class="token comment">// 사용자 정의 함수 호출</span>
<span class="token class-name">SELECT</span> <span class="token function">FUNCTION</span><span class="token punctuation">(</span>'group_concat'<span class="token punctuation">,</span> m<span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token constant">FROM</span> <span class="token class-name">Member</span> m

<span class="token comment">// Hibernate</span>
<span class="token class-name">SELECT</span> <span class="token function">group_concat</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token constant">FROM</span> <span class="token class-name">Member</span> m</code></pre></div>
<h2 id="경로-표현식" style="position:relative;"><a href="#%EA%B2%BD%EB%A1%9C-%ED%91%9C%ED%98%84%EC%8B%9D" aria-label="경로 표현식 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>경로 표현식</h2>
<ul>
<li><code class="language-text">.</code> 으로 객체 그래프를 탐색하는 것이다.</li>
<li>경로 표현식에는 세 가지 방식이 있다.
상태 필드, 단일 값 연관 필드, 컬렉션 값 연관 필드
각 방식에 따라서 내부적으로 동작이 달라진다.</li>
<li>기본 형식 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token constant">SELECT</span> m<span class="token punctuation">.</span>username <span class="token comment">// 상태 필드</span>
<span class="token constant">FROM</span> <span class="token class-name">Member</span> m
<span class="token constant">JOIN</span> m<span class="token punctuation">.</span>team t <span class="token comment">// 단일 값 연관 필드</span>
<span class="token constant">JOIN</span> m<span class="token punctuation">.</span>orders o <span class="token comment">// 컬렉션 값 연관 필드</span>
<span class="token constant">WHERE</span> t<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token char">'teamA'</span></code></pre></div>
<h3 id="상태-필드" style="position:relative;"><a href="#%EC%83%81%ED%83%9C-%ED%95%84%EB%93%9C" aria-label="상태 필드 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>상태 필드</h3>
<ul>
<li>단순히 값을 저장하기 위한 필드다.</li>
</ul>
<h3 id="단일-값-연관-필드" style="position:relative;"><a href="#%EB%8B%A8%EC%9D%BC-%EA%B0%92-%EC%97%B0%EA%B4%80-%ED%95%84%EB%93%9C" aria-label="단일 값 연관 필드 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>단일 값 연관 필드</h3>
<ul>
<li>연관관계를 위한 필드이며, 대상이 엔티티인 경우다.
(예: <code class="language-text">m.team</code>)</li>
<li><strong>묵시적 내부 조인(<code class="language-text">INNER JOIN</code>) 발생</strong>한다.
=> JOIN을 명시적으로 JPQL에 드러내야 한다.</li>
<li>추가적인 그래프 탐색이 가능하다.</li>
</ul>
<h3 id="컬렉션-값-연관-필드" style="position:relative;"><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%EC%97%B0%EA%B4%80-%ED%95%84%EB%93%9C" aria-label="컬렉션 값 연관 필드 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컬렉션 값 연관 필드</h3>
<ul>
<li>연관관계를 위한 필드이며, 대상이 컬렉션인 경우다.
(예: <code class="language-text">m.orders</code>)</li>
<li><strong>묵시적 내부 조인(<code class="language-text">INNER JOIN</code>) 발생</strong>
<code class="language-text">JOIN</code>은 성능에 큰 영향을 미치기 때문에, 숨기는 것보단 드러내는 것이 좋다.
따라서, JPQL에 JOIN을 명시적으로 드러내는 것이 권장된다.
<ul>
<li>명시적 <code class="language-text">JOIN</code> 예시: <code class="language-text">SELECT m FROM Team t JOIN t.members m</code></li>
</ul>
</li>
<li><strong>추가적인 그래프 탐색이 불가</strong>하다.
컬렉션 중, 어떤 요소를 기준으로 탐색해야 하는 지 애매하기 때문이다.</li>
</ul>
<h2 id="fetch-join" style="position:relative;"><a href="#fetch-join" aria-label="fetch join permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><strong>Fetch Join</strong></h2>
<ul>
<li>SQL JOIN 종류가 아니다.</li>
<li>JPQL에서 성능 최적화를 위한 기능으로, 연관 엔티티나 컬렉션을 하나의 SQL에 함께 조회하는 기능이다.</li>
<li>일반 <code class="language-text">JOIN</code>과 차이점은, <code class="language-text">SELECT</code> 절에 가져오려는 엔티티를 함께 조회해온다.</li>
<li><code class="language-text">join fetch</code> 키워드를 사용한다.
<ul>
<li>문법: <code class="language-text">[LEFT [OUTER] | INNER] JOIN FETCH</code></li>
</ul>
</li>
</ul>
<h3 id="컬렉션-fetch-join" style="position:relative;"><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-fetch-join" aria-label="컬렉션 fetch join permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>컬렉션 Fetch Join</h3>
<ul>
<li>일대다 관계일 때, Fetch JOIN을 하는 경우다.</li>
<li><strong>중복된 엔티티가 조회될 수 있다는 점</strong>을 조심해야 한다.
DB 관점에서 봤을 때 일대다 관계에서 <code class="language-text">JOIN</code>을 하면, "다" 쪽의 테이블에서 외래키를 가지는 ROW의 개수(N)만큼 조회 ROW가 존재한다.
이때, JPQL을 통해 "일" 쪽의 Entity를 조회하면 N개 만큼의 중복된 Entity가 조회된다.
따라서, [[#DISTINCT]] 키워드로 중복을 제거해야 한다.</li>
</ul>
<h3 id="distinct" style="position:relative;"><a href="#distinct" aria-label="distinct permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DISTINCT</h3>
<ul>
<li>JPA의 <code class="language-text">DISTINCT</code>는 두 가지 기능을 제공한다.
<ol>
<li>SQL에 <code class="language-text">DISTINCT</code> 추가</li>
<li>영속성 컨텍스트에서 중복된 Entity 제거</li>
</ol>
</li>
<li>Entity 앞에 <code class="language-text">DISTINCT</code> 키워드를 추가한다.</li>
</ul>
<h3 id="fetch-join의-한계" style="position:relative;"><a href="#fetch-join%EC%9D%98-%ED%95%9C%EA%B3%84" aria-label="fetch join의 한계 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fetch Join의 한계</h3>
<ul>
<li>
<p><strong>Fetch Join 대상 Entity에는 별칭을 줄 수 없다.</strong>
Hibernate에서는 가능하지만 가급적 사용하지 않는 것이 좋다.
왜냐하면, 별칭을 추가하면 별칭을 이용해서 객체 그래프를 추가적으로 탐색할 수 있게 된다.
하지만 JPA를 설계할 때부터 [[#컬렉션 값 연관 필드]]를 가져올 때 <strong>전부 가져오는 것</strong>으로 설계되어 있다.
만약, 조건절을 걸어서 일부만 가져온다면 [[#컬렉션 값 연관 필드]]에는 [[#영속성 전이 CASCADE|영속성 전이]]나 [[#고아 객체]]를 설정하면 안된다.
하지만 실무에서 이를 신경쓰면서 개발하기에는 너무 피로도가 크다.
따라서, 추가하지 않는 것이 좋다.
다만, 객체 그래프를 여러 Depth에 걸쳐서 Fetch Join을 할 때에만 사용할 수 있다.</p>
</li>
<li>
<p><strong>둘 이상의 컬렉션은 Fetch Join 할 수 없다.</strong>
시도하면 <code class="language-text">MultipleBagFetchException</code> 예외가 발생한다.
사실 가능은 하지만 [[카테시안 곱]]이 발생해서 데이터 뷰가 급격히 증가하고, 어떤 Entity를 조회해야 하는 지 구분할 수가 없다.</p>
<p>이를 해결하기 위해, 하나만 Fetch Join을 하고 나머지는 <code class="language-text">@BatchSize</code>를 적용하는 방법이 있다.
또는 애플리케이션 프로퍼티에 <code class="language-text">hibernate.default_batch_fetch_size</code> 값을 보통 100~1000 사이 값으로 설정한다. 이럴 경우 두 컬렉션에 모두 <code class="language-text">@BatchSize</code>를 적용한 것과 동일하게 동작한다.
실무에서는 이 방법을 기본으로 깔고 한다고 한다.</p>
<p><code class="language-text">@BatchSize</code>는 지연 로딩 시, N+1 문제를 해결하기 위해 엔티티 컬렉션을 한 번에 조회하는 기법이다.
<code class="language-text">@BatchSize</code>를 적용하면, 각 컬렉션을 조회할 때 <code class="language-text">IN</code> 쿼리로 설정한 크기만큼 묶어서 조회해온다.
Fetch Join과의 차이점으로는, Fetch Join은 <code class="language-text">SELECT</code> 쿼리에 대상 엔티티 컬렉션을 <strong>한꺼번에 모두 조회</strong>한다는 점이고, <code class="language-text">@BatchSize</code>는 대상 엔티티 컬렉션을 따로 <code class="language-text">IN</code> 쿼리를 날려서 일정 크기만큼 조회해온다는 점이다.
<code class="language-text">@BatchSize</code>를 사용하면 페이징 API도 사용할 수 있다.</p>
</li>
<li>
<p><strong>컬렉션을 Fetch Join 하면 페이징 API를 사용할 수 없다.</strong>
일대일, 다대일 같은 연관관계 매핑은 Fetch Join 해도 페이징이 가능하다.
하지만, 일대다 연관관계 매핑은 DB 관점에서 <code class="language-text">JOIN</code> 시에 데이터가 뻥튀기가 되고, 그 결과에 페이징을 하면 데이터 정합성이 맞지 않을 수 있다.</p>
</li>
</ul>
<h2 id="다형성-쿼리" style="position:relative;"><a href="#%EB%8B%A4%ED%98%95%EC%84%B1-%EC%BF%BC%EB%A6%AC" aria-label="다형성 쿼리 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>다형성 쿼리</h2>
<ul>
<li><code class="language-text">TREAT</code>
<ul>
<li>Java의 다운 캐스팅과 유사하다.</li>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// JPQL</span>
<span class="token constant">SELECT</span> i <span class="token constant">FROM</span> <span class="token class-name">Item</span> i
<span class="token class-name">WHERE</span> <span class="token function">TREAT</span><span class="token punctuation">(</span>i as <span class="token class-name">Book</span><span class="token punctuation">)</span><span class="token punctuation">.</span>auther <span class="token operator">=</span> <span class="token char">'kim'</span>

<span class="token comment">// SQL</span>
<span class="token constant">SELECT</span> i<span class="token punctuation">.</span>* <span class="token constant">FROM</span> item i
<span class="token constant">WHERE</span> i<span class="token punctuation">.</span>dtype<span class="token operator">=</span><span class="token char">'B'</span> and i<span class="token punctuation">.</span>author <span class="token operator">=</span> <span class="token char">'kim'</span></code></pre></div>
</li>
</ul>
<h2 id="엔티티-직접-사용" style="position:relative;"><a href="#%EC%97%94%ED%8B%B0%ED%8B%B0-%EC%A7%81%EC%A0%91-%EC%82%AC%EC%9A%A9" aria-label="엔티티 직접 사용 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>엔티티 직접 사용</h2>
<ul>
<li><strong>JPQL에서 엔티티를 직접 사용하면 SQL에서는 엔티티의 기본키 값을 사용</strong>한다.</li>
<li>엔티티를 파라미터 바인딩으로 전달해도 똑같이 SQL에 기본키 값을 사용한다.</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// JPQL</span>
<span class="token class-name">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token constant">FROM</span> <span class="token class-name">Member</span> m

<span class="token comment">// SQL</span>
<span class="token class-name">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>id<span class="token punctuation">)</span> as count <span class="token constant">FROM</span> member m</code></pre></div>
<h2 id="named-쿼리" style="position:relative;"><a href="#named-%EC%BF%BC%EB%A6%AC" aria-label="named 쿼리 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Named 쿼리</h2>
<p>엔티티에 미리 JPQL을 작성해두고 이름을 부여한 다음, <code class="language-text">em.createQuery()</code>에서 이름을 사용하는 방식이다.</p>
<p>정적 쿼리만 작성 가능하다는 특징이 있다.
덕분에, <strong>애플리케이션 로딩 시점에 SQL을 초기화</strong>할 수 있게 되고, 그 과정에서 <strong>JPQL에 필드명이 다른 문제도 잡아낼 수 있다</strong>.
또한, <strong>SQL 초기화 후 캐싱해서 재사용</strong>한다는 장점이 있다.</p>
<ul>
<li>예제 코드</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token comment">// 엔티티</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@NamedQuery</span><span class="token punctuation">(</span>
	name <span class="token operator">=</span> <span class="token string">"Member.findByUsername"</span><span class="token punctuation">,</span>
	query <span class="token operator">=</span> <span class="token string">"SELECT m FROM Member m WHERE m.username = :username"</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Member</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token comment">// Named 쿼리 사용</span>
em<span class="token punctuation">.</span><span class="token function">createNamedQuery</span><span class="token punctuation">(</span><span class="token string">"Member.findByUsername"</span><span class="token punctuation">,</span> <span class="token class-name">Member</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token string">"회원1"</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">getResultList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="벌크-연산" style="position:relative;"><a href="#%EB%B2%8C%ED%81%AC-%EC%97%B0%EC%82%B0" aria-label="벌크 연산 permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>벌크 연산</h2>
<ul>
<li>JPA의 [[#Dirty Checking]]을 이용해서 <code class="language-text">UPDATE</code> 쿼리를 날리려면 각 ROW마다 쿼리가 하나씩 나간다.</li>
<li>이러한 성능 이슈를 최적화하기 위해 <strong>하나의 쿼리로 여러 ROW를 <code class="language-text">UPDATE</code> 또는 <code class="language-text">DELETE</code>  해주는 기능</strong>이다.</li>
<li><code class="language-text">executeUpdate()</code>를 실행하면 된다.</li>
</ul>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java"><span class="token class-name">String</span> jpql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
	UPDATE Product p
	SET p.price = p.price * 1.1
	WHERE p.stockAmount &lt; :stockAmount
"""</span>

<span class="token keyword">int</span> resultCount <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>jpql<span class="token punctuation">)</span>
					<span class="token punctuation">.</span><span class="token function">setParameter</span><span class="token punctuation">(</span><span class="token string">"stockAmount"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
					<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 벌크 연산 수행</span></code></pre></div>
<ul>
<li>하이버네이트의 경우에는 <code class="language-text">INSERT INTO ... SELECT</code> 문도 지원한다.
<ul>
<li><code class="language-text">INSERT INTO ... SELECT</code>: 특정 테이블의 ROW 전부 또는 일부를 다른 테이블로 복사하는 데 사용하는 쿼리</li>
</ul>
</li>
<li>주의해야 할 점
<ul>
<li>벌크 연산은 <strong>영속성 컨텍스트를 무시하고 DB에 직접 쿼리</strong>한다.
이를 해결하기 위해 벌크 연산을 먼저 수행하거나, <strong>벌크 연산을 수행한 뒤 영속성 컨텍스트를 초기화</strong>하는 방법으로 정합성 문제를 해결할 수 있다.</li>
</ul>
</li>
</ul>
<h1 id="references" style="position:relative;"><a href="#references" aria-label="references permalink" class="anchor-header before" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" height="20" version="1.1" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.65 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>References</h1>
<ul>
<li><a href="https://hibernate.org/" target="_blank" rel="noopener noreferrer">Hibernate</a></li>
<li><a href="https://inf.run/SmpwH" target="_blank" rel="noopener noreferrer">인프런, 자바 ORM 표준 JPA 프로그래밍 - 기본편</a></li>
</ul></section><hr class="blog-post-module--postDivider--aa8ca"/></article><nav class="blog-post-module--blogPostNav--d05de"><ul><li><a rel="이전 글" href="/posts/weekly-contest-488/">LeetCode Weekly Contest 488 후기</a></li><li><a rel="다음 글" href="/posts/react-ec2-s3-cloudfront/">React.js 배포 방식을 EC2에서 S3와 CloudFront로 변경한 이유</a></li></ul></nav></div><button type="button" class="toc-module--mobileTocButton--56883" aria-haspopup="dialog" aria-expanded="false" aria-controls="mobile-toc-sheet">목차</button><button type="button" class="toc-module--mobileTocBackdrop--a19ba " aria-label="목차 닫기"></button><aside id="mobile-toc-sheet" class="toc-module--tocContainer--ffa0b "><div class="toc-module--tocHeader--b1f84"><h3 class="toc-module--tocTitle--0befc">목차</h3><button type="button" class="toc-module--mobileCloseButton--e0810" aria-label="목차 닫기">닫기</button></div><div class="toc-module--tocProgress--b5e48" aria-hidden="true"><span class="toc-module--tocProgressFill--48e0b" style="width:0%"></span></div><div class="toc-module--tocContent--d6318"><ul>
<li>
<p><a href="#1-jpa-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0-%EC%99%9C-%EA%B0%9D%EC%B2%B4-%EC%A4%91%EC%8B%AC-%EA%B0%9C%EB%B0%9C%EC%9D%B8%EA%B0%80">1. JPA 시작하기: 왜 객체 중심 개발인가?</a></p>
<ul>
<li><a href="#jpa%EB%A5%BC-%EC%8D%A8%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0">JPA를 써야 하는 이유</a></li>
<li><a href="#jpa%EC%9D%98-%EB%91%90-%EA%B0%80%EC%A7%80-%ED%95%B5%EC%8B%AC">JPA의 두 가지 핵심</a></li>
</ul>
</li>
<li>
<p><a href="#2-%EB%82%B4%EB%B6%80-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D%EC%98%81%EC%86%8D%EC%84%B1-%EA%B4%80%EB%A6%AC">2. 내부 동작 방식(영속성 관리)</a></p>
<ul>
<li>
<p><a href="#entitymanagerfactory%EC%99%80-entitymanager">EntityManagerFactory와 EntityManager</a></p>
</li>
<li>
<p><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8">영속성 컨텍스트</a></p>
</li>
<li>
<p><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8%EC%9D%98-%ED%8A%B9%EC%A7%95">영속성 컨텍스트의 특징</a></p>
<ul>
<li><a href="#1%EC%B0%A8-%EC%BA%90%EC%8B%9C">1차 캐시</a></li>
<li><a href="#%EB%8F%99%EC%9D%BC%EC%84%B1-%EB%B3%B4%EC%9E%A5">동일성 보장</a></li>
<li><a href="#%EC%93%B0%EA%B8%B0-%EC%A7%80%EC%97%B0">쓰기 지연</a></li>
<li><a href="#dirty-checking-%EB%B3%80%EA%B2%BD-%EA%B0%90%EC%A7%80">Dirty Checking (변경 감지)</a></li>
<li><a href="#lazy-loading">Lazy Loading</a></li>
</ul>
</li>
<li>
<p><a href="#%ED%94%8C%EB%9F%AC%EC%8B%9C">플러시</a></p>
</li>
<li>
<p><a href="#entity">Entity</a></p>
</li>
<li>
<p><a href="#entity%EC%9D%98-%EC%83%9D%EB%AA%85%EC%A3%BC%EA%B8%B0">Entity의 생명주기</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#3-entity-%EB%A7%A4%ED%95%91">3. Entity 매핑</a></p>
<ul>
<li><a href="#%EA%B8%B0%EB%B3%B8-%EB%A7%A4%ED%95%91-%EC%96%B4%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98">기본 매핑 어노테이션</a></li>
<li><a href="#db-schema-%EC%9E%90%EB%8F%99-%EC%83%9D%EC%84%B1">DB Schema 자동 생성</a></li>
<li><a href="#%ED%95%84%EB%93%9C%EC%99%80-%EC%B9%BC%EB%9F%BC-%EB%A7%A4%ED%95%91">필드와 칼럼 매핑</a></li>
<li><a href="#%EA%B8%B0%EB%B3%B8-%ED%82%A4-%EB%A7%A4%ED%95%91">기본 키 매핑</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91"><strong>연관관계 매핑</strong></a></p>
<ul>
<li>
<p><a href="#%EB%8B%A8%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84">단방향 연관관계</a></p>
</li>
<li>
<p><a href="#%EC%96%91%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84">양방향 연관관계</a></p>
<ul>
<li><a href="#%EC%96%91%EB%B0%A9%ED%96%A5-%EB%A7%A4%ED%95%91-%EC%8B%9C-%EC%8B%A0%EA%B2%BD%EC%8D%A8%EC%95%BC-%ED%95%A0-%EA%B2%83-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%ED%8E%B8%EC%9D%98-%EB%A9%94%EC%84%9C%EB%93%9C-%EC%88%9C%ED%99%98-%EC%B0%B8%EC%A1%B0-%EB%AC%B8%EC%A0%9C">양방향 매핑 시 신경써야 할 것: 연관관계 편의 메서드, 순환 참조 문제</a></li>
<li><a href="#%EB%8B%A8%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84%EC%99%80-%EC%96%91%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EC%A4%91-%EC%96%B4%EB%8A%90-%EA%B2%83%EC%9D%84-%ED%95%98%EB%82%98">단방향 연관관계와 양방향 연관관계 중 어느 것을 하나?</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%9D%BC%EB%8C%80%EB%8B%A4-%EB%8B%A8%EB%B0%A9%ED%96%A5-dcdba0">일대다 단방향 ^dcdba0</a></p>
</li>
<li>
<p><a href="#%EC%9D%BC%EB%8C%80%EB%8B%A4-%EC%96%91%EB%B0%A9%ED%96%A5">일대다 양방향</a></p>
</li>
<li>
<p><a href="#%EC%9D%BC%EB%8C%80%EC%9D%BC-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84">일대일 연관관계</a></p>
<ul>
<li><a href="#%EB%8B%A8%EB%B0%A9%ED%96%A5">단방향</a></li>
<li><a href="#%EC%96%91%EB%B0%A9%ED%96%A5">양방향</a></li>
<li><a href="#%EB%8C%80%EC%83%81-%ED%85%8C%EC%9D%B4%EB%B8%94%EC%97%90-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EC%A3%BC%EC%9D%B8-%EC%84%A4%EC%A0%95">대상 테이블에 연관관계 주인 설정</a></li>
</ul>
</li>
<li>
<p><a href="#%EB%8B%A4%EB%8C%80%EB%8B%A4-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84">다대다 연관관계</a></p>
</li>
<li>
<p><a href="#%EC%83%81%EC%86%8D%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91">상속관계 매핑</a></p>
<ul>
<li><a href="#%EC%A1%B0%EC%9D%B8-%EC%A0%84%EB%9E%B5">조인 전략</a></li>
<li><a href="#%EB%8B%A8%EC%9D%BC-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%A0%84%EB%9E%B5">단일 테이블 전략</a></li>
<li><a href="#%EA%B5%AC%ED%98%84-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A7%88%EB%8B%A4-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%A0%84%EB%9E%B5">구현 클래스마다 테이블 전략</a></li>
<li><a href="#%EC%A0%84%EB%9E%B5-%EC%84%A0%ED%83%9D-%EA%B8%B0%EC%A4%80">전략 선택 기준</a></li>
</ul>
</li>
<li>
<p><a href="#mappedsuperclass"><code class="language-text">@MappedSuperclass</code></a></p>
<ul>
<li><a href="#%EB%B6%80%EB%AA%A8-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EC%86%8D%EC%84%B1-%EC%9E%AC%EC%A0%95%EC%9D%98">부모 클래스의 속성 재정의</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="#%ED%94%84%EB%A1%9D%EC%8B%9C%EC%99%80-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EA%B4%80%EB%A6%AC"><strong>프록시와 연관관계 관리</strong></a></p>
<ul>
<li>
<p><a href="#emfind%EC%99%80-emgetreference"><code class="language-text">em.find()</code>와 <code class="language-text">em.getReference()</code></a></p>
</li>
<li>
<p><a href="#%EC%A7%80%EC%97%B0-%EB%A1%9C%EB%94%A9">지연 로딩</a></p>
</li>
<li>
<p><a href="#%ED%94%84%EB%A1%9D%EC%8B%9C-%EA%B0%9D%EC%B2%B4">프록시 객체</a></p>
<ul>
<li><a href="#%EA%B4%80%EB%A0%A8-%EC%9C%A0%ED%8B%B8%EC%84%B1-%EB%A9%94%EC%84%9C%EB%93%9C">관련 유틸성 메서드</a></li>
</ul>
</li>
<li>
<p><a href="#%EC%A6%89%EC%8B%9C-%EB%A1%9C%EB%94%A9">즉시 로딩</a></p>
</li>
<li>
<p><a href="#%EC%8B%A4%EB%AC%B4%EC%97%90%EC%84%9C-%EC%A6%89%EC%8B%9C-%EB%A1%9C%EB%94%A9-%EC%A7%80%EC%97%B0-%EB%A1%9C%EB%94%A9">실무에서 즉시 로딩? 지연 로딩?</a></p>
</li>
<li>
<p><a href="#n1-%EB%AC%B8%EC%A0%9C">N+1 문제</a></p>
</li>
<li>
<p><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%A0%84%EC%9D%B4-cascade">영속성 전이: CASCADE</a></p>
</li>
<li>
<p><a href="#%EA%B3%A0%EC%95%84-%EA%B0%9D%EC%B2%B4">고아 객체</a></p>
</li>
<li>
<p><a href="#%EC%98%81%EC%86%8D%EC%84%B1-%EC%A0%84%EC%9D%B4--%EA%B3%A0%EC%95%84-%EA%B0%9D%EC%B2%B4">영속성 전이 + 고아 객체</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#%EA%B0%92-%ED%83%80%EC%9E%85">값 타입</a></p>
<ul>
<li>
<p><a href="#%EC%97%94%ED%8B%B0%ED%8B%B0-%ED%83%80%EC%9E%85">엔티티 타입</a></p>
</li>
<li>
<p><a href="#%EA%B0%92-%ED%83%80%EC%9E%85-1">값 타입</a></p>
</li>
<li>
<p><a href="#%EA%B0%92-%ED%83%80%EC%9E%85%EC%9D%98-%EC%A2%85%EB%A5%98">값 타입의 종류</a></p>
<ul>
<li><a href="#%EA%B8%B0%EB%B3%B8%EA%B0%92-%ED%83%80%EC%9E%85">기본값 타입</a></li>
<li><a href="#%EC%9E%84%EB%B2%A0%EB%94%94%EB%93%9C-%ED%83%80%EC%9E%85">임베디드 타입</a></li>
<li><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%ED%83%80%EC%9E%85">컬렉션 값 타입</a></li>
<li><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%ED%83%80%EC%9E%85%EC%9D%98-%EC%A0%9C%EC%95%BD%EC%82%AC%ED%95%AD">컬렉션 값 타입의 제약사항</a></li>
<li><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%ED%83%80%EC%9E%85-%EC%82%AC%EC%9A%A9-%EC%8B%9C%EC%A0%90">컬렉션 값 타입 사용 시점</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="#jpql">JPQL</a></p>
<ul>
<li>
<p><a href="#%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98">프로젝션</a></p>
<ul>
<li><a href="#%EC%97%94%ED%8B%B0%ED%8B%B0-%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98">엔티티 프로젝션</a></li>
<li><a href="#%EC%9E%84%EB%B2%A0%EB%94%94%EB%93%9C-%ED%83%80%EC%9E%85-%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98">임베디드 타입 프로젝션</a></li>
<li><a href="#%EA%B8%B0%EB%B3%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85-%ED%94%84%EB%A1%9C%EC%A0%9D%EC%85%98">기본 데이터 타입 프로젝션</a></li>
</ul>
</li>
<li>
<p><a href="#%ED%8E%98%EC%9D%B4%EC%A7%95">페이징</a></p>
</li>
<li>
<p><a href="#%EC%A1%B0%EC%9D%B8">조인</a></p>
</li>
<li>
<p><a href="#%EC%84%9C%EB%B8%8C-%EC%BF%BC%EB%A6%AC">서브 쿼리</a></p>
<ul>
<li><a href="#%EC%84%9C%EB%B8%8C%EC%BF%BC%EB%A6%AC-%EC%A7%80%EC%9B%90-%ED%95%A8%EC%88%98">서브쿼리 지원 함수</a></li>
</ul>
</li>
<li>
<p><a href="#jpql-%ED%83%80%EC%9E%85-%ED%91%9C%ED%98%84">JPQL 타입 표현</a></p>
</li>
<li>
<p><a href="#%EC%A1%B0%EA%B1%B4%EC%8B%9D---case-%EC%8B%9D">조건식 - CASE 식</a></p>
<ul>
<li><a href="#%EA%B8%B0%EB%B3%B8-case-%EC%8B%9D">기본 CASE 식</a></li>
<li><a href="#%EB%8B%A8%EC%88%9C-case-%EC%8B%9D">단순 CASE 식</a></li>
<li><a href="#coalesce">COALESCE</a></li>
<li><a href="#nullif">NULLIF</a></li>
</ul>
</li>
<li>
<p><a href="#jpql-%EA%B8%B0%EB%B3%B8-%ED%95%A8%EC%88%98">JPQL 기본 함수</a></p>
<ul>
<li><a href="#%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%A0%95%EC%9D%98-%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C">사용자 정의 함수 호출</a></li>
</ul>
</li>
<li>
<p><a href="#%EA%B2%BD%EB%A1%9C-%ED%91%9C%ED%98%84%EC%8B%9D">경로 표현식</a></p>
<ul>
<li><a href="#%EC%83%81%ED%83%9C-%ED%95%84%EB%93%9C">상태 필드</a></li>
<li><a href="#%EB%8B%A8%EC%9D%BC-%EA%B0%92-%EC%97%B0%EA%B4%80-%ED%95%84%EB%93%9C">단일 값 연관 필드</a></li>
<li><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B0%92-%EC%97%B0%EA%B4%80-%ED%95%84%EB%93%9C">컬렉션 값 연관 필드</a></li>
</ul>
</li>
<li>
<p><a href="#fetch-join"><strong>Fetch Join</strong></a></p>
<ul>
<li><a href="#%EC%BB%AC%EB%A0%89%EC%85%98-fetch-join">컬렉션 Fetch Join</a></li>
<li><a href="#distinct">DISTINCT</a></li>
<li><a href="#fetch-join%EC%9D%98-%ED%95%9C%EA%B3%84">Fetch Join의 한계</a></li>
</ul>
</li>
<li>
<p><a href="#%EB%8B%A4%ED%98%95%EC%84%B1-%EC%BF%BC%EB%A6%AC">다형성 쿼리</a></p>
</li>
<li>
<p><a href="#%EC%97%94%ED%8B%B0%ED%8B%B0-%EC%A7%81%EC%A0%91-%EC%82%AC%EC%9A%A9">엔티티 직접 사용</a></p>
</li>
<li>
<p><a href="#named-%EC%BF%BC%EB%A6%AC">Named 쿼리</a></p>
</li>
<li>
<p><a href="#%EB%B2%8C%ED%81%AC-%EC%97%B0%EC%82%B0">벌크 연산</a></p>
</li>
</ul>
</li>
<li>
<p><a href="#references">References</a></p>
</li>
</ul></div></aside></div><div class="blog-post-module--toast--c08b7 " role="status" aria-live="polite"></div></main></div><footer class="layout-module--siteFooter--80c5d">© <!-- -->2026<!-- --> kdkdhoho. Built with<!-- --> <a href="https://www.gatsbyjs.com" class="layout-module--siteFooterLink--72b70">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/jpa/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-49138abf3b7e6d7a2a32.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-ba52f6d2b7404e2dda4d.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-126a788a37bbf4851627.js\"],\"component---src-pages-search-js\":[\"/component---src-pages-search-js-d8dfd38aa4b8658e619d.js\"],\"component---src-templates-blog-post-js\":[\"/component---src-templates-blog-post-js-bda21d2a1417e6a1727c.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="7bdfe4a7849f741c8799";</script><script src="/webpack-runtime-8b80c4bac80ee1e3330d.js" async></script><script src="/framework-647153102893cffe9a5c.js" async></script><script src="/app-49138abf3b7e6d7a2a32.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>