{"version":3,"file":"component---src-templates-blog-post-js-bd2a4e098b68a5d0b451.js","mappings":"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","sources":["webpack://gatsby-starter-blog/./src/components/toc.module.css","webpack://gatsby-starter-blog/./src/components/toc.js","webpack://gatsby-starter-blog/./src/templates/blog-post.js","webpack://gatsby-starter-blog/./src/templates/blog-post.module.css"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport var active = \"toc-module--active--399c5\";\nexport var mobileCloseButton = \"toc-module--mobileCloseButton--e0810\";\nexport var mobileOpen = \"toc-module--mobileOpen--ceec0\";\nexport var mobileTocBackdrop = \"toc-module--mobileTocBackdrop--a19ba\";\nexport var mobileTocButton = \"toc-module--mobileTocButton--56883\";\nexport var mobileVisible = \"toc-module--mobileVisible--a82c0\";\nexport var tocContainer = \"toc-module--tocContainer--ffa0b\";\nexport var tocContent = \"toc-module--tocContent--d6318\";\nexport var tocHeader = \"toc-module--tocHeader--b1f84\";\nexport var tocProgress = \"toc-module--tocProgress--b5e48\";\nexport var tocProgressFill = \"toc-module--tocProgressFill--48e0b\";\nexport var tocTitle = \"toc-module--tocTitle--0befc\";","import React, { useCallback, useEffect, useMemo, useState } from \"react\"\nimport * as styles from \"./toc.module.css\"\n\nconst TableOfContents = ({ tableOfContents }) => {\n  const [activeId, setActiveId] = useState(\"\")\n  const [headings, setHeadings] = useState([])\n  const [isMobileTocOpen, setIsMobileTocOpen] = useState(false)\n\n  const extractTocIds = useCallback(tocHtml => {\n    if (!tocHtml) return []\n\n    const tempDiv = document.createElement(\"div\")\n    tempDiv.innerHTML = tocHtml\n    const links = tempDiv.querySelectorAll('a[href^=\"#\"]')\n\n    return Array.from(links)\n      .map(link => {\n        const href = link.getAttribute(\"href\")\n        if (!href) return null\n        const encodedId = href.substring(1)\n\n        try {\n          return { encoded: encodedId, decoded: decodeURIComponent(encodedId) }\n        } catch {\n          return { encoded: encodedId, decoded: encodedId }\n        }\n      })\n      .filter(Boolean)\n  }, [])\n\n  useEffect(() => {\n    if (!tableOfContents) return\n\n    const findHeadings = () => {\n      const tocIdObjects = extractTocIds(tableOfContents)\n      const contentHeadings = Array.from(\n        document.querySelectorAll(\".blog-post-content h1, .blog-post-content h2, .blog-post-content h3, .blog-post-content h4, .blog-post-content h5, .blog-post-content h6\")\n      ).filter(h => h.id)\n\n      const fromToc = tocIdObjects\n        .map(({ encoded, decoded }) => {\n          const element = document.getElementById(encoded) || document.getElementById(decoded)\n          return element && element.matches(\"h1, h2, h3, h4, h5, h6\") ? element : null\n        })\n        .filter(Boolean)\n\n      const mergedHeadings = Array.from(new Set([...fromToc, ...contentHeadings])).sort(\n        (a, b) => a.offsetTop - b.offsetTop\n      )\n\n      setHeadings(mergedHeadings)\n      if (mergedHeadings.length > 0) {\n        setActiveId(mergedHeadings[0].id)\n      }\n    }\n\n    const timer = setTimeout(findHeadings, 250)\n    return () => clearTimeout(timer)\n  }, [extractTocIds, tableOfContents])\n\n  useEffect(() => {\n    if (headings.length === 0) return\n\n    const handleScroll = () => {\n      const scrollY = window.pageYOffset\n      let current = headings[0]\n\n      for (let i = 0; i < headings.length; i += 1) {\n        const heading = headings[i]\n        const offsetTop = heading.getBoundingClientRect().top + scrollY\n        if (offsetTop <= scrollY + 140) {\n          current = heading\n        } else {\n          break\n        }\n      }\n\n      if (current?.id) {\n        setActiveId(prev => (current.id !== prev ? current.id : prev))\n      }\n    }\n\n    let ticking = false\n    const onScroll = () => {\n      if (ticking) return\n      ticking = true\n      requestAnimationFrame(() => {\n        handleScroll()\n        ticking = false\n      })\n    }\n\n    window.addEventListener(\"scroll\", onScroll, { passive: true })\n    window.addEventListener(\"resize\", onScroll, { passive: true })\n    handleScroll()\n\n    return () => {\n      window.removeEventListener(\"scroll\", onScroll)\n      window.removeEventListener(\"resize\", onScroll)\n    }\n  }, [headings])\n\n  const handleTocClick = useCallback(e => {\n    const anchor = e.target instanceof Element ? e.target.closest(\"a\") : null\n    if (!anchor) return\n\n    e.preventDefault()\n    const href = anchor.getAttribute(\"href\")\n    if (!href || !href.startsWith(\"#\")) return\n\n    const encodedId = href.substring(1)\n    let targetElement = document.getElementById(encodedId)\n\n    if (!targetElement) {\n      try {\n        targetElement = document.getElementById(decodeURIComponent(encodedId))\n      } catch {\n        targetElement = null\n      }\n    }\n\n    if (!targetElement) return\n\n    const offsetTop = targetElement.getBoundingClientRect().top + window.pageYOffset - 96\n    window.scrollTo({ top: offsetTop, behavior: \"smooth\" })\n    setActiveId(targetElement.id)\n    setIsMobileTocOpen(false)\n  }, [])\n\n  useEffect(() => {\n    if (!isMobileTocOpen) return undefined\n\n    const previousOverflow = document.body.style.overflow\n    document.body.style.overflow = \"hidden\"\n\n    const handleEscape = event => {\n      if (event.key === \"Escape\") {\n        setIsMobileTocOpen(false)\n      }\n    }\n\n    document.addEventListener(\"keydown\", handleEscape)\n\n    return () => {\n      document.body.style.overflow = previousOverflow\n      document.removeEventListener(\"keydown\", handleEscape)\n    }\n  }, [isMobileTocOpen])\n\n  useEffect(() => {\n    const mediaQuery = window.matchMedia(\"(max-width: 42rem)\")\n\n    const handleViewportChange = event => {\n      if (!event.matches) {\n        setIsMobileTocOpen(false)\n      }\n    }\n\n    if (mediaQuery.addEventListener) {\n      mediaQuery.addEventListener(\"change\", handleViewportChange)\n      return () => mediaQuery.removeEventListener(\"change\", handleViewportChange)\n    }\n\n    mediaQuery.addListener(handleViewportChange)\n    return () => mediaQuery.removeListener(handleViewportChange)\n  }, [])\n\n  const processedTableOfContents = useMemo(() => {\n    if (!tableOfContents) return tableOfContents\n    let processed = tableOfContents\n    processed = processed.replace(/\\s*class=\"[^\"]*active[^\"]*\"/g, \"\")\n    processed = processed.replace(/\\s*class=\"\"/g, \"\")\n\n    if (!activeId) return processed\n\n    try {\n      const encodedActiveId = encodeURIComponent(activeId).replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\")\n      const encodedRegex = new RegExp(`(<a[^>]*href=\"#${encodedActiveId}\"[^>]*)(>)`, \"g\")\n      if (encodedRegex.test(processed)) {\n        return processed.replace(encodedRegex, `$1 class=\"${styles.active}\"$2`)\n      }\n    } catch {}\n\n    const escapedId = activeId.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\")\n    const rawRegex = new RegExp(`(<a[^>]*href=\"#${escapedId}\"[^>]*)(>)`, \"g\")\n    return processed.replace(rawRegex, `$1 class=\"${styles.active}\"$2`)\n  }, [activeId, tableOfContents])\n\n  const progress = useMemo(() => {\n    if (headings.length === 0) return 0\n    const currentIndex = headings.findIndex(heading => heading.id === activeId)\n    const safeIndex = currentIndex < 0 ? 0 : currentIndex\n    return ((safeIndex + 1) / headings.length) * 100\n  }, [activeId, headings])\n\n  if (!tableOfContents?.trim()) return null\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        className={styles.mobileTocButton}\n        onClick={() => setIsMobileTocOpen(true)}\n        aria-haspopup=\"dialog\"\n        aria-expanded={isMobileTocOpen}\n        aria-controls=\"mobile-toc-sheet\"\n      >\n        목차\n      </button>\n\n      <button\n        type=\"button\"\n        className={`${styles.mobileTocBackdrop} ${isMobileTocOpen ? styles.mobileVisible : \"\"}`}\n        aria-label=\"목차 닫기\"\n        onClick={() => setIsMobileTocOpen(false)}\n      />\n\n      <aside\n        id=\"mobile-toc-sheet\"\n        className={`${styles.tocContainer} ${isMobileTocOpen ? styles.mobileOpen : \"\"}`}\n      >\n        <div className={styles.tocHeader}>\n          <h3 className={styles.tocTitle}>목차</h3>\n          <button\n            type=\"button\"\n            className={styles.mobileCloseButton}\n            onClick={() => setIsMobileTocOpen(false)}\n            aria-label=\"목차 닫기\"\n          >\n            닫기\n          </button>\n        </div>\n        <div className={styles.tocProgress} aria-hidden=\"true\">\n          <span className={styles.tocProgressFill} style={{ width: `${progress}%` }} />\n        </div>\n        <div\n          className={styles.tocContent}\n          onClick={handleTocClick}\n          dangerouslySetInnerHTML={{ __html: processedTableOfContents }}\n        />\n      </aside>\n    </>\n  )\n}\n\nexport default TableOfContents\n","import * as React from \"react\"\nimport { Link, graphql } from \"gatsby\"\n\nimport Layout from \"../components/layout\"\nimport Seo from \"../components/seo\"\nimport TableOfContents from \"../components/toc\"\nimport * as styles from \"./blog-post.module.css\"\n\nconst withNewTabLinks = html => {\n  if (!html) return html\n\n  return html.replace(/<a\\s+([^>]*href=(?:\"[^\"]*\"|'[^']*')[^>]*)>/gi, (match, attrs) => {\n    let nextAttrs = attrs\n\n    if (!/\\btarget\\s*=/i.test(nextAttrs)) {\n      nextAttrs = `${nextAttrs} target=\"_blank\"`\n    } else {\n      nextAttrs = nextAttrs.replace(/\\btarget\\s*=\\s*(['\"])[^'\"]*\\1/i, 'target=\"_blank\"')\n    }\n\n    if (!/\\brel\\s*=/i.test(nextAttrs)) {\n      nextAttrs = `${nextAttrs} rel=\"noopener noreferrer\"`\n    } else {\n      nextAttrs = nextAttrs.replace(/\\brel\\s*=\\s*(['\"])([^'\"]*)\\1/i, (relMatch, quote, value) => {\n        const tokens = value.split(/\\s+/).filter(Boolean)\n        if (!tokens.includes(\"noopener\")) tokens.push(\"noopener\")\n        if (!tokens.includes(\"noreferrer\")) tokens.push(\"noreferrer\")\n        return `rel=${quote}${tokens.join(\" \")}${quote}`\n      })\n    }\n\n    return `<a ${nextAttrs}>`\n  })\n}\n\nconst BlogPostTemplate = ({\n  data: { previous, next, site, markdownRemark: post },\n  location,\n}) => {\n  const siteTitle = site.siteMetadata?.title || `Title`\n  const postHtml = React.useMemo(() => withNewTabLinks(post.html), [post.html])\n  const [scrollProgress, setScrollProgress] = React.useState(0)\n\n  React.useEffect(() => {\n    const updateProgress = () => {\n      const scrollTop = window.pageYOffset\n      const docHeight = document.body.scrollHeight - window.innerHeight\n      const scrollPercent = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0\n      setScrollProgress(Math.min(100, Math.max(0, scrollPercent)))\n    }\n\n    window.addEventListener(\"scroll\", updateProgress, { passive: true })\n    window.addEventListener(\"resize\", updateProgress, { passive: true })\n    updateProgress()\n\n    return () => {\n      window.removeEventListener(\"scroll\", updateProgress)\n      window.removeEventListener(\"resize\", updateProgress)\n    }\n  }, [])\n\n  return (\n    <Layout location={location} title={siteTitle} variant=\"post\">\n      <div className={styles.scrollProgress} style={{ width: `${scrollProgress}%` }} aria-hidden=\"true\" />\n      <div className={styles.blogPostLayout}>\n        <div className={styles.blogPostContainer}>\n          <article\n            className={styles.blogPost}\n            itemScope\n            itemType=\"http://schema.org/Article\"\n          >\n            <header className={styles.blogPostHeader}>\n              <h1 className={styles.postTitle}>{post.frontmatter.title}</h1>\n              <time className={styles.postDate}>{post.frontmatter.date}</time>\n              {post.frontmatter.tags && post.frontmatter.tags.length > 0 && (\n                <div className={styles.tagsContainer}>\n                  {post.frontmatter.tags.map(tag => (\n                    <span key={tag} className={styles.tag}>\n                      #{tag}\n                    </span>\n                  ))}\n                </div>\n              )}\n            </header>\n            <section\n              className={`${styles.blogPostContent} blog-post-content`}\n              dangerouslySetInnerHTML={{ __html: postHtml }}\n              itemProp=\"articleBody\"\n            />\n            <hr className={styles.postDivider} />\n          </article>\n          <nav className={styles.blogPostNav}>\n            <ul>\n              <li>\n                {previous && (\n                  <Link to={previous.fields.slug} rel=\"이전 글\">\n                    {previous.frontmatter.title}\n                  </Link>\n                )}\n              </li>\n              <li>\n                {next && (\n                  <Link to={next.fields.slug} rel=\"다음 글\">\n                    {next.frontmatter.title}\n                  </Link>\n                )}\n              </li>\n            </ul>\n          </nav>\n        </div>\n        {post.tableOfContents && <TableOfContents tableOfContents={post.tableOfContents} />}\n      </div>\n    </Layout>\n  )\n}\n\nexport const Head = ({ data: { markdownRemark: post } }) => {\n  return (\n    <Seo\n      title={post.frontmatter.title}\n      description={post.frontmatter.description || post.excerpt}\n    />\n  )\n}\n\nexport default BlogPostTemplate\n\nexport const pageQuery = graphql`\n  query BlogPostBySlug(\n    $id: String!\n    $previousPostId: String\n    $nextPostId: String\n  ) {\n    site {\n      siteMetadata {\n        title\n      }\n    }\n    markdownRemark(id: { eq: $id }) {\n      id\n      excerpt(pruneLength: 160)\n      html\n      tableOfContents\n      frontmatter {\n        title\n        date(formatString: \"YYYY년 M월 D일\")\n        description\n        tags\n      }\n    }\n    previous: markdownRemark(id: { eq: $previousPostId }) {\n      fields {\n        slug\n      }\n      frontmatter {\n        title\n      }\n    }\n    next: markdownRemark(id: { eq: $nextPostId }) {\n      fields {\n        slug\n      }\n      frontmatter {\n        title\n      }\n    }\n  }\n`\n","// extracted by mini-css-extract-plugin\nexport var blogPost = \"blog-post-module--blogPost--72ffc\";\nexport var blogPostContainer = \"blog-post-module--blogPostContainer--50728\";\nexport var blogPostContent = \"blog-post-module--blogPostContent--a2bdd\";\nexport var blogPostHeader = \"blog-post-module--blogPostHeader--0de78\";\nexport var blogPostLayout = \"blog-post-module--blogPostLayout--47121\";\nexport var blogPostNav = \"blog-post-module--blogPostNav--d05de\";\nexport var postDate = \"blog-post-module--postDate--2d1aa\";\nexport var postDivider = \"blog-post-module--postDivider--aa8ca\";\nexport var postTitle = \"blog-post-module--postTitle--2c12c\";\nexport var scrollProgress = \"blog-post-module--scrollProgress--ba33a\";\nexport var tag = \"blog-post-module--tag--a09fc\";\nexport var tagsContainer = \"blog-post-module--tagsContainer--c8b91\";"],"names":["active","_ref","tableOfContents","activeId","setActiveId","useState","headings","setHeadings","isMobileTocOpen","setIsMobileTocOpen","extractTocIds","useCallback","tocHtml","tempDiv","document","createElement","innerHTML","links","querySelectorAll","Array","from","map","link","href","getAttribute","encodedId","substring","encoded","decoded","decodeURIComponent","filter","Boolean","useEffect","timer","setTimeout","findHeadings","tocIdObjects","contentHeadings","h","id","fromToc","_ref2","element","getElementById","matches","mergedHeadings","Set","concat","_toConsumableArray","sort","a","b","offsetTop","length","clearTimeout","handleScroll","_current","scrollY","window","pageYOffset","current","i","heading","getBoundingClientRect","top","prev","ticking","onScroll","requestAnimationFrame","addEventListener","passive","removeEventListener","handleTocClick","e","anchor","target","Element","closest","preventDefault","startsWith","targetElement","scrollTo","behavior","previousOverflow","body","style","overflow","handleEscape","event","key","mediaQuery","matchMedia","handleViewportChange","addListener","removeListener","processedTableOfContents","useMemo","processed","replace","encodedActiveId","encodeURIComponent","encodedRegex","RegExp","test","styles","escapedId","rawRegex","progress","currentIndex","findIndex","trim","React","type","className","onClick","width","dangerouslySetInnerHTML","__html","Head","data","markdownRemark","post","Seo","title","frontmatter","description","excerpt","_site$siteMetadata","previous","next","site","location","siteTitle","siteMetadata","postHtml","withNewTabLinks","html","match","attrs","nextAttrs","relMatch","quote","value","tokens","split","includes","push","join","scrollProgress","setScrollProgress","updateProgress","scrollTop","docHeight","scrollHeight","innerHeight","scrollPercent","Math","min","max","Layout","variant","itemScope","itemType","date","tags","tag","itemProp","Link","to","fields","slug","rel","TableOfContents"],"sourceRoot":""}